window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var d=[].slice.call(arguments);"object"===typeof console.log?log.apply.call(console.log,console,d):console.log.apply(console,d)}};
(function(d){function h(){}for(var l="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log timeStamp profile profileEnd time timeEnd trace warn".split(" "),a;a=l.pop();)d[a]=d[a]||h})(function(){try{return console.log(),window.console}catch(d){return window.console={}}}());
function parseUri(d){var h=parseUri.options;d=h.parser[h.strictMode?"strict":"loose"].exec(d);for(var l={},a=14;a--;)l[h.key[a]]=d[a]||"";l[h.q.name]={};l[h.key[12]].replace(h.q.parser,function(a,g,m){g&&(l[h.q.name][g]=m)});return l}
parseUri.options={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
function makeUri(d){var h="";d.protocol&&(h+=d.protocol+"://");d.user&&(h+=d.user);d.password&&(h+=":"+d.password);if(d.user||d.password)h+="@";d.host&&(h+=d.host);d.port&&(h+=":"+d.port);d.path&&(h+=d.path);var l=d.queryKey,a=[];for(k in l)if(l.hasOwnProperty(k)){var c=encodeURIComponent(l[k]);k=encodeURIComponent(k);c?a.push(k+"="+c):a.push(k)}0<a.length&&(h+="?"+a.join("&"));d.anchor&&(h+="#"+d.anchor);return h}
(function(d){function h(h){if("string"===typeof h.data){var a=h.handler,c=h.data.toLowerCase().split(" ");h.handler=function(g){if(this===g.target||!/textarea|select/i.test(g.target.nodeName)&&"text"!==g.target.type){var m="keypress"!==g.type&&d.hotkeys.specialKeys[g.which],f=String.fromCharCode(g.which).toLowerCase(),s="",v={};g.altKey&&"alt"!==m&&(s+="alt+");g.ctrlKey&&"ctrl"!==m&&(s+="ctrl+");g.metaKey&&(!g.ctrlKey&&"meta"!==m)&&(s+="meta+");g.shiftKey&&"shift"!==m&&(s+="shift+");m?v[s+m]=!0:(v[s+
f]=!0,v[s+d.hotkeys.shiftNums[f]]=!0,"shift+"===s&&(v[d.hotkeys.shiftNums[f]]=!0));m=0;for(f=c.length;m<f;m++)if(v[c[m]])return a.apply(this,arguments)}}}}d.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",
110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};d.each(["keydown","keyup","keypress"],function(){d.event.special[this]={add:h}})})(jQuery);"use strict";
(function(){if(!jQuery||!jQuery.jstree){var d=!1,h=!1,l=!1;(function(a){a.vakata={};a.vakata.css={get_css:function(a,c,f){a=a.toLowerCase();var g=f.cssRules||f.rules,m=0;do{if(g.length&&m>g.length+5)break;if(g[m].selectorText&&g[m].selectorText.toLowerCase()==a)return!0===c?(f.removeRule&&f.removeRule(m),f.deleteRule&&f.deleteRule(m),!0):g[m]}while(g[++m]);return!1},add_css:function(c,f){if(a.jstree.css.get_css(c,!1,f))return!1;f.insertRule?f.insertRule(c+" { }",0):f.addRule(c,null,0);return a.vakata.css.get_css(c)},
remove_css:function(c,f){return a.vakata.css.get_css(c,!0,f)},add_sheet:function(c){var f=!1,g=!0;if(c.str)return c.title&&(f=a("style[id='"+c.title+"-stylesheet']")[0]),f?g=!1:(f=document.createElement("style"),f.setAttribute("type","text/css"),c.title&&f.setAttribute("id",c.title+"-stylesheet")),f.styleSheet?g?(document.getElementsByTagName("head")[0].appendChild(f),f.styleSheet.cssText=c.str):f.styleSheet.cssText=f.styleSheet.cssText+" "+c.str:(f.appendChild(document.createTextNode(c.str)),document.getElementsByTagName("head")[0].appendChild(f)),
f.sheet||f.styleSheet;if(c.url)if(document.createStyleSheet)try{document.createStyleSheet(c.url)}catch(m){}else return f=document.createElement("link"),f.rel="stylesheet",f.type="text/css",f.media="all",f.href=c.url,document.getElementsByTagName("head")[0].appendChild(f),f.styleSheet}};var c=[],g=-1,m={},f={};a.fn.jstree=function(s){var f="string"==typeof s,g=Array.prototype.slice.call(arguments,1),d=this;if(f){if("_"==s.substring(0,1))return d;this.each(function(){var f=c[a.data(this,"jstree_instance_id")],
f=f&&a.isFunction(f[s])?f[s].apply(f,g):f;if("undefined"!==typeof f&&(0===s.indexOf("is_")||!0!==f&&!1!==f))return d=f,!1})}else this.each(function(){var f=a.data(this,"jstree_instance_id"),v=[],d=s?a.extend({},!0,s):{},h=a(this),t=!1,l=[],v=v.concat(g);h.data("jstree")&&v.push(h.data("jstree"));d=v.length?a.extend.apply(null,[!0,d].concat(v)):d;"undefined"!==typeof f&&c[f]&&c[f].destroy();f=parseInt(c.push({}),10)-1;a.data(this,"jstree_instance_id",f);d.plugins=a.isArray(d.plugins)?d.plugins:a.jstree.defaults.plugins.slice();
d.plugins.unshift("core");d.plugins=d.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");t=a.extend(!0,{},a.jstree.defaults,d);t.plugins=d.plugins;a.each(m,function(c,s){-1===a.inArray(c,t.plugins)?(t[c]=null,delete t[c]):l.push(c)});t.plugins=l;c[f]=new a.jstree._instance(f,a(this).addClass("jstree jstree-"+f),t);a.each(c[f]._get_settings().plugins,function(a,s){c[f].data[s]={}});a.each(c[f]._get_settings().plugins,function(a,s){m[s]&&
m[s].__init.apply(c[f])});setTimeout(function(){c[f]&&c[f].init()},0)});return d};a.jstree={defaults:{plugins:[]},_focused:function(){return c[g]||null},_reference:function(s){if(c[s])return c[s];var f=a(s);f.length||"string"!==typeof s||(f=a("#"+s));return f.length?c[f.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(c,f,g){this.data={core:{}};this.get_settings=function(){return a.extend(!0,{},g)};this._get_settings=function(){return g};this.get_index=function(){return c};
this.get_container=function(){return f};this.get_container_ul=function(){return f.children("ul:eq(0)")};this._set_settings=function(c){g=a.extend(!0,{},g,c)}},_fn:{},plugin:function(c,f){f=a.extend({},{__init:a.noop,__destroy:a.noop,_fn:{},defaults:!1},f);m[c]=f;a.jstree.defaults[c]=f.defaults;a.each(f._fn,function(f,g){g.plugin=c;g.old=a.jstree._fn[f];a.jstree._fn[f]=function(){var c,s=g,m=Array.prototype.slice.call(arguments);c=new a.Event("before.jstree");var d=!1;if(!0!==this.data.core.locked||
"unlock"===f||"is_locked"===f){do{if(s&&s.plugin&&-1!==a.inArray(s.plugin,this._get_settings().plugins))break;s=s.old}while(s);if(s){if(0===f.indexOf("_"))c=s.apply(this,m);else{c=this.get_container().triggerHandler(c,{func:f,inst:this,args:m,plugin:s.plugin});if(!1===c)return;"undefined"!==typeof c&&(m=c);c=s.apply(a.extend({},this,{__callback:function(a){this.get_container().triggerHandler(f+".jstree",{inst:this,args:m,rslt:a,rlbk:d})},__rollback:function(){return d=this.get_rollback()},__call_old:function(a){return s.old.apply(this,
a?Array.prototype.slice.call(arguments,1):m)}}),m)}return c}}};a.jstree._fn[f].old=g.old;a.jstree._fn[f].plugin=c})},rollback:function(s){s&&(a.isArray(s)||(s=[s]),a.each(s,function(a,s){c[s.i].set_rollback(s.h,s.d)}))}};a.jstree._fn=a.jstree._instance.prototype={};a(function(){var c=navigator.userAgent.toLowerCase(),f=(c.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],g=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(c)&&6==parseInt(f,10)){d=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(m){}g+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(c)&&
7==parseInt(f,10)&&(h=!0,g+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(c)&&(/mozilla/.test(c)&&1.9>parseFloat(f,10))&&(l=!0,g+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");a.vakata.css.add_sheet({str:g,title:"jstree"})});a.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=
this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+
this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",a.proxy(function(c){c=a(c.target);this.toggle_node(c)},this)).bind("mousedown.jstree",a.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){a=window.getSelection();
try{a.removeAllRanges(),a.collapse()}catch(c){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",a.proxy(function(c,f){var g=this._get_node(f.rslt.obj),m=this;-1===g&&(g=this.get_container_ul());g.length&&g.find("li").each(function(){var c=a(this);c.data("jstree")&&a.each(c.data("jstree"),function(s,f){m.data[s]&&a.isFunction(m["_"+s+"_notify"])&&m["_"+s+"_notify"].call(m,c,f)})})},this));this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",
a.proxy(function(c,f){var g=this._get_node(f.rslt.obj),m=this;-1===g&&(g=this.get_container_ul());g.length&&g.find("li.jstree-open:not(:has(ul))").each(function(){m.load_node(this,a.noop,a.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var s,f=this.get_index(),d=this._get_settings(),h=this;a.each(d.plugins,function(a,c){try{m[c].__destroy.apply(h)}catch(s){}});this.__callback();if(this.is_focused())for(s in c)if(c.hasOwnProperty(s)&&
s!=f){c[s].set_focus();break}f===g&&(g=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});a(document).unbind(".jstree-"+f).undelegate(".jstree-"+f);c[f]=null;delete c[f]},_core_notify:function(a,c){c.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity",
"0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:"))});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(c){var f=this,g=!0,m=[],d=[];c||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=a.map(a.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=a.map(a.makeArray(this.data.core.to_load),function(a){return"#"+
a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(a.each(this.data.core.to_load,function(c,s){if("#"==s)return!0;a(s).length?m.push(s):d.push(s)}),m.length&&(this.data.core.to_load=d,a.each(m,function(a,c){f._is_loaded(c)||(f.load_node(c,function(){f.reload_nodes(!0)},function(){f.reload_nodes(!0)}),
g=!1)})));this.data.core.to_open.length&&a.each(this.data.core.to_open,function(a,c){f.open_node(c,!1,!0)});g&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){f.__callback({},f)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var c=this;this.data.core.to_open.length&&a.each(this.data.core.to_open,function(a,f){c.open_node(f,!1,!0)});this.__callback({})},refresh:function(a){var c=this;this.save_opened();a||(a=-1);(a=this._get_node(a))||
(a=-1);-1!==a?a.children("UL").remove():this.get_container_ul().empty();this.load_node(a,function(){c.__callback({obj:a});c.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var c=a.jstree._focused();c&&c.unset_focus();this.get_container().addClass("jstree-focused");g=this.get_index();this.__callback()}},is_focused:function(){return g==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),g=
-1);this.__callback()},_get_node:function(c){var f=a(c,this.get_container());if(f.is(".jstree")||-1==c)return-1;f=f.closest("li",this.get_container());return f.length?f:!1},_get_next:function(a,c){a=this._get_node(a);return-1===a?this.get_container().find("> ul > li:first-child"):a.length?c?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(a,
c){a=this._get_node(a);if(-1===a)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(c)return 0<a.prevAll("li").length?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){for(a=a.prev("li").eq(0);a.hasClass("jstree-open");)a=a.children("ul:eq(0)").children("li:last");return a}var f=a.parentsUntil(".jstree","li:eq(0)");return f.length?f:!1},_get_parent:function(a){a=this._get_node(a);if(-1==a||!a.length)return!1;a=a.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},
_get_children:function(a){a=this._get_node(a);return-1===a?this.get_container().children("ul:eq(0)").children("li"):a.length?a.children("ul:eq(0)").children("li"):!1},get_path:function(a,c){var f=[],g=this;a=this._get_node(a);if(-1===a||!a||!a.length)return!1;a.parentsUntil(".jstree","li").each(function(){f.push(c?this.id:g.get_text(this))});f.reverse();f.push(c?a.attr("id"):this.get_text(a));return f},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return(a=
this._get_node(a))&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||-1===a)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(a,c,f){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return c&&
c.call(),!1;var g=f||d?0:this._get_settings().core.animation,m=this;this._is_loaded(a)?(this._get_settings().core.open_parents&&a.parentsUntil(".jstree",".jstree-closed").each(function(){m.open_node(this,!1,!0)}),g&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),g?a.children("ul").stop(!0,!0).slideDown(g,function(){this.style.display="";m.after_open(a)}):m.after_open(a),this.__callback({obj:a}),c&&c.call()):
(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){m.open_node(a,c,f)},c))},after_open:function(a){this.__callback({obj:a})},close_node:function(a,c){a=this._get_node(a);var f=c||d?0:this._get_settings().core.animation,g=this;if(!a.length||!a.hasClass("jstree-open"))return!1;f&&a.children("ul").attr("style","display:block !important");a.removeClass("jstree-open").addClass("jstree-closed");f?a.children("ul").stop(!0,!0).slideUp(f,function(){this.style.display="";g.after_close(a)}):
g.after_close(a);this.__callback({obj:a})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,c,f){(a=a?this._get_node(a):-1)&&-1!==a||(a=this.get_container_ul());f?a=a.find("li.jstree-closed"):(f=a,a=a.is(".jstree-closed")?a.find("li.jstree-closed").addBack():a.find("li.jstree-closed"));var g=this;a.each(function(){var a=this;
g._is_loaded(this)?g.open_node(this,!1,!c):g.open_node(this,function(){g.open_all(a,c,f)},!c)});0===f.find("li.jstree-closed").length&&this.__callback({obj:f})},close_all:function(a,c){var f=this;(a=a?this._get_node(a):this.get_container())&&-1!==a||(a=this.get_container_ul());a.find("li.jstree-open").addBack().each(function(){f.close_node(this,!c)});this.__callback({obj:a})},clean_node:function(c){c=c&&-1!=c?a(c):this.get_container_ul();c=c.is("li")?c.find("li").addBack():c.find("li");c.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");
c.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:c})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,c){this.get_container().empty().append(a);this.data=c;this.__callback()},load_node:function(a,c,f){this.__callback({obj:a})},_is_loaded:function(a){return!0},create_node:function(c,f,g,m,d){c=this._get_node(c);f="undefined"===typeof f?
"last":f;var h=a("<li />"),l=this._get_settings().core,H;if(-1!==c&&!c.length)return!1;if(!d&&!this._is_loaded(c))return this.load_node(c,function(){this.create_node(c,f,g,m,!0)}),!1;this.__rollback();"string"===typeof g&&(g={data:g});g||(g={});g.attr&&h.attr(g.attr);g.metadata&&h.data(g.metadata);g.state&&h.addClass("jstree-"+g.state);g.data||(g.data=this._get_string("new_node"));a.isArray(g.data)||(H=g.data,g.data=[],g.data.push(H));a.each(g.data,function(c,f){H=a("<a />");a.isFunction(f)&&(f=f.call(this,
g));if("string"==typeof f)H.attr("href","#")[l.html_titles?"html":"text"](f);else f.attr||(f.attr={}),f.attr.href||(f.attr.href="#"),H.attr(f.attr)[l.html_titles?"html":"text"](f.title),f.language&&H.addClass(f.language);H.prepend("<ins class='jstree-icon'>&#160;</ins>");!f.icon&&g.icon&&(f.icon=g.icon);f.icon&&(-1===f.icon.indexOf("/")?H.children("ins").addClass(f.icon):H.children("ins").css("background","url('"+f.icon+"') center center no-repeat"));h.append(H)});h.prepend("<ins class='jstree-icon'>&#160;</ins>");
-1===c&&(c=this.get_container(),"before"===f&&(f="first"),"after"===f&&(f="last"));switch(f){case "before":c.before(h);H=this._get_parent(c);break;case "after":c.after(h);H=this._get_parent(c);break;case "inside":case "first":c.children("ul").length||c.append("<ul />");c.children("ul").prepend(h);H=c;break;case "last":c.children("ul").length||c.append("<ul />");c.children("ul").append(h);H=c;break;default:c.children("ul").length||c.append("<ul />"),f||(f=0),H=c.children("ul").children("li").eq(f),
H.length?H.before(h):c.children("ul").append(h),H=c}if(-1===H||H.get(0)===this.get_container().get(0))H=-1;this.clean_node(H);this.__callback({obj:h,parent:H});m&&m.call(this,h);return h},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var c=this._get_settings().core.html_titles;a=a.children("a:eq(0)");if(c)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];return a.nodeValue},set_text:function(a,c){a=this._get_node(a);
if(!a.length)return!1;a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var f=a.children("INS").clone();a.html(c).prepend(f);this.__callback({obj:a,name:c});return!0}a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,name:c});return a.nodeValue=c},rename_node:function(a,c){a=this._get_node(a);this.__rollback();a&&(a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments)))&&this.__callback({obj:a,name:c})},delete_node:function(c){c=
this._get_node(c);if(!c.length)return!1;this.__rollback();var f=this._get_parent(c),g=a([]),m=this;c.each(function(){g=g.add(m._get_prev(this))});c=c.detach();-1!==f&&0===f.find("> ul > li").length&&f.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(f);this.__callback({obj:c,prev:g,parent:f});return c},prepare_move:function(c,g,m,d,h){var l={};l.ot=a.jstree._reference(c)||this;l.o=l.ot._get_node(c);l.r=-1===g?-1:this._get_node(g);l.p="undefined"===typeof m||!1===m?
"last":m;if(h||!f.o||f.o[0]!==l.o[0]||f.r[0]!==l.r[0]||f.p!==l.p){l.ot=a.jstree._reference(l.o)||this;l.rt=a.jstree._reference(l.r)||this;if(-1!==l.r&&l.r){if(!/^(before|after)$/.test(l.p)&&!this._is_loaded(l.r))return this.load_node(l.r,function(){this.prepare_move(c,g,m,d,!0)});switch(l.p){case "before":l.cp=l.r.index();l.cr=l.rt._get_parent(l.r);break;case "after":l.cp=l.r.index()+1;l.cr=l.rt._get_parent(l.r);break;case "inside":case "first":l.cp=0;l.cr=l.r;break;case "last":l.cp=l.r.find(" > ul > li").length;
l.cr=l.r;break;default:l.cp=l.p,l.cr=l.r}}else switch(l.cr=-1,l.p){case "first":case "before":case "inside":l.cp=0;break;case "after":case "last":l.cp=l.rt.get_container().find(" > ul > li").length;break;default:l.cp=l.p}l.np=-1==l.cr?l.rt.get_container():l.cr;l.op=l.ot._get_parent(l.o);l.cop=l.o.index();-1===l.op&&(l.op=l.ot?l.ot.get_container():this.get_container());!/^(before|after)$/.test(l.p)&&(l.op&&l.np&&l.op[0]===l.np[0]&&l.o.index()<l.cp)&&l.cp++;l.or=l.np.find(" > ul > li:nth-child("+(l.cp+
1)+")");f=l}this.__callback(f);d&&d.call(this,f)},check_move:function(){var a=f,c=!0,g=-1===a.r?this.get_container():a.r;if(!a||!a.o||a.or[0]===a.o[0])return!1;if(!a.cy){if(a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(-1!==g.parentsUntil(".jstree","li").addBack().index(this))return c=!1})}return c},move_node:function(c,g,m,d,l,h){if(!l)return this.prepare_move(c,g,m,function(a){this.move_node(a,!1,!1,d,!0,h)});d&&(f.cy=!0);if(!h&&!this.check_move())return!1;
this.__rollback();g=!1;d?(g=c.o.clone(!0),g.find("*[id]").addBack().each(function(){this.id&&(this.id="copy_"+this.id)})):g=c.o;c.or.length?c.or.before(g):(c.np.children("ul").length||a("<ul />").appendTo(c.np),c.np.children("ul:eq(0)").append(g));try{c.ot.clean_node(c.op),c.rt.clean_node(c.np),c.op.find("> ul > li").length||c.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(K){}d&&(f.cy=!0,f.oc=g);this.__callback(f);return f},_get_move:function(){return f}}})})(jQuery);
(function(a){var c,g,m;a(function(){/msie/.test(navigator.userAgent.toLowerCase())?(g=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),m=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),c=g.width()-m.width(),g.add(m).remove()):(g=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200}),c=100-g.width(),g.parent().remove())});a.jstree.plugin("ui",{__init:function(){this.data.ui.selected=a();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",a.proxy(function(c){c.preventDefault();c.currentTarget.blur();a(c.currentTarget).hasClass("jstree-loading")||this.select_node(c.currentTarget,!0,c)},this)).delegate("a","mouseenter.jstree",a.proxy(function(c){a(c.currentTarget).hasClass("jstree-loading")||
this.hover_node(c.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(c){a(c.currentTarget).hasClass("jstree-loading")||this.dehover_node(c.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(c,g){var m=this._get_settings().ui,d=this._get_node(g.rslt.obj),
l=d&&d.length?d.children("ul").find("a.jstree-clicked"):a(),h=this;!1!==m.selected_parent_close&&l.length&&l.each(function(){h.deselect_node(this);"select_parent"===m.selected_parent_close&&h.select_node(d)})},this)).bind("delete_node.jstree",a.proxy(function(a,c){var g=this._get_settings().ui.select_prev_on_delete,m=this._get_node(c.rslt.obj),m=m&&m.length?m.find("a.jstree-clicked"):[],d=this;m.each(function(){d.deselect_node(this)});g&&m.length&&c.rslt.prev.each(function(){if(this.parentNode)return d.select_node(this),
!1})},this)).bind("move_node.jstree",a.proxy(function(a,c){c.rslt.cy&&c.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(c,g){if("undefined"===typeof c||null===c)return g?this.data.ui.selected:this.data.ui.last_selected;var m=a(c,
this.get_container());if(m.is(".jstree")||-1==c)return-1;m=m.closest("li",this.get_container());return m.length?m:!1},_ui_notify:function(a,c){c.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},
reselect:function(){var c=this,g=this.data.ui.to_select,g=a.map(a.makeArray(g),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});a.each(g,function(a,g){g&&"#"!==g&&c.select_node(g)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(a){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);
if(!a.length)return!1;a.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,c;if(!a||!a.length)return!1;c=a.children("a").removeClass("jstree-hovered").parent();this.data.ui.hovered[0]===c[0]&&(this.data.ui.hovered=null);this.__callback({obj:a})},select_node:function(a,c,g){a=this._get_node(a);if(-1==a||!a||!a.length)return!1;var m=this._get_settings().ui,
d="on"==m.select_multiple_modifier||!1!==m.select_multiple_modifier&&g&&g[m.select_multiple_modifier+"Key"],l=!1!==m.select_range_modifier&&g&&g[m.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],h=this.is_selected(a),K=!0,H=this;if(c){if(m.disable_selecting_children&&d&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;
K=!1;switch(!0){case l:this.data.ui.last_selected.addClass("jstree-last-selected");a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").addBack();-1==m.select_limit||a.length<m.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==H.data.ui.last_selected[0]&&H.deselect_node(this)}),h=!1,K=!0):K=!1;break;case h&&!d:this.deselect_all();h=!1;K=!0;break;case !h&&!d:if(-1==m.select_limit||
0<m.select_limit)this.deselect_all(),K=!0;break;case h&&d:this.deselect_node(a);break;case !h&&d:if(-1==m.select_limit||this.data.ui.selected.length+1<=m.select_limit)K=!0}}K&&!h&&(l||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),m.selected_parent_open&&a.parents(".jstree-closed").each(function(){H.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:g}))},_fix_scroll:function(a){var g=this.get_container()[0];
g.scrollHeight>g.offsetHeight&&(a=this._get_node(a))&&(-1!==a&&a.length&&a.is(":visible"))&&(a=a.offset().top-this.get_container().offset().top,0>a&&(g.scrollTop=g.scrollTop+a-1),a+this.data.core.li_height+(g.scrollWidth>g.offsetWidth?c:0)>g.offsetHeight&&(g.scrollTop+=a-g.offsetHeight+this.data.core.li_height+1+(g.scrollWidth>g.offsetWidth?c:0)))},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=
this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return 0<=this.data.ui.selected.index(this._get_node(a))},get_selected:function(c){return c?a(c).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(c){c=c?a(c).find("a.jstree-clicked").parent():
this.get_container().find("a.jstree-clicked").parent();c.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a([]);this.data.ui.last_selected=!1;this.__callback({obj:c})}}});a.jstree.defaults.plugins.push("ui")})(jQuery);(function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,g){if(this._get_settings().crrm.move.open_onmove){var m=this;g.rslt.np.parentsUntil(".jstree").addBack().filter(".jstree-closed").each(function(){m.open_node(this,
!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(a){return!0}}},_fn:{_show_input:function(c,g){c=this._get_node(c);var m=this._get_settings().core.rtl,f=this._get_settings().crrm.input_width_limit,d=c.children("ins").width(),l=c.find("> a:visible > ins").width()*c.find("> a:visible > ins").length,h=this.get_text(c),t=a("<div />",{css:{position:"absolute",top:"-200px",left:m?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),
w=c.css("position","relative").append(a("<input />",{value:h,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:m?"auto":d+l+4+"px",right:m?d+l+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=c.children(".jstree-rename-input"),f=a.val();""===f&&(f=h);t.remove();a.remove();this.set_text(c,h);this.rename_node(c,f);g.call(this,c,f,h);c.css("position","")},
this),keyup:function(a){a=a.keyCode||a.which;27==a?(this.value=h,this.blur()):13==a?this.blur():w.width(Math.min(t.text("pW"+this.value).width(),f))},keypress:function(a){if(13==(a.keyCode||a.which))return!1}})).children(".jstree-rename-input");this.set_text(c,"");t.css({fontFamily:w.css("fontFamily")||"",fontSize:w.css("fontSize")||"",fontWeight:w.css("fontWeight")||"",fontStyle:w.css("fontStyle")||"",fontStretch:w.css("fontStretch")||"",fontVariant:w.css("fontVariant")||"",letterSpacing:w.css("letterSpacing")||
"",wordSpacing:w.css("wordSpacing")||""});w.width(Math.min(t.text("pW"+w[0].value).width(),f))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var g=this.__callback;this._show_input(a,function(a,c,d){g.call(this,{obj:a,new_name:c,old_name:d})})},create:function(c,g,m,f,d){var h=this;(c=this._get_node(c))||(c=-1);this.__rollback();return this.create_node(c,g,m,function(c){var g=this._get_parent(c),m=a(c).index();f&&f.call(this,c);g.length&&g.hasClass("jstree-closed")&&this.open_node(g,
!1,!0);d?h.__callback({obj:c,name:this.get_text(c),parent:g,position:m}):this._show_input(c,function(a,c,f){h.__callback({obj:a,name:c,parent:g,position:m})})})},remove:function(a){a=this._get_node(a,!0);var g=this._get_parent(a),m=this._get_prev(a);this.__rollback();a=this.delete_node(a);!1!==a&&this.__callback({obj:a,prev:m,parent:g})},check_move:function(){return this.__call_old()&&this._get_settings().crrm.move.check_move.call(this,this._get_move())?!0:!1},move_node:function(a,g,m,f,d,h){var l=
this._get_settings().crrm.move;if(!d)return"undefined"===typeof m&&(m=l.default_position),"inside"!==m||l.default_position.match(/^(before|after)$/)||(m=l.default_position),this.__call_old(!0,a,g,m,f,!1,h);if(!0===l.always_copy||"multitree"===l.always_copy&&a.rt.get_index()!==a.ot.get_index())f=!0;this.__call_old(!0,a,g,m,f,!0,h)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,
!0);if(!a||!a.length)return!1;this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var g=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0);this.__callback({obj:a,
nodes:g})}}})})(jQuery);(function(a){var c=[];a.jstree._themes=!1;a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,
icons:!0},_fn:{set_theme:function(g,m){if(!g)return!1;m||(m=a.jstree._themes+g+"/style.css");-1==a.inArray(m,c)&&(a.vakata.css.add_sheet({url:m}),c.push(m));this.data.themes.theme!=g&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=g);this.get_container().addClass("jstree-"+g);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},
show_dots:function(){this.data.themes.dots=!0;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},
toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});a(function(){!1===a.jstree._themes&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===a.jstree._themes&&(a.jstree._themes="themes/")});a.jstree.defaults.plugins.push("themes")})(jQuery);(function(a){var c=[];a.jstree.plugin("hotkeys",{__init:function(){if("undefined"===
typeof a.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";a.each(this._get_settings().hotkeys,function(g,m){!1!==m&&-1==a.inArray(g,c)&&(a(document).bind("keydown",g,function(c){a:{var m=a.jstree._focused(),d;if(m&&(m.data&&m.data.hotkeys&&m.data.hotkeys.enabled)&&(d=m._get_settings().hotkeys[g])){c=d.call(m,c);break a}c=void 0}return c}),c.push(g))});this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&
(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||
this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):
this.hover_node(this._get_prev(a)));return!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?
this.open_node(a):this.hover_node(this._get_next(a)));return!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();
return!1},"ctrl+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},"shift+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=
!1}}})})(jQuery);(function(a){a.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&this.get_container().bind("after_close.jstree",function(a,g){g.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,g,m){var f=this;this.load_node_json(a,function(){f.__callback({obj:f._get_node(a)});g.call(this)},m)},_is_loaded:function(c){var g=this._get_settings().json_data;
c=this._get_node(c);return-1==c||!c||!g.ajax&&!g.progressive_render&&!a.isFunction(g.data)||c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").length},refresh:function(c){c=this._get_node(c);var g=this._get_settings().json_data;c&&(-1!==c&&g.progressive_unload&&(a.isFunction(g.data)||g.ajax))&&c.removeData("jstree_children");return this.__call_old()},load_node_json:function(c,g,m){var f=this.get_settings().json_data,d,h=function(){};d=function(){};if((c=this._get_node(c))&&-1!==
c&&(f.progressive_render||f.progressive_unload)&&!c.is(".jstree-open, .jstree-leaf")&&0===c.children("ul").children("li").length&&c.data("jstree_children")){if(d=this._parse_json(c.data("jstree_children"),c))c.append(d),f.progressive_unload||c.removeData("jstree_children");this.clean_node(c);g&&g.call(this)}else{if(c&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case !f.data&&!f.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(f.data):f.data.call(this,
c,a.proxy(function(a){(a=this._parse_json(a,c))?(-1!==c&&c?(c.append(a).children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(a.children()),this.clean_node(c),g&&g.call(this)):(-1!==c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),f.correct_state&&this.correct_state(c)):f.correct_state&&this.get_container().children("ul").empty(),m&&m.call(this))},this));break;
case !!f.data&&!f.ajax||!!f.data&&!!f.ajax&&(!c||-1===c):c&&-1!=c||((d=this._parse_json(f.data,c))?(this.get_container().children("ul").empty().append(d.children()),this.clean_node()):f.correct_state&&this.get_container().children("ul").empty());g&&g.call(this);break;case !f.data&&!!f.ajax||!!f.data&&!!f.ajax&&c&&-1!==c:h=function(a,g,d){var s=this.get_settings().json_data.ajax.error;s&&s.call(this,a,g,d);-1!=c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),
"success"===g&&f.correct_state&&this.correct_state(c)):"success"===g&&f.correct_state&&this.get_container().children("ul").empty();m&&m.call(this)},d=function(m,d,s){var l=this.get_settings().json_data.ajax.success;l&&(m=l.call(this,m,d,s)||m);if(""===m||m&&m.toString&&""===m.toString().replace(/^[\s\n]+$/,"")||!a.isArray(m)&&!a.isPlainObject(m))return h.call(this,s,d,"");(m=this._parse_json(m,c))?(-1!==c&&c?(c.append(m).children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading")):
this.get_container().children("ul").empty().append(m.children()),this.clean_node(c),g&&g.call(this)):-1!==c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),f.correct_state&&(this.correct_state(c),g&&g.call(this))):f.correct_state&&(this.get_container().children("ul").empty(),g&&g.call(this))},f.ajax.context=this,f.ajax.error=h,f.ajax.success=d,f.ajax.dataType||(f.ajax.dataType="json"),a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,c)),
a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,c)),a.ajax(f.ajax)}}},_parse_json:function(c,g,m){var f=!1,d=this._get_settings(),h=d.json_data,l=d.core.html_titles,t;if(!c)return f;h.progressive_unload&&(g&&-1!==g)&&g.data("jstree_children",f);if(a.isArray(c)){f=a("<ul>");if(!c.length)return!1;d=0;for(h=c.length;d<h;d++)t=this._parse_json(c[d],g,!0),t.length&&(f=f.append(t));f=f.children()}else{"string"==typeof c&&(c={data:c});if(!c.data&&""!==c.data)return f;f=a("<li />");c.attr&&
f.attr(c.attr);c.metadata&&f.data(c.metadata);c.state&&f.addClass("jstree-"+c.state);a.isArray(c.data)||(t=c.data,c.data=[],c.data.push(t));a.each(c.data,function(g,m){t=a("<a />");a.isFunction(m)&&(m=m.call(this,c));if("string"==typeof m)t.attr("href","#")[l?"html":"text"](m);else m.attr||(m.attr={}),m.attr.href||(m.attr.href="#"),t.attr(m.attr)[l?"html":"text"](m.title),m.language&&t.addClass(m.language);t.prepend("<ins class='jstree-icon'>&#160;</ins>");!m.icon&&c.icon&&(m.icon=c.icon);m.icon&&
(-1===m.icon.indexOf("/")?t.children("ins").addClass(m.icon):t.children("ins").css("background","url('"+m.icon+"') center center no-repeat"));f.append(t)});f.prepend("<ins class='jstree-icon'>&#160;</ins>");c.children&&(h.progressive_render&&"open"!==c.state?f.addClass("jstree-closed").data("jstree_children",c.children):(h.progressive_unload&&f.data("jstree_children",c.children),a.isArray(c.children)&&c.children.length&&(t=this._parse_json(c.children,g,!0),t.length&&(g=a("<ul />"),g.append(t),f.append(g)))))}m||
(m=a("<ul />"),m.append(f),f=m);return f},get_json:function(c,g,m,f){var d=[],h=this._get_settings(),l=this,t,w,Q,K,H,R;(c=this._get_node(c))&&-1!==c||(c=this.get_container().find("> ul > li"));g=a.isArray(g)?g:["id","class"];!f&&this.data.types&&g.push(h.types.type_attr);m=a.isArray(m)?m:[];c.each(function(){Q=a(this);t={data:[]};g.length&&(t.attr={});a.each(g,function(a,c){(w=Q.attr(c))&&(w.length&&w.replace(/jstree[^ ]*/ig,"").length)&&(t.attr[c]=(" "+w).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig,
" ").replace(/^ /,"").replace(/ $/,""))});Q.hasClass("jstree-open")&&(t.state="open");Q.hasClass("jstree-closed")&&(t.state="closed");Q.data()&&(t.metadata=Q.data());K=Q.children("a");K.each(function(){H=a(this);m.length||-1!==a.inArray("languages",h.plugins)||H.children("ins").get(0).style.backgroundImage.length||H.children("ins").get(0).className&&H.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(R=!1,-1!==a.inArray("languages",h.plugins)&&(a.isArray(h.languages)&&h.languages.length)&&
a.each(h.languages,function(a,c){if(H.hasClass(c))return R=c,!1}),w={attr:{},title:l.get_text(H,R)},a.each(m,function(a,c){w.attr[c]=(" "+(H.attr(c)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),-1!==a.inArray("languages",h.plugins)&&(a.isArray(h.languages)&&h.languages.length)&&a.each(h.languages,function(a,c){if(H.hasClass(c))return w.language=c,!0}),H.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(w.icon=
H.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),H.children("ins").get(0).style.backgroundImage.length&&(w.icon=H.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):w=l.get_text(H);1<K.length?t.data.push(w):t.data=w});Q=Q.find("> ul > li");Q.length&&(t.children=l.get_json(Q,g,m,!0));d.push(t)});return d}}})})(jQuery);(function(a){var c=!1;a.jstree.plugin("languages",{__init:function(){this._load_css()},
defaults:[],_fn:{set_lang:function(g){var m=this._get_settings().languages,f=!1,d=".jstree-"+this.get_index()+" a";if(!a.isArray(m)||0===m.length)return!1;if(-1==a.inArray(g,m))if(m[g])g=m[g];else return!1;if(g==this.data.languages.current_language)return!0;f=a.vakata.css.get_css(d+"."+this.data.languages.current_language,!1,c);!1!==f&&(f.style.display="none");f=a.vakata.css.get_css(d+"."+g,!1,c);!1!==f&&(f.style.display="");this.data.languages.current_language=g;this.__callback(g);return!0},get_lang:function(){return this.data.languages.current_language},
_get_string:function(c,m){var f=this._get_settings().languages,d=this._get_settings().core.strings;a.isArray(f)&&f.length&&(m=m&&-1!=a.inArray(m,f)?m:this.data.languages.current_language);return d[m]&&d[m][c]?d[m][c]:d[c]?d[c]:c},get_text:function(c,m){c=this._get_node(c)||this.data.ui.last_selected;if(!c.size())return!1;var f=this._get_settings().languages,d=this._get_settings().core.html_titles;a.isArray(f)&&f.length?(m=m&&-1!=a.inArray(m,f)?m:this.data.languages.current_language,c=c.children("a."+
m)):c=c.children("a:eq(0)");if(d)return c=c.clone(),c.children("INS").remove(),c.html();c=c.contents().filter(function(){return 3==this.nodeType})[0];return c.nodeValue},set_text:function(c,m,f){c=this._get_node(c)||this.data.ui.last_selected;if(!c.size())return!1;var d=this._get_settings().languages,h=this._get_settings().core.html_titles;a.isArray(d)&&d.length?(f=f&&-1!=a.inArray(f,d)?f:this.data.languages.current_language,c=c.children("a."+f)):c=c.children("a:eq(0)");if(h)return d=c.children("INS").clone(),
c.html(m).prepend(d),this.__callback({obj:c,name:m,lang:f}),!0;c=c.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:c,name:m,lang:f});return c.nodeValue=m},_load_css:function(){var g=this._get_settings().languages,m="/* languages css */",f=".jstree-"+this.get_index()+" a",d;if(a.isArray(g)&&g.length){this.data.languages.current_language=g[0];for(d=0;d<g.length;d++)m+=f+"."+g[d]+" {",g[d]!=this.data.languages.current_language&&(m+=" display:none; "),m+=" } ";c=a.vakata.css.add_sheet({str:m,
title:"jstree-languages"})}},create_node:function(c,m,f,d){return this.__call_old(!0,c,m,f,function(c){var f=this._get_settings().languages,m=c.children("a"),g;if(a.isArray(f)&&f.length){for(g=0;g<f.length;g++)m.is("."+f[g])||c.append(m.eq(0).clone().removeClass(f.join(" ")).addClass(f[g]));m.not("."+f.join(", .")).remove()}d&&d.call(this,c)})}}})})(jQuery);(function(a){a.jstree.plugin("cookies",{__init:function(){if("undefined"===typeof a.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";
var c=this._get_settings().cookies,g;c.save_loaded&&(g=a.cookie(c.save_loaded))&&g.length&&(this.data.core.to_load=g.split(","));c.save_opened&&(g=a.cookie(c.save_opened))&&g.length&&(this.data.core.to_open=g.split(","));c.save_selected&&(g=a.cookie(c.save_selected))&&(g.length&&this.data.ui)&&(this.data.ui.to_select=g.split(","));this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",
a.proxy(function(a){this._get_settings().cookies.auto_save&&this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(c){if(!this.data.core.refreshing){var g=this._get_settings().cookies;if(c)switch(c){case "open_node":case "close_node":g.save_opened&&(this.save_opened(),a.cookie(g.save_opened,this.data.core.to_open.join(","),
g.cookie_options));g.save_loaded&&(this.save_loaded(),a.cookie(g.save_loaded,this.data.core.to_load.join(","),g.cookie_options));break;case "select_node":case "deselect_node":g.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(g.save_selected,this.data.ui.to_select.join(","),g.cookie_options))}else g.save_loaded&&(this.save_loaded(),a.cookie(g.save_loaded,this.data.core.to_load.join(","),g.cookie_options)),g.save_opened&&(this.save_opened(),a.cookie(g.save_opened,this.data.core.to_open.join(","),
g.cookie_options)),g.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(g.save_selected,this.data.ui.to_select.join(","),g.cookie_options))}}}})})(jQuery);(function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,g){var m=this._get_node(g.rslt.obj),m=-1===m?this.get_container().children("ul"):m.children("ul");this.sort(m)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,g){this.sort(g.rslt.obj.parent())},
this)).bind("move_node.jstree",a.proxy(function(a,g){var m=-1==g.rslt.np?this.get_container():g.rslt.np;this.sort(m.children("ul"))},this))},defaults:function(a,g){return this.get_text(a)>this.get_text(g)?1:-1},_fn:{sort:function(c){var g=this._get_settings().sort,m=this;c.append(a.makeArray(c.children("li")).sort(a.proxy(g,m)));c.find("> li > ul").each(function(){m.sort(a(this))});this.clean_node(c)}}})})(jQuery);(function(a){var c=!1,g=!1,m=!1,f=!1,d=!1,h=!1,l=!1,t=!1,w=!1;a.vakata.dnd={is_down:!1,
is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(c,f,m){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{c.currentTarget.unselectable="on",c.currentTarget.onselectstart=function(){return!1},c.currentTarget.style&&(c.currentTarget.style.MozUserSelect="none")}catch(g){}a.vakata.dnd.init_x=c.pageX;a.vakata.dnd.init_y=c.pageY;a.vakata.dnd.user_data=f;a.vakata.dnd.is_down=!0;a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(m);
a(document).bind("mousemove",a.vakata.dnd.drag);a(document).bind("mouseup",a.vakata.dnd.drag_stop);return!1},drag:function(c){if(a.vakata.dnd.is_down){if(!a.vakata.dnd.is_drag)if(5<Math.abs(c.pageX-a.vakata.dnd.init_x)||5<Math.abs(c.pageY-a.vakata.dnd.init_y))a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:c,data:a.vakata.dnd.user_data});else return;if("mousemove"===c.type){var f=a(document),m=f.scrollTop(),f=f.scrollLeft();20>c.pageY-
m?(h&&"down"===l&&(clearInterval(h),h=!1),h||(l="up",h=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-a.vakata.dnd.scroll_spd)},150))):h&&"up"===l&&(clearInterval(h),h=!1);20>a(window).height()-(c.pageY-m)?(h&&"up"===l&&(clearInterval(h),h=!1),h||(l="down",h=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150))):h&&"down"===l&&(clearInterval(h),h=!1);20>c.pageX-f?(d&&"right"===t&&(clearInterval(d),d=!1),d||(t="left",d=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-
a.vakata.dnd.scroll_spd)},150))):d&&"left"===t&&(clearInterval(d),d=!1);20>a(window).width()-(c.pageX-f)?(d&&"left"===t&&(clearInterval(d),d=!1),d||(t="right",d=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150))):d&&"right"===t&&(clearInterval(d),d=!1)}a.vakata.dnd.helper.css({left:c.pageX+a.vakata.dnd.helper_left+"px",top:c.pageY+a.vakata.dnd.helper_top+"px"});a(document).triggerHandler("drag.vakata",{event:c,data:a.vakata.dnd.user_data})}},drag_stop:function(c){d&&
clearInterval(d);h&&clearInterval(h);a(document).unbind("mousemove",a.vakata.dnd.drag);a(document).unbind("mouseup",a.vakata.dnd.drag_stop);a(document).triggerHandler("drag_stop.vakata",{event:c,data:a.vakata.dnd.user_data});a.vakata.dnd.helper.remove();a.vakata.dnd.init_x=0;a.vakata.dnd.init_y=0;a.vakata.dnd.user_data={};a.vakata.dnd.is_down=!1;a.vakata.dnd.is_drag=!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",
title:"vakata"})});a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",a.proxy(function(g){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.themes&&(m.attr("class","jstree-"+this.data.themes.theme),f&&f.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),
g.currentTarget===g.target&&(a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==g.target)&&(g=a.jstree._reference(g.target),g.data.dnd.foreign?(g=g._get_settings().dnd.drag_check.call(this,{o:c,r:g.get_container(),is_root:!0}),!0!==g&&!0!==g.inside&&!0!==g.before&&!0!==g.after||a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(g.prepare_move(c,g.get_container(),"last"),g.check_move()&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok"))))},this)).bind("mouseup.jstree",a.proxy(function(f){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&f.currentTarget===f.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==f.target){var m=a.jstree._reference(f.currentTarget);m.data.dnd.foreign?(f=m._get_settings().dnd.drag_check.call(this,{o:c,r:m.get_container(),is_root:!0}),!0!==f&&!0!==f.inside&&!0!==f.before&&!0!==f.after||m._get_settings().dnd.drag_finish.call(this,
{o:c,r:m.get_container(),is_root:!0})):m.move_node(c,m.get_container(),"last",f[m._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",a.proxy(function(c){if(c.relatedTarget&&c.relatedTarget.id&&"jstree-marker-line"===c.relatedTarget.id)return!1;a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),
a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var f=this.get_container()[0];c.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},f),100)):c.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&
clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},f),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);c.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop+=a.vakata.dnd.scroll_spd},f),100)):c.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop-=
a.vakata.dnd.scroll_spd},f),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&(a.vakata.dnd.user_data.jstree&&m&&f)&&(m.hide(),f.hide())},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(1===a.which)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(c.currentTarget)},this)).delegate("a",
"mousemove.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(g&&g.length&&g.children("a")[0]===c.currentTarget||this.dnd_enter(c.currentTarget),"undefined"===typeof this.data.dnd.off.top&&(this.data.dnd.off=a(c.target).offset()),this.data.dnd.w=(c.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&
a.vakata.dnd.user_data.jstree){if(c.relatedTarget&&c.relatedTarget.id&&"jstree-marker-line"===c.relatedTarget.id)return!1;m&&m.hide();f&&f.hide();this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(c)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(c)},this));a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);
this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;m&&m.css({top:"-2000px"});f&&f.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(c,f){if(f.data.jstree){var m=a(f.event.target);
m.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(m)}},this));var d=this._get_settings().dnd;d.drag_target&&a(document).delegate(d.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(g){c=g.target;a.vakata.dnd.drag_start(g,{jstree:!0,obj:g.target},"<ins class='jstree-icon'></ins>"+a(g.target).text());this.data.themes&&(m&&m.attr("class","jstree-"+this.data.themes.theme),f&&f.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+
this.data.themes.theme));a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var d=this.get_container();this.data.dnd.cof=d.offset();this.data.dnd.cw=parseInt(d.width(),10);this.data.dnd.ch=parseInt(d.height(),10);this.data.dnd.foreign=!0;g.preventDefault()},this));d.drop_target&&a(document).delegate(d.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(f){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:c,r:a(f.target),e:f})&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok")},this)).delegate(d.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(c){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(d.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(f){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:c,r:a(f.target),e:f})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,
drop_target:".jstree-drop",drop_check:function(a){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(a){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(g&&g.length){this.data.dnd.off=g.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+g.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:c,r:g});this.data.dnd.after=a.after;this.data.dnd.before=a.before;
this.data.dnd.inside=a.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(c,g,"before");this.data.dnd.before=this.check_move();this.prepare_move(c,g,"after");this.data.dnd.after=this.check_move();this._is_loaded(g)?(this.prepare_move(c,g,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var c=["before","inside","after"],g=!1,d=this._get_settings().core.rtl,
c=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];a.each(c,a.proxy(function(c,f){if(this.data.dnd[f])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),g=f,!1},this));!1===g&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");c=d?this.data.dnd.off.right-18:this.data.dnd.off.left+
10;switch(g){case "before":m.css({left:c+"px",top:this.data.dnd.off.top-6+"px"}).show();f&&f.css({left:c+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case "after":m.css({left:c+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();f&&f.css({left:c+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case "inside":m.css({left:c+(d?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();f&&f.hide();break;default:m.hide(),
f&&f.hide()}return w=g}},dnd_open:function(){this.data.dnd.to2=!1;this.open_node(g,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:c,r:g,p:w}):(this.dnd_prepare(),this.move_node(c,g,w,a[this._get_settings().dnd.copy_modifier+"Key"]));g=c=!1;m.hide();f&&f.hide()},dnd_enter:function(c){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=
!1);var f=this._get_settings().dnd;this.data.dnd.prepared=!1;g=this._get_node(c);f.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),f.check_timeout)):this.dnd_prepare();f.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),g&&(g.length&&g.hasClass("jstree-closed"))&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),f.open_timeout))):g&&(g.length&&g.hasClass("jstree-closed"))&&this.dnd_open()},dnd_leave:function(c){this.data.dnd.after=
!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");m.hide();f&&f.hide();g&&g[0]===c.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(g,d){c=this._get_node(g);this.data.ui&&this.is_selected(c)&&(c=this._get_node(null,!0));var h=1<c.length?this._get_string("multiple_selection"):this.get_text(c),
s=this.get_container();this._get_settings().core.html_titles||(h=h.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"));a.vakata.dnd.drag_start(d,{jstree:!0,obj:c},"<ins class='jstree-icon'></ins>"+h);this.data.themes&&(m&&m.attr("class","jstree-"+this.data.themes.theme),f&&f.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=s.offset();this.data.dnd.cw=parseInt(s.width(),10);this.data.dnd.ch=parseInt(s.height(),
10);this.data.dnd.active=!0}}});a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",
title:"jstree"});m=a("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){m.hide();f.hide();a.preventDefault();a.stopImmediatePropagation();return!1}).appendTo("body");f=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(g&&g.length)return g.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(c){var d=a(c.relatedTarget);if((d.is(".jstree")||0===d.closest(".jstree").length)&&
g&&g.length)return g.children("a").trigger(c),m.hide(),f.hide(),c.preventDefault(),c.stopImmediatePropagation(),!1}).appendTo("body");a(document).bind("drag_start.vakata",function(a,c){c.data.jstree&&(m.show(),f&&f.show())});a(document).bind("drag_stop.vakata",function(a,c){c.data.jstree&&(m.hide(),f&&f.hide())})})})(jQuery);(function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=
this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,g){this._prepare_checkboxes(g.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(a){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault();this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):
this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui)this.save_selected(),this.data.cookies&&this.save_cookie("select_node");else return a.stopImmediatePropagation(),!1},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(1E4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},
_fn:{_checkbox_notify:function(a,g){g.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(c){c=c&&-1!=c?this._get_node(c):this.get_container().find("> ul > li");if(!1!==c){var g,m=this,f,d=this._get_settings().checkbox.two_state,h=this._get_settings().checkbox.real_checkboxes,l=this._get_settings().checkbox.real_checkboxes_names;c.each(function(){f=a(this);g=f.is("li")&&(f.hasClass("jstree-checked")||h&&f.children(":checked").length)?"jstree-checked":"jstree-unchecked";f.find("li").addBack().each(function(){var c=
a(this),f;c.children("a"+(m.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(d?"jstree-unchecked":g);h&&(c.children(":checkbox").length?c.children(":checkbox").addClass("jstree-real-checkbox"):(f=l.call(m,c),c.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+f[0]+"' name='"+f[0]+"' value='"+f[1]+"' />")));d?(c.hasClass("jstree-checked")||c.children(":checked").length)&&
c.addClass("jstree-checked").children(":checkbox").prop("checked",!0):("jstree-checked"===g||c.hasClass("jstree-checked")||c.children(":checked").length)&&c.find("li").addBack().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})});d||c.find(".jstree-checked").parent().parent().each(function(){m._repair_state(this)})}},change_state:function(c,g){c=this._get_node(c);var m=!1,f=this._get_settings().checkbox.real_checkboxes;if(!c||-1===c)return!1;g=!1===g||!0===g?g:c.hasClass("jstree-checked");
if(this._get_settings().checkbox.two_state)g?(c.removeClass("jstree-checked").addClass("jstree-unchecked"),f&&c.children(":checkbox").prop("checked",!1)):(c.removeClass("jstree-unchecked").addClass("jstree-checked"),f&&c.children(":checkbox").prop("checked",!0));else{if(g){m=c.find("li").addBack();if(!m.filter(".jstree-checked, .jstree-undetermined").length)return!1;m.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");f&&m.children(":checkbox").prop("checked",!1)}else{m=
c.find("li").addBack();if(!m.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;m.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");f&&m.children(":checkbox").prop("checked",!0);this.data.ui&&(this.data.ui.last_selected=c);this.data.checkbox.last_selected=c}c.parentsUntil(".jstree","li").each(function(){var c=a(this);if(g){if(c.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return c.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),
f&&c.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",!1),!1;c.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");f&&c.children(":checkbox").prop("checked",!1)}else{if(c.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return c.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),f&&c.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",
!1),!1;c.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");f&&c.children(":checkbox").prop("checked",!0)}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(c);return!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var g=this;a.parents(".jstree-closed").each(function(){g.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,
!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!1)});this.__callback()},uncheck_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!0)});this.__callback()},is_checked:function(a){a=this._get_node(a);
return a.length?a.is(".jstree-checked"):!1},get_checked:function(a,g){a=a&&-1!==a?this._get_node(a):this.get_container();return g||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,g){a=a&&-1!==a?this._get_node(a):this.get_container();return g||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},
show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length)if(this._get_settings().checkbox.two_state)a.find("li").addBack().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);else{var g=this._get_settings().checkbox.real_checkboxes,
m=a.find("> ul > .jstree-checked").length,f=a.find("> ul > .jstree-undetermined").length,d=a.find("> ul > li").length;0===d?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):0===m&&0===f?this.change_state(a,!0):m===d?this.change_state(a,!1):(a.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),g&&a.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",!1))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var c=
this,g=this.data.ui.to_select,g=a.map(a.makeArray(g),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();a.each(g,function(a,f){c.check_node(f)});this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}});
a(function(){a.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})})})(jQuery);(function(a){a.vakata.xslt=function(c,f,g){var d=!1,h,l,w;if(!1===d&&window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XSLTemplate"),l=new ActiveXObject("Msxml2.DOMDocument"),l.loadXML(c),w=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),w.loadXML(f),d.stylesheet=w,h=d.createProcessor(),h.input=l,h.transform(),d=h.output}catch(Q){}c=a.parseXML(c);f=a.parseXML(f);!1===d&&
"undefined"!==typeof XSLTProcessor&&(h=new XSLTProcessor,h.importStylesheet(f),d=h.transformToFragment(c,document),d=a("<div />").append(d).html());!1===d&&"undefined"!==typeof c.transformNode&&(d=c.transformNode(f));g.call(null,d)};var c={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',
flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},
g=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,c,g){var d=this;this.load_node_xml(a,function(){d.__callback({obj:d._get_node(a)});c.call(this)},g)},_is_loaded:function(c){var f=this._get_settings().xml_data;c=this._get_node(c);return-1==c||
!c||!f.ajax&&!a.isFunction(f.data)||c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").size()},load_node_xml:function(c,f,g){var d=this.get_settings().xml_data,h=function(){},l=function(){};if((c=this._get_node(c))&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case !d.data&&!d.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(d.data):d.data.call(this,c,a.proxy(function(g){this.parse_xml(g,a.proxy(function(g){g&&(g=
g.replace(/ ?xmlns="[^"]*"/ig,""),10<g.length?(g=a(g),-1!==c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(g),c.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(g.children()),d.clean_node&&this.clean_node(c),f&&f.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),d.correct_state&&(this.correct_state(c),f&&f.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),
f&&f.call(this)))},this))},this));break;case !!d.data&&!d.ajax||!!d.data&&!!d.ajax&&(!c||-1===c):c&&-1!=c||this.parse_xml(d.data,a.proxy(function(g){g?(g=g.replace(/ ?xmlns="[^"]*"/ig,""),10<g.length&&(g=a(g),this.get_container().children("ul").empty().append(g.children()),d.clean_node&&this.clean_node(c),f&&f.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),f&&f.call(this))},this));break;case !d.data&&!!d.ajax||!!d.data&&!!d.ajax&&c&&-1!==c:h=function(a,f,h){var l=this.get_settings().xml_data.ajax.error;
l&&l.call(this,a,f,h);-1!==c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),"success"===f&&d.correct_state&&this.correct_state(c)):"success"===f&&d.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},l=function(g,l,s){g=s.responseText;var t=this.get_settings().xml_data.ajax.success;t&&(g=t.call(this,g,l,s)||g);if(""===g||g&&g.toString&&""===g.toString().replace(/^[\s\n]+$/,""))return h.call(this,s,l,"");this.parse_xml(g,
a.proxy(function(g){g&&(g=g.replace(/ ?xmlns="[^"]*"/ig,""),10<g.length?(g=a(g),-1!==c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(g),c.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(g.children()),d.clean_node&&this.clean_node(c),f&&f.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),d.correct_state&&(this.correct_state(c),f&&f.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),
f&&f.call(this)))},this))},d.ajax.context=this,d.ajax.error=h,d.ajax.success=l,d.ajax.dataType||(d.ajax.dataType="xml"),a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,c)),a.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,c)),a.ajax(d.ajax)}},parse_xml:function(g,f){var d=this._get_settings().xml_data;a.vakata.xslt(g,c[d.xsl],f)},get_xml:function(c,f,d,h,l){var t="",w=this._get_settings(),Q=this,K,H,R,Sa,Ha;c||(c="flat");l||(l=0);(f=this._get_node(f))&&-1!==f||(f=this.get_container().find("> ul > li"));
d=a.isArray(d)?d:["id","class"];!l&&(this.data.types&&-1===a.inArray(w.types.type_attr,d))&&d.push(w.types.type_attr);h=a.isArray(h)?h:[];l||(w.xml_data.get_include_preamble&&(t+='<?xml version="1.0" encoding="UTF-8"?>'),t+="<root>");f.each(function(){t+="<item";R=a(this);a.each(d,function(a,c){var f=R.attr(c);w.xml_data.get_skip_empty&&"undefined"===typeof f||(t+=" "+c+'="'+g((" "+(f||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"')});R.hasClass("jstree-open")&&
(t+=' state="open"');R.hasClass("jstree-closed")&&(t+=' state="closed"');"flat"===c&&(t+=' parent_id="'+g(l)+'"');t+=">";t+="<content>";Sa=R.children("a");Sa.each(function(){K=a(this);Ha=!1;t+="<name";-1!==a.inArray("languages",w.plugins)&&a.each(w.languages,function(a,c){if(K.hasClass(c))return t+=' lang="'+g(c)+'"',Ha=c,!1});h.length&&a.each(h,function(a,c){var f=K.attr(c);w.xml_data.get_skip_empty&&"undefined"===typeof f||(t+=" "+c+'="'+g((" "+f||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig,
" ").replace(/^ /,"").replace(/ $/,""))+'"')});K.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(t+=' icon="'+g(K.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"');K.children("ins").get(0).style.backgroundImage.length&&(t+=' icon="'+g(K.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"');t+=">";t+="<![CDATA["+
Q.get_text(K,Ha)+"]]\x3e";t+="</name>"});t+="</content>";H=R[0].id||!0;R=R.find("> ul > li");H=R.length?Q.get_xml(c,R,d,h,H):"";"nest"==c&&(t+=H);t+="</item>";"flat"==c&&(t+=H)});l||(t+="</root>");return t}}})})(jQuery);(function(a){8<=a().jquery.split(".")[1]?(a.expr[":"].jstree_contains=a.expr.createPseudo(function(a){return function(g){return 0<=(g.textContent||g.innerText||"").toLowerCase().indexOf(a.toLowerCase())}}),a.expr[":"].jstree_title_contains=a.expr.createPseudo(function(a){return function(g){return 0<=
(g.getAttribute("title")||"").toLowerCase().indexOf(a.toLowerCase())}})):(a.expr[":"].jstree_contains=function(a,g,d){return 0<=(a.textContent||a.innerText||"").toLowerCase().indexOf(d[3].toLowerCase())},a.expr[":"].jstree_title_contains=function(a,g,d){return 0<=(a.getAttribute("title")||"").toLowerCase().indexOf(d[3].toLowerCase())});a.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=a();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",
function(c,g){a(this).children("ul").find("li").hide().removeClass("jstree-last");g.rslt.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(c,g){if(""===a.trim(c))this.clear_search();else{var d=
this.get_settings().search,f=this,h=function(){};this.data.search.str=c;if(!g&&!1!==d.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;h=function(a,c,f){var g=this.get_settings().search.ajax.success;g&&(a=g.call(this,a,c,f)||a);this.data.search.to_open=a;this._search_open()};d.ajax.context=this;d.ajax.error=function(){};d.ajax.success=h;a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,c));a.isFunction(d.ajax.data)&&(d.ajax.data=
d.ajax.data.call(this,c));d.ajax.data||(d.ajax.data={search_string:c});if(!d.ajax.dataType||/^json/.exec(d.ajax.dataType))d.ajax.dataType="json";a.ajax(d.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+d.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){f.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,
str:c})}},clear_search:function(c){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=a()},_search_open:function(c){var g=this;c=!0;var d=[],f=[];this.data.search.to_open.length&&(a.each(this.data.search.to_open,function(c,g){if("#"==g)return!0;a(g).length&&a(g).is(".jstree-closed")?d.push(g):f.push(g)}),d.length&&(this.data.search.to_open=f,a.each(d,function(a,c){g.open_node(c,function(){g._search_open(!0)})}),c=!1));c&&this.search(this.data.search.str,
!0)}}})})(jQuery);(function(a){a.vakata.context={hide_on_mouseleave:!1,cnt:a("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(c,g,d,f,h,l,z){a.vakata.context.rtl=!!z;if(c=a.vakata.context.parse(c)){a.vakata.context.vis=!0;a.vakata.context.tgt=g;a.vakata.context.par=l||g||null;a.vakata.context.data=h||null;a.vakata.context.cnt.html(c).css({visibility:"hidden",display:"block",left:0,top:0});if(a.vakata.context.hide_on_mouseleave)a.vakata.context.cnt.one("mouseleave",
function(c){a.vakata.context.hide()});h=a.vakata.context.cnt.height();l=a.vakata.context.cnt.width();d+l>a(document).width()&&(d=a(document).width()-(l+5),a.vakata.context.cnt.find("li > ul").addClass("right"));f+h>a(document).height()&&(f-=h+g[0].offsetHeight,a.vakata.context.cnt.find("li > ul").addClass("bottom"));a.vakata.context.cnt.css({left:d,top:f}).find("li:has(ul)").bind("mouseenter",function(c){c=a(document).width();var f=a(document).height(),g=a(this).children("ul").show();c!==a(document).width()&&
g.toggleClass("right");f!==a(document).height()&&g.toggleClass("bottom")}).bind("mouseleave",function(c){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show();a(document).triggerHandler("context_show.vakata")}},hide:function(){a.vakata.context.vis=!1;a.vakata.context.cnt.attr("class","").css({visibility:"hidden"});a(document).triggerHandler("context_hide.vakata")},parse:function(c,g){if(!c)return!1;var d="",f=!1,h=!0;g||(a.vakata.context.func={});d+="<ul>";a.each(c,function(c,g){if(!g)return!0;
a.vakata.context.func[c]=g.action;!h&&g.separator_before&&(d+="<li class='vakata-separator vakata-separator-before'></li>");h=!1;d+="<li class='"+(g._class||"")+(g._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";g.icon&&-1===g.icon.indexOf("/")&&(d+=" class='"+g.icon+"' ");g.icon&&-1!==g.icon.indexOf("/")&&(d+=" style='background:url("+g.icon+") center center no-repeat;' ");d+=">&#160;</ins><a href='#' rel='"+c+"'>";g.submenu&&(d+="<span style='float:"+(a.vakata.context.rtl?"left":"right")+
";'>&raquo;</span>");d+=g.label+"</a>";g.submenu&&(f=a.vakata.context.parse(g.submenu,!0))&&(d+=f);d+="</li>";g.separator_after&&(d+="<li class='vakata-separator vakata-separator-after'></li>",h=!0)});d=d.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");d+="</ul>";a(document).triggerHandler("context_parse.vakata");return 10<d.length?d:!1},exec:function(c){return a.isFunction(a.vakata.context.func[c])?(a.vakata.context.func[c].call(a.vakata.context.data,a.vakata.context.par),
!0):!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",
title:"vakata"});a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(c){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");a(document).bind("mousedown",function(c){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],c.target)&&
a.vakata.context.hide()});"undefined"!==typeof a.hotkeys&&a(document).bind("keydown","up",function(c){if(a.vakata.context.vis){var g=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();g.length||(g=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());g.addClass("vakata-hover");c.stopImmediatePropagation();c.preventDefault()}}).bind("keydown","down",function(c){if(a.vakata.context.vis){var g=
a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();g.length||(g=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());g.addClass("vakata-hover");c.stopImmediatePropagation();c.preventDefault()}}).bind("keydown","right",function(c){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),
c.stopImmediatePropagation(),c.preventDefault())}).bind("keydown","left",function(c){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),c.stopImmediatePropagation(),c.preventDefault())}).bind("keydown","esc",function(c){a.vakata.context.hide();c.preventDefault()}).bind("keydown","space",function(c){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click();c.preventDefault()})});a.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(c){c.preventDefault();a(c.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(c.currentTarget,c.pageX,c.pageY)},this)).delegate("a","click.jstree",a.proxy(function(c){this.data.contextmenu&&a.vakata.context.hide()},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=
!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,
separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(c,g,d){c=this._get_node(c);var f=this.get_settings().contextmenu,h=c.children("a:visible:eq(0)"),l=!1,l=!1;f.select_node&&(this.data.ui&&!this.is_selected(c))&&(this.deselect_all(),this.select_node(c,
!0));if(f.show_at_node||"undefined"===typeof g||"undefined"===typeof d)l=h.offset(),g=l.left,d=l.top+this.data.core.li_height;l=c.data("jstree")&&c.data("jstree").contextmenu?c.data("jstree").contextmenu:f.items;a.isFunction(l)&&(l=l.call(this,c));this.data.contextmenu=!0;a.vakata.context.show(l,h,g,d,this,c,this._get_settings().core.rtl);this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(jQuery);(function(a){a.jstree.plugin("types",{__init:function(){var c=
this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",a.proxy(function(){var g=c.type_attr,d="",f=this;a.each(c.types,function(c,h){a.each(h,function(a,c){/^(max_depth|max_children|icon|valid_children)$/.test(a)||f.data.types.attach_to.push(a)});if(!h.icon)return!0;if(h.icon.image||h.icon.position)d="default"==c?d+(".jstree-"+f.get_index()+" a > .jstree-icon { "):d+(".jstree-"+f.get_index()+" li["+g+'="'+c+'"] > a > .jstree-icon { '),h.icon.image&&(d+=" background-image:url("+
h.icon.image+"); "),d=h.icon.position?d+(" background-position:"+h.icon.position+"; "):d+" background-position:0 0; ",d+="} "});""!==d&&a.vakata.css.add_sheet({str:d,title:"jstree-types"})},this)).bind("before.jstree",a.proxy(function(c,d){var f,h;if((f=(f=this._get_settings().types.use_data?this._get_node(d.args[0]):!1)&&-1!==f&&f.length?f.data("jstree"):!1)&&f.types&&!1===f.types[d.func]||-1!==a.inArray(d.func,this.data.types.attach_to)&&(d.args[0]&&(d.args[0].tagName||d.args[0].jquery))&&(f=this._get_settings().types.types,
h=this._get_type(d.args[0]),(f[h]&&"undefined"!==typeof f[h][d.func]||f["default"]&&"undefined"!==typeof f["default"][d.func])&&!1===this._check(d.func,d.args[0])))return c.stopImmediatePropagation(),!1},this));d&&this.get_container().bind("load_node.jstree set_type.jstree",a.proxy(function(c,d){var f=d&&d.rslt&&d.rslt.obj&&-1!==d.rslt.obj?this._get_node(d.rslt.obj).parent():this.get_container_ul(),h=!1,l=this._get_settings().types;a.each(l.types,function(a,c){c.icon&&(c.icon.image||c.icon.position)&&
(h="default"===a?f.find("li > a > .jstree-icon"):f.find("li["+l.type_attr+"='"+a+"'] > a > .jstree-icon"),c.icon.image&&h.css("backgroundImage","url("+c.icon.image+")"),h.css("backgroundPosition",c.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,d){d.type&&this._get_settings().types.use_data&&this.set_type(d.type,a)},_get_type:function(a){return(a=
this._get_node(a))&&a.length?a.attr(this._get_settings().types.type_attr)||"default":!1},set_type:function(a,d){d=this._get_node(d);var m=d.length&&a?d.attr(this._get_settings().types.type_attr,a):!1;m&&this.__callback({obj:d,type:a});return m},_check:function(c,d,m){d=this._get_node(d);var f=!1,h=this._get_type(d),l=0,z=this,t=this._get_settings().types,w=!1;if(-1===d)if(t[c])f=t[c];else return;else{if(!1===h)return;(w=t.use_data?d.data("jstree"):!1)&&w.types&&"undefined"!==typeof w.types[c]?f=w.types[c]:
t.types[h]&&"undefined"!==typeof t.types[h][c]?f=t.types[h][c]:t.types["default"]&&"undefined"!==typeof t.types["default"][c]&&(f=t.types["default"][c])}a.isFunction(f)&&(f=f.call(this,d));"max_depth"===c&&(-1!==d&&!1!==m&&-2!==t.max_depth&&0!==f)&&d.children("a:eq(0)").parentsUntil(".jstree","li").each(function(a){if(-1!==t.max_depth&&0>=t.max_depth-(a+1))return f=0,!1;l=0===a?f:z._check(c,this,!1);if(-1!==l&&0>=l-(a+1))return f=0,!1;0<=l&&(l-(a+1)<f||0>f)&&(f=l-(a+1));0<=t.max_depth&&(t.max_depth-
(a+1)<f||0>f)&&(f=t.max_depth-(a+1))});return f},check_move:function(){if(!this.__call_old())return!1;var c=this._get_move(),d=c.rt._get_settings().types,m=c.rt._check("max_children",c.cr),f=c.rt._check("max_depth",c.cr),h=c.rt._check("valid_children",c.cr),l=0,z=1;if("none"===h||a.isArray(h)&&(c.ot&&c.ot._get_type)&&(c.o.each(function(){if(-1===a.inArray(c.ot._get_type(this),h))return z=!1}),!1===z)||-2!==d.max_children&&-1!==m&&(l=-1===c.cr?this.get_container().find("> ul > li").not(c.o).length:
c.cr.find("> ul > li").not(c.o).length,l+c.o.length>m))return!1;if(-2!==d.max_depth&&-1!==f){z=0;if(0===f)return!1;if("undefined"===typeof c.o.d){for(d=c.o;0<d.length;)d=d.find("> ul > li"),z++;c.o.d=z}if(0>f-c.o.d)return!1}return!0},create_node:function(c,d,m,f,h,l){if(!l&&(h||this._is_loaded(c))){var z="string"==typeof d&&d.match(/^before|after$/i)&&-1!==c?this._get_parent(c):this._get_node(c),t=this._get_settings().types,w=this._check("max_children",z),Q=this._check("max_depth",z),K=this._check("valid_children",
z);"string"===typeof m&&(m={data:m});m||(m={});if("none"===K)return!1;if(a.isArray(K))if(!m.attr||!m.attr[t.type_attr])m.attr||(m.attr={}),m.attr[t.type_attr]=K[0];else if(-1===a.inArray(m.attr[t.type_attr],K))return!1;if(-2!==t.max_children&&-1!==w&&(z=-1===z?this.get_container().find("> ul > li").length:z.find("> ul > li").length,z+1>w)||-2!==t.max_depth&&-1!==Q&&0>Q-1)return!1}return this.__call_old(!0,c,d,m,f,h,l)}}})})(jQuery);(function(a){a.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=
this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").addBack().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,d,m){var f=this;this.load_node_html(a,function(){f.__callback({obj:f._get_node(a)});d.call(this)},m)},_is_loaded:function(c){c=this._get_node(c);return-1==c||!c||!this._get_settings().html_data.ajax&&!a.isFunction(this._get_settings().html_data.data)||
c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").size()},load_node_html:function(c,d,m){var f,h=this.get_settings().html_data,l=function(){};f=function(){};if((c=this._get_node(c))&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case a.isFunction(h.data):h.data.call(this,c,a.proxy(function(f){f&&""!==f&&f.toString&&""!==f.toString().replace(/^[\s\n]+$/,"")?(f=a(f),f.is("ul")||(f=a("<ul />").append(f)),-1!=c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),
c.append(f).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),c.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),
this.clean_node(c),d&&d.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),h.correct_state&&(this.correct_state(c),d&&d.call(this))):h.correct_state&&(this.get_container().children("ul").empty(),d&&d.call(this))},this));break;case !h.data&&!h.ajax:c&&-1!=c||(this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||
"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node());d&&d.call(this);break;case !!h.data&&!h.ajax||!!h.data&&!!h.ajax&&(!c||-1===c):c&&-1!=c||(f=a(h.data),f.is("ul")||(f=a("<ul />").append(f)),this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),
this.clean_node());d&&d.call(this);break;case !h.data&&!!h.ajax||!!h.data&&!!h.ajax&&c&&-1!==c:c=this._get_node(c),l=function(a,d,f){var g=this.get_settings().html_data.ajax.error;g&&g.call(this,a,d,f);-1!=c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),"success"===d&&h.correct_state&&this.correct_state(c)):"success"===d&&h.correct_state&&this.get_container().children("ul").empty();m&&m.call(this)},f=function(f,m,w){var Q=this.get_settings().html_data.ajax.success;
Q&&(f=Q.call(this,f,m,w)||f);if(""===f||f&&f.toString&&""===f.toString().replace(/^[\s\n]+$/,""))return l.call(this,w,m,"");f?(f=a(f),f.is("ul")||(f=a("<ul />").append(f)),-1!=c&&c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(f).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),
c.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(c),d&&d.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),h.correct_state&&
(this.correct_state(c),d&&d.call(this))):h.correct_state&&(this.get_container().children("ul").empty(),d&&d.call(this))},h.ajax.context=this,h.ajax.error=l,h.ajax.success=f,h.ajax.dataType||(h.ajax.dataType="html"),a.isFunction(h.ajax.url)&&(h.ajax.url=h.ajax.url.call(this,c)),a.isFunction(h.ajax.data)&&(h.ajax.data=h.ajax.data.call(this,c)),a.ajax(h.ajax)}}}});a.jstree.defaults.plugins.push("html_data")})(jQuery);(function(a){a.jstree.plugin("themeroller",{__init:function(){var c=this._get_settings().themeroller;
this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(d){a(d.currentTarget).hasClass("jstree-loading")||a(this).addClass(c.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(c.item_h)}).bind("init.jstree",a.proxy(function(a,c){c.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(c.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",
a.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",a.proxy(function(a){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,d){d.rslt.obj.children("ins.jstree-icon").removeClass(c.opened+" "+c.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===
this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_open+" "+c.item_clsd).addClass(c.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,d){d.rslt.obj.children("a").addClass(c.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(a,d){this.get_container().find("a."+c.item_a).removeClass(c.item_a).end().find("a.jstree-clicked").addClass(c.item_a)},this)).bind("dehover_node.jstree",
a.proxy(function(a,d){d.rslt.obj.children("a").removeClass(c.item_h)},this)).bind("hover_node.jstree",a.proxy(function(a,d){this.get_container().find("a."+c.item_h).not(d.rslt.obj).removeClass(c.item_h);d.rslt.obj.children("a").addClass(c.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.o);this._themeroller(c.rslt.op)},this))},__destroy:function(){var c=this._get_settings().themeroller,d=["ui-icon"];a.each(c,function(a,c){c=c.split(" ");c.length&&(d=d.concat(c))});
this.get_container().removeClass("ui-widget-content").find("."+d.join(", .")).removeClass(d.join(" "))},_fn:{_themeroller:function(a){var d=this._get_settings().themeroller;a=(a=a&&-1!=a?this._get_node(a):this.get_container_ul())&&-1!=a?a.parent():this.get_container_ul();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(d.opened).addClass("ui-icon "+d.closed).end().children("a").addClass(d.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(d.item_clsd,
"").replace(d.item_open,"").replace(d.item_leaf,"").indexOf("ui-icon-")}).removeClass(d.item_leaf+" "+d.item_open).addClass(d.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(d.closed).addClass("ui-icon "+d.opened).end().children("a").addClass(d.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(d.item_clsd,"").replace(d.item_open,"").replace(d.item_leaf,"").indexOf("ui-icon-")}).removeClass(d.item_leaf+
" "+d.item_clsd).addClass(d.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(d.closed+" ui-icon "+d.opened).end().children("a").addClass(d.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(d.item_clsd,"").replace(d.item_open,"").replace(d.item_leaf,"").indexOf("ui-icon-")}).removeClass(d.item_clsd+" "+d.item_open).addClass(d.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",
closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});a(function(){a.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",title:"jstree"})})})(jQuery);(function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",
a.proxy(function(c,d){var h=[],f=!0,l;"move_node"==d.func&&(!0===d.args[4]&&d.args[0].o&&d.args[0].o.length)&&(d.args[0].o.children("a").each(function(){h.push(a(this).text().replace(/^\s+/g,""))}),f=this._check_unique(h,d.args[0].np.find("> ul > li").not(d.args[0].o),"move_node"));"create_node"==d.func&&(d.args[4]||this._is_loaded(d.args[0]))&&(f=this._get_node(d.args[0]),!d.args[1]||"before"!==d.args[1]&&"after"!==d.args[1]||(f=this._get_parent(d.args[0]))&&-1!==f||(f=this.get_container()),"string"===
typeof d.args[2]?h.push(d.args[2]):d.args[2]&&d.args[2].data?h.push(d.args[2].data):h.push(this._get_string("new_node")),f=this._check_unique(h,f.find("> ul > li"),"create_node"));"rename_node"==d.func&&(h.push(d.args[1]),l=this._get_node(d.args[0]),(f=this._get_parent(l))&&-1!==f||(f=this.get_container()),f=this._check_unique(h,f.find("> ul > li").not(l),"rename_node"));if(!f)return c.stopPropagation(),!1},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(c,d,h){var f=[],l=!0;
d.children("a").each(function(){f.push(a(this).text().replace(/^\s+/g,""))});if(!f.length||!c.length)return!0;a.each(c,function(c,d){if(-1!==a.inArray(d,f))return l=!1});l||this._get_settings().unique.error_callback.call(null,c,d,h);return l},check_move:function(){if(!this.__call_old())return!1;var c=this._get_move(),d=[];return c.o&&c.o.length?(c.o.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))}),this._check_unique(d,c.np.find("> ul > li").not(c.o),"check_move")):!0}}})})(jQuery);
(function(a){a.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",a.proxy(function(a,d){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",a.proxy(function(a,d){this._prepare_wholerow_span(d&&d.rslt&&d.rslt.obj?d.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",
a.proxy(function(a,d){this.data.to&&clearTimeout(this.data.to);this.data.to=setTimeout(function(a,c){return function(){a._prepare_wholerow_ul(c)}}(this,d&&d.rslt&&d.rslt.obj?d.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",a.proxy(function(a,d){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",a.proxy(function(c,d){d.rslt.obj.each(function(){d.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((a(this).offset().top-d.inst.get_container().offset().top+d.inst.get_container()[0].scrollTop)/d.inst.data.core.li_height,10)+")").children("a").attr("class",d.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",a.proxy(function(a,d){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===a.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((d.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",d.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(c){var d=a(c.currentTarget);"A"===c.target.tagName||"INS"===c.target.tagName&&d.closest("li").is(".jstree-open, .jstree-closed")||(d.closest("li").children("a:visible:eq(0)").click(),c.stopImmediatePropagation())}).delegate("li",
"mouseover.jstree",a.proxy(function(c){c.stopImmediatePropagation();if(a(c.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(c.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",a.proxy(function(c){a(c.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(c.currentTarget)},this));(h||d)&&a.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();
this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(c){c=c&&-1!=c?this._get_node(c):this.get_container().find("> ul > li");!1!==c&&c.each(function(){a(this).find("li").addBack().each(function(){var c=a(this);if(c.children(".jstree-wholerow-span").length)return!0;c.prepend("<span class='jstree-wholerow-span' style='width:"+18*c.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var a=this.get_container().children("ul").eq(0),
d=a.html();a.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==d&&(this.data.wholerow.last_html=d,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(a.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(a.parent()[0].scrollWidth).css("top",-1*(a.height()+(h?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});a(function(){var c=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
l&&(c+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(h||d)c+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";a.vakata.css.add_sheet({str:c,title:"jstree"})})})(jQuery);(function(a){var c=
["getChildren","getChildrenCount","getAttr","getName","getProps"],d=function(c,d){var g=!0;c=c||{};d=[].concat(d);a.each(d,function(d,f){if(!a.isFunction(c[f]))return g=!1});return g};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(h,f){var l=-1==h?this._get_settings().model.object:h.data("jstree_model");if(!d(l,c))return f.call(null,!1);this._get_settings().model.async?l.getChildren(a.proxy(function(a){this.model_done(a,
f)},this)):this.model_done(l.getChildren(),f)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(c,d){var g=[],h=this._get_settings(),l=this;a.isArray(c)||(c=[c]);a.each(c,function(c,d){var f=d.getProps()||{};f.attr=d.getAttr()||{};d.getChildrenCount()&&(f.state="closed");f.data=d.getName();a.isArray(f.data)||(f.data=[f.data]);l.data.types&&a.isFunction(d.getType)&&(f.attr[h.types.type_attr]=d.getType());f.attr.id&&h.model.id_prefix&&(f.attr.id=h.model.id_prefix+f.attr.id);f.metadata||
(f.metadata={});f.metadata.jstree_model=d;g.push(f)});d.call(null,g)}}})})(jQuery)}})();
(function(d){d.color={};d.color.make=function(h,a,c,g){var m={};m.r=h||0;m.g=a||0;m.b=c||0;m.a=null!=g?g:1;m.add=function(a,c){for(var d=0;d<a.length;++d)m[a.charAt(d)]+=c;return m.normalize()};m.scale=function(a,c){for(var d=0;d<a.length;++d)m[a.charAt(d)]*=c;return m.normalize()};m.toString=function(){return 1<=m.a?"rgb("+[m.r,m.g,m.b].join()+")":"rgba("+[m.r,m.g,m.b,m.a].join()+")"};m.normalize=function(){function a(c,d,f){return d<c?c:d>f?f:d}m.r=a(0,parseInt(m.r),255);m.g=a(0,parseInt(m.g),255);
m.b=a(0,parseInt(m.b),255);m.a=a(0,m.a,1);return m};m.clone=function(){return d.color.make(m.r,m.b,m.g,m.a)};return m.normalize()};d.color.extract=function(h,a){var c;do{c=h.css(a).toLowerCase();if(""!=c&&"transparent"!=c)break;h=h.parent()}while(!d.nodeName(h.get(0),"body"));"rgba(0, 0, 0, 0)"==c&&(c="transparent");return d.color.parse(c)};d.color.parse=function(l){var a,c=d.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(l))return c(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(l))return c(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(l))return c(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(l))return c(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(l))return c(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(l))return c(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));l=d.trim(l).toLowerCase();if("transparent"==l)return c(255,255,255,0);a=h[l]||[0,0,0];return c(a[0],a[1],a[2])};var h={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d,h,l){var a=h.event,c;a.special.smartresize={setup:function(){h(this).bind("resize",a.special.smartresize.handler)},teardown:function(){h(this).unbind("resize",a.special.smartresize.handler)},handler:function(a,d){var g=this,h=arguments;a.type="smartresize";c&&clearTimeout(c);c=setTimeout(function(){jQuery.event.handle.apply(g,h)},"execAsap"===d?0:100)}};h.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])};h.Mason=function(a,c){this.element=
h(c);this._create(a);this._init()};var g=["position","height"];h.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1};h.Mason.prototype={_filterFindBricks:function(a){var c=this.options.itemSelector;return c?a.filter(c).add(a.find(c)):a},_getBricks:function(a){return this._filterFindBricks(a).css({position:"absolute"}).addClass("masonry-brick")},_create:function(a){this.options=h.extend(!0,{},h.Mason.settings,a);this.styleQueue=
[];this.reloadItems();a=this.element[0].style;this.originalStyle={};for(var c=0,m=g.length;c<m;c++){var l=g[c];this.originalStyle[l]=a[l]||""}this.element.css({position:"relative"});this.horizontalDirection=this.options.isRTL?"right":"left";this.offset={};a=h(document.createElement("div"));this.element.prepend(a);this.offset.y=Math.round(a.position().top);this.options.isRTL?(a.css({"float":"right",display:"inline-block"}),this.offset.x=Math.round(this.element.outerWidth()-a.position().left)):this.offset.x=
Math.round(a.position().left);a.remove();var t=this;setTimeout(function(){t.element.addClass("masonry")},0);this.options.isResizable&&h(d).bind("smartresize.masonry",function(){t.resize()})},_init:function(a){this._getColumns("masonry");this._reLayout(a)},option:function(a,c){h.isPlainObject(a)&&(this.options=h.extend(!0,this.options,a))},layout:function(a,c){for(var d,g,m,l,Q,K,H=0,R=a.length;H<R;H++)if(d=h(a[H]),g=Math.ceil(d.outerWidth(!0)/this.columnWidth),g=Math.min(g,this.cols),1===g)this._placeBrick(d,
this.colYs);else{m=this.cols+1-g;l=[];for(K=0;K<m;K++)Q=this.colYs.slice(K,K+g),l[K]=Math.max.apply(Math,Q);this._placeBrick(d,l)}R={};R.height=Math.max.apply(Math,this.colYs)-this.offset.y;if(this.options.isFitWidth){d=0;for(H=this.cols;--H&&this.colYs[H]===this.offset.y;)d++;R.width=(this.cols-d)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:R});d=this.isLaidOut?this.options.isAnimated?"animate":"css":"css";g=this.options.animationOptions;H=0;for(R=this.styleQueue.length;H<
R;H++)m=this.styleQueue[H],m.$el[d](m.style,g);this.styleQueue=[];c&&c.call(a);this.isLaidOut=!0},_getColumns:function(){var a=(this.options.isFitWidth?this.element.parent():this.element).width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(!0)||a;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((a+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(a,c){for(var d=Math.min.apply(Math,c),g=0,h=0,m=c.length;h<m;h++)if(c[h]===
d){g=h;break}h={top:d};h[this.horizontalDirection]=this.columnWidth*g+this.offset.x;this.styleQueue.push({$el:a,style:h});d+=a.outerHeight(!0);m=this.cols+1-m;for(h=0;h<m;h++)this.colYs[g+h]=d},resize:function(){var a=this.cols;this._getColumns("masonry");this.cols!==a&&this._reLayout()},_reLayout:function(a){var c=this.cols;for(this.colYs=[];c--;)this.colYs.push(this.offset.y);this.layout(this.$bricks,a)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(a){this.reloadItems();
this._init(a)},appended:function(a,c,d){if(c){this._filterFindBricks(a).css({top:this.element.height()});var g=this;setTimeout(function(){g._appended(a,d)},1)}else this._appended(a,d)},_appended:function(a,c){var d=this._getBricks(a);this.$bricks=this.$bricks.add(d);this.layout(d,c)},remove:function(a){this.$bricks=this.$bricks.not(a);a.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});for(var a=this.element[0].style,
c=0,m=g.length;c<m;c++){var l=g[c];a[l]=this.originalStyle[l]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry");h(d).unbind(".masonry")}};h.fn.imagesLoaded=function(a){function c(){0>=--m&&this.src!==Q&&(setTimeout(d),h.unbind("load error",c))}function d(){a.call(g,h)}var g=this,h=g.find("img").add(g.filter("img")),m=h.length,Q="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";m||d();h.bind("load error",c).each(function(){if(this.complete||this.complete===
l){var a=this.src;this.src=Q;this.src=a}});return g};var m=function(a){this.console&&console.error(a)};h.fn.masonry=function(a){if("string"==typeof a){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=h.data(this,"masonry");d?h.isFunction(d[a])&&"_"!==a.charAt(0)?d[a].apply(d,c):m("no such method '"+a+"' for masonry instance"):m("cannot call methods on masonry prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){var c=h.data(this,"masonry");
c?(c.option(a||{}),c._init()):h.data(this,"masonry",new h.Mason(a,this))});return this}})(window,jQuery);
jQuery.cookie=function(d,h,l){if(1<arguments.length&&"[object Object]"!==String(h)){l=jQuery.extend({},l);if(null===h||void 0===h)l.expires=-1;if("number"===typeof l.expires){var a=l.expires,c=l.expires=new Date;c.setDate(c.getDate()+a)}h=String(h);return document.cookie=[encodeURIComponent(d),"=",l.raw?h:encodeURIComponent(h),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}l=h||{};c=l.raw?function(a){return a}:
decodeURIComponent;return(a=RegExp("(?:^|; )"+encodeURIComponent(d)+"=([^;]*)").exec(document.cookie))?c(a[1]):null};
d3=function(){function d(e){return null!=e&&!isNaN(e)}function h(e){return e.length}function l(e,u){try{for(var a in u)Object.defineProperty(e.prototype,a,{value:u[a],enumerable:!1})}catch(c){e.prototype=u}}function a(){}function c(){}function g(e,u,a){return function(){var c=a.apply(u,arguments);return c===u?e:c}}function m(){}function f(e){function u(){for(var u,a=n,c=-1,G=a.length;++c<G;)(u=a[c].on)&&u.apply(this,arguments);return e}var n=[],c=new a;return u.on=function(u,a){var d,r=c.get(u);return 2>
arguments.length?r&&r.on:(r&&(r.on=null,n=n.slice(0,d=n.indexOf(r)).concat(n.slice(d+1)),c.remove(u)),a&&n.push(c.set(u,{on:a})),e)},u}function s(){p.event.stopPropagation();p.event.preventDefault()}function v(){for(var e,u=p.event;e=u.sourceEvent;)u=e;return u}function z(e,u){function a(){e.on(u,null)}e.on(u,function(){s();a()},!0);setTimeout(a,0)}function t(e){for(var u=new m,a=0,c=arguments.length;++a<c;)u[arguments[a]]=f(u);return u.of=function(a,n){return function(c){try{var G=c.sourceEvent=
p.event;c.target=e;p.event=c;u[c.type].apply(a,n)}finally{p.event=G}}},u}function w(e,u){var a=e.ownerSVGElement||e;if(a.createSVGPoint){var c=a.createSVGPoint();if(0>Ob&&(ca.scrollX||ca.scrollY)){var a=p.select(ga.body).append("svg").style("position","absolute").style("top",0).style("left",0),A=a[0][0].getScreenCTM();Ob=!(A.f||A.e);a.remove()}return Ob?(c.x=u.pageX,c.y=u.pageY):(c.x=u.clientX,c.y=u.clientY),c=c.matrixTransform(e.getScreenCTM().inverse()),[c.x,c.y]}a=e.getBoundingClientRect();return[u.clientX-
a.left-e.clientLeft,u.clientY-a.top-e.clientTop]}function Q(e){for(var u=-1,a=e.length,c=[];++u<a;)c.push(e[u]);return c}function K(e){return Pb(e,L),e}function H(e){return function(){return $c(e,this)}}function R(e){return function(){return ad(e,this)}}function Sa(e,u){function a(){this.removeAttribute(e)}function c(){this.removeAttributeNS(e.space,e.local)}function A(){this.setAttribute(e,u)}function d(){this.setAttributeNS(e.space,e.local,u)}function D(){var a=u.apply(this,arguments);null==a?this.removeAttribute(e):
this.setAttribute(e,a)}function r(){var a=u.apply(this,arguments);null==a?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}return e=p.ns.qualify(e),null==u?e.local?c:a:"function"==typeof u?e.local?r:D:e.local?d:A}function Ha(e){return e.trim().replace(/\s+/g," ")}function Yc(e){return RegExp("(?:^|\\s+)"+p.requote(e)+"(?:\\s+|$)","g")}function Zc(e,u){function a(){for(var n=-1;++n<A;)e[n](this,u)}function c(){for(var a=-1,n=u.apply(this,arguments);++a<A;)e[a](this,n)}
e=e.trim().split(/\s+/).map(rf);var A=e.length;return"function"==typeof u?c:a}function rf(e){var u=Yc(e);return function(a,c){if(A=a.classList)return c?A.add(e):A.remove(e);var A=a.getAttribute("class")||"";c?(u.lastIndex=0,u.test(A)||a.setAttribute("class",Ha(A+" "+e))):a.setAttribute("class",Ha(A.replace(u," ")))}}function bd(e,a,n){function c(){this.style.removeProperty(e)}function A(){this.style.setProperty(e,a,n)}function d(){var c=a.apply(this,arguments);null==c?this.style.removeProperty(e):
this.style.setProperty(e,c,n)}return null==a?c:"function"==typeof a?d:A}function cd(e,a){function n(){delete this[e]}function c(){this[e]=a}function A(){var n=a.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==a?n:"function"==typeof a?A:c}function dd(e){return function(){return ed(this,e)}}function sf(e){return arguments.length||(e=p.ascending),function(a,n){return!a-!n||e(a.__data__,n.__data__)}}function Z(){}function fd(e,a,n){function c(){var a=this[D];a&&(this.removeEventListener(e,
a,a.$),delete this[D])}function A(){var A=S(a,wa(arguments));c.call(this);this.addEventListener(e,this[D]=A,A.$=n);A._=a}function d(){var a,u=RegExp("^__on([^.]+)"+p.requote(e)+"$"),n;for(n in this)if(a=n.match(u)){var c=this[n];this.removeEventListener(a[1],c,c.$);delete this[n]}}var D="__on"+e,r=e.indexOf("."),S=hd;0<r&&(e=e.substring(0,r));var f=Qb.get(e);return f&&(e=f,S=tf),r?a?A:c:a?Z:d}function hd(e,a){return function(n){var c=p.event;p.event=n;a[0]=this.__data__;try{e.apply(this,a)}finally{p.event=
c}}}function tf(e,a){var n=hd(e,a);return function(e){var a=e.relatedTarget;a&&(a===this||a.compareDocumentPosition(this)&8)||n.call(this,e)}}function xa(e,a){for(var n=0,c=e.length;c>n;n++)for(var A,d=e[n],D=0,r=d.length;r>D;D++)(A=d[D])&&a(A,D,n);return e}function id(e){return Pb(e,Ca),e}function Ia(){}function Ja(e,a,n){return new Sb(e,a,n)}function Sb(e,a,n){this.h=e;this.s=a;this.l=n}function cb(e,a,n){function c(e){return 360<e?e-=360:0>e&&(e+=360),60>e?A+(d-A)*e/60:180>e?d:240>e?A+(d-A)*(240-
e)/60:A}var A,d;return e%=360,0>e&&(e+=360),a=0>a?0:1<a?1:a,n=0>n?0:1<n?1:n,d=0.5>=n?n*(1+a):n+a-n*a,A=2*n-d,pa(Math.round(255*c(e+120)),Math.round(255*c(e)),Math.round(255*c(e-120)))}function jd(e){return(e=Math.sin(e/2))*e}function Ka(e,a,n){return new db(e,a,n)}function db(e,a,n){this.h=e;this.c=a;this.l=n}function Tb(e,a,n){return La(n,Math.cos(e*=J)*a,Math.sin(e)*a)}function La(e,a,n){return new eb(e,a,n)}function eb(e,a,n){this.l=e;this.a=a;this.b=n}function kd(e,a,n){e=(e+16)/116;a=e+a/500;
n=e-n/200;return a=Ub(a)*ld,e=Ub(e)*md,n=Ub(n)*nd,pa(Vb(3.2404542*a-1.5371385*e-0.4985314*n),Vb(-0.969266*a+1.8760108*e+0.041556*n),Vb(0.0556434*a-0.2040259*e+1.0572252*n))}function Ub(e){return 0.206893034<e?e*e*e:(e-4/29)/7.787037}function Wb(e){return 0.008856<e?Math.pow(e,1/3):7.787037*e+4/29}function Vb(e){return Math.round(255*(0.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-0.055))}function pa(e,a,n){return new Xb(e,a,n)}function Xb(e,a,n){this.r=e;this.g=a;this.b=n}function Ma(e){return 16>e?"0"+
Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function Yb(e,a,n){var c,A,d,D=0,r=0,f=0;if(c=/([a-z]+)\((.*)\)/i.exec(e))switch(A=c[2].split(","),c[1]){case "hsl":return n(parseFloat(A[0]),parseFloat(A[1])/100,parseFloat(A[2])/100);case "rgb":return a(Zb(A[0]),Zb(A[1]),Zb(A[2]))}return(d=fb.get(e))?a(d.r,d.g,d.b):(null!=e&&"#"===e.charAt(0)&&(4===e.length?(D=e.charAt(1),D+=D,r=e.charAt(2),r+=r,f=e.charAt(3),f+=f):7===e.length&&(D=e.substring(1,3),r=e.substring(3,5),f=e.substring(5,7)),D=
parseInt(D,16),r=parseInt(r,16),f=parseInt(f,16)),a(D,r,f))}function od(e,a,n){var c,A,d=Math.min(e/=255,a/=255,n/=255),D=Math.max(e,a,n),r=D-d,f=(D+d)/2;return r?(A=0.5>f?r/(D+d):r/(2-D-d),c=e==D?(a-n)/r+(n>a?6:0):a==D?(n-e)/r+2:(e-a)/r+4,c*=60):A=c=0,Ja(c,A,f)}function pd(e,a,n){e=$b(e);a=$b(a);n=$b(n);var c=Wb((0.4124564*e+0.3575761*a+0.1804375*n)/ld),d=Wb((0.2126729*e+0.7151522*a+0.072175*n)/md);e=Wb((0.0193339*e+0.119192*a+0.9503041*n)/nd);return La(116*d-16,500*(c-d),200*(d-e))}function $b(e){return 0.04045>=
(e/=255)?e/12.92:Math.pow((e+0.055)/1.055,2.4)}function Zb(e){var a=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*a):a}function O(e){return"function"==typeof e?e:function(){return e}}function ia(e){return e}function uf(e){return 1===e.length?function(a,n){e(null==a?n:null)}:e}function qd(e,a){function n(e,n,c){3>arguments.length&&(c=n,n=null);var q=p.xhr(e,a,c);return q.row=function(e){return arguments.length?q.response(null==(n=e)?d:A(e)):n},q.row(n)}function d(e){return n.parse(e.responseText)}
function A(e){return function(a){return n.parse(a.responseText,e)}}function q(a){return a.map(D).join(e)}function D(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var r=RegExp('["'+e+"\n]"),f=e.charCodeAt(0);return n.parse=function(e,a){var u;return n.parseRows(e,function(e,n){if(u)return u(e,n-1);var c=Function("d","return {"+e.map(function(e,a){return JSON.stringify(e)+": d["+a+"]"}).join(",")+"}");u=a?function(e,u){return a(c(e),u)}:c})},n.parseRows=function(e,a){function u(){if(r>=q)return A;
if(c)return c=!1,d;var a=r;if(34===e.charCodeAt(a)){for(var n=a;n++<q;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}r=n+2;var G=e.charCodeAt(n+1);return 13===G?(c=!0,10===e.charCodeAt(n+2)&&++r):10===G&&(c=!0),e.substring(a+1,n).replace(/""/g,'"')}for(;q>r;){G=e.charCodeAt(r++);n=1;if(10===G)c=!0;else if(13===G)c=!0,10===e.charCodeAt(r)&&(++r,++n);else if(G!==f)continue;return e.substring(a,r-n)}return e.substring(a)}for(var n,c,d={},A={},G=[],q=e.length,r=0,D=0;(n=u())!==A;){for(var g=
[];n!==d&&n!==A;)g.push(n),n=u();a&&!(g=a(g,D++))||G.push(g)}return G},n.format=function(a){if(Array.isArray(a[0]))return n.formatRows(a);var u=new c,d=[];return a.forEach(function(e){for(var a in e)u.has(a)||d.push(u.add(a))}),[d.map(D).join(e)].concat(a.map(function(a){return d.map(function(e){return D(a[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(q).join("\n")},n}function ac(){for(var e,a=Date.now(),n=Na;n;)e=a-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;e=rd()-a;
24<e?(isFinite(e)&&(clearTimeout(gb),gb=setTimeout(ac,e)),hb=0):(hb=1,sd(ac))}function rd(){for(var e=null,a=Na,n=1/0;a;)a.flush?(delete bc[a.callback.id],a=e?e.next=a.next:Na=a.next):(n=Math.min(n,a.then+a.delay),a=(e=a).next);return n}function cc(e,a){return a-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function vf(e){return e+""}function ib(e,a){e&&td.hasOwnProperty(e.type)&&td[e.type](e,a)}function dc(e,a,n){var c=-1,d=e.length-n;for(a.lineStart();++c<d;)n=e[c],a.point(n[0],n[1]);a.lineEnd()}function ud(e,
a){var n=-1,c=e.length;for(a.polygonStart();++n<c;)dc(e[n],a,1);a.polygonEnd()}function wf(){function e(e,a){e*=J;a=a*J/2+C/4;var u=e-c,n=Math.cos(a),f=Math.sin(a),g=q*f,h=jb,m=kb,l=d*n+g*Math.cos(u),u=g*Math.sin(u);jb=h*l-m*u;kb=m*l+h*u;c=e;d=n;q=f}var a,n,c,d,q;ya.point=function(D,r){ya.point=e;c=(a=D)*J;d=Math.cos(r=(n=r)*J/2+C/4);q=Math.sin(r)};ya.lineEnd=function(){e(a,n)}}function vd(e){function a(e,u){c>e&&(c=e);e>q&&(q=e);d>u&&(d=u);u>D&&(D=u)}function n(){r.point=r.lineEnd=Z}var c,d,q,D,
r={point:a,lineStart:Z,lineEnd:Z,polygonStart:function(){r.lineEnd=n},polygonEnd:function(){r.point=a}};return function(a){return D=q=-(c=d=1/0),p.geo.stream(a,e(r)),[[c,d],[q,D]]}}function wd(e,a){if(!ba){++ka;e*=J;var n=Math.cos(a*=J);X+=(n*Math.cos(e)-X)/ka;Y+=(n*Math.sin(e)-Y)/ka;W+=(Math.sin(a)-W)/ka}}function xf(){var e,a;ba=1;ec();ba=2;var n=la.point;la.point=function(c,d){n(e=c,a=d)};la.lineEnd=function(){la.point(e,a);fc();la.lineEnd=fc}}function ec(){function e(e,d){e*=J;var D=Math.cos(d*=
J),r=D*Math.cos(e),D=D*Math.sin(e),f=Math.sin(d),g=Math.atan2(Math.sqrt((g=n*f-c*D)*g+(g=c*r-a*f)*g+(g=a*D-n*r)*g),a*r+n*D+c*f);ka+=g;X+=g*(a+(a=r));Y+=g*(n+(n=D));W+=g*(c+(c=f))}var a,n,c;1<ba||(1>ba&&(ba=1,ka=X=Y=W=0),la.point=function(d,q){d*=J;var D=Math.cos(q*=J);a=D*Math.cos(d);n=D*Math.sin(d);c=Math.sin(q);la.point=e})}function fc(){la.point=wd}function lb(e){var a=e[0];e=e[1];var n=Math.cos(e);return[n*Math.cos(a),n*Math.sin(a),Math.sin(e)]}function mb(e,a){return e[0]*a[0]+e[1]*a[1]+e[2]*
a[2]}function xd(e,a){return[e[1]*a[2]-e[2]*a[1],e[2]*a[0]-e[0]*a[2],e[0]*a[1]-e[1]*a[0]]}function gc(e,a){e[0]+=a[0];e[1]+=a[1];e[2]+=a[2]}function nb(e,a){return[e[0]*a,e[1]*a,e[2]*a]}function Ta(){return!0}function hc(e){return[Math.atan2(e[1],e[0]),Math.asin(Math.max(-1,Math.min(1,e[2])))]}function ob(e,a){return Math.abs(e[0]-a[0])<N&&Math.abs(e[1]-a[1])<N}function yd(e,a,n,c,d){var q=[],D=[];if(e.forEach(function(e){if(!(0>=(a=e.length-1))){var a,u=e[0],n=e[a];if(ob(u,n)){d.lineStart();for(n=
0;a>n;++n)d.point((u=e[n])[0],u[1]);return d.lineEnd(),void 0}e={point:u,points:e,other:null,visited:!1,entry:!0,subject:!0};u={point:u,points:[u],other:e,visited:!1,entry:!1,subject:!1};e.other=u;q.push(e);D.push(u);e={point:n,points:[n],other:null,visited:!1,entry:!1,subject:!0};u={point:n,points:[n],other:e,visited:!1,entry:!0,subject:!1};e.other=u;q.push(e);D.push(u)}}),D.sort(a),zd(q),zd(D),q.length){if(n)for(e=1,n=!n(D[0].point),a=D.length;a>e;++e)D[e].entry=n=!n;for(var r,f=q[0];;){for(n=f;n.visited;)if((n=
n.next)===f)return;a=n.points;d.lineStart();do{if(n.visited=n.other.visited=!0,n.entry){if(n.subject)for(e=0;e<a.length;e++)d.point((r=a[e])[0],r[1]);else c(n.point,n.next.point,1,d);n=n.next}else{if(n.subject)for(a=n.prev.points,e=a.length;0<=--e;)d.point((r=a[e])[0],r[1]);else c(n.point,n.prev.point,-1,d);n=n.prev}n=n.other;a=n.points}while(!n.visited);d.lineEnd()}}}function zd(e){if(a=e.length){for(var a,n,c=0,d=e[0];++c<a;)d.next=n=e[c],n.prev=d,d=n;d.next=n=e[0];n.prev=d}}function Ad(e,a,n){return function(c){function d(a,
u){e(a,u)&&c.point(a,u)}function q(e,a){B.point(e,a)}function D(){y.point=q;B.lineStart()}function r(){y.point=d;B.lineEnd()}function f(e,a){M.point(e,a);x.push([e,a])}function g(){M.lineStart();x=[]}function h(){f(x[0][0],x[0][1]);M.lineEnd();var e;e=M.clean();var a=I.buffer(),u=a.length;if(!u)return E=!0,s+=Bd(x,-1),x=null,void 0;if(x=null,1&e){e=a[0];l+=Bd(e,1);var n,u=e.length-1,a=-1;for(c.lineStart();++a<u;)c.point((n=e[a])[0],n[1]);return c.lineEnd(),void 0}1<u&&2&e&&a.push(a.pop().concat(a.shift()));
m.push(a.filter(yf))}var m,l,s,E,x,B=a(c),y={point:d,lineStart:D,lineEnd:r,polygonStart:function(){y.point=f;y.lineStart=g;y.lineEnd=h;E=!1;s=l=0;m=[];c.polygonStart()},polygonEnd:function(){y.point=d;y.lineStart=D;y.lineEnd=r;m=p.merge(m);m.length?yd(m,zf,null,n,c):(-N>l||E&&-N>s)&&(c.lineStart(),n(null,null,1,c),c.lineEnd());c.polygonEnd();m=null},sphere:function(){c.polygonStart();c.lineStart();n(null,null,1,c);c.lineEnd();c.polygonEnd()}},I=Cd(),M=a(I);return y}}function yf(e){return 1<e.length}
function Cd(){var e,a=[];return{lineStart:function(){a.push(e=[])},point:function(a,u){e.push([a,u])},lineEnd:Z,buffer:function(){var n=a;return a=[],e=null,n},rejoin:function(){1<a.length&&a.push(a.pop().concat(a.shift()))}}}function Bd(e,a){if(!(n=e.length))return 0;var n,c,d,q=0,D=0;c=e[0];d=c[0];for(var r=c[1],f=Math.cos(r),g=Math.atan2(a*Math.sin(d)*f,Math.sin(r)),h=1-a*Math.cos(d)*f,m=g;++q<n;)c=e[q],f=Math.cos(r=c[1]),c=Math.atan2(a*Math.sin(d=c[0])*f,Math.sin(r)),d=1-a*Math.cos(d)*f,Math.abs(h-
2)<N&&Math.abs(d-2)<N||(Math.abs(d)<N||Math.abs(h)<N||(Math.abs(Math.abs(c-g)-C)<N?2<d+h&&(D+=4*(c-g)):D+=Math.abs(h-2)<N?4*(c-m):((3*C+c-g)%(2*C)-C)*(h+d)),m=g,g=c,h=d);return D}function zf(e,a){return(0>(e=e.point)[0]?e[1]-C/2-N:C/2-e[1])-(0>(a=a.point)[0]?a[1]-C/2-N:C/2-a[1])}function Af(e){function a(e,u){return Math.cos(e)*Math.cos(u)>d}function n(e,a,u){var n=lb(e),c=lb(a),G=[1,0,0],c=xd(n,c),q=mb(c,c),n=c[0],r=q-n*n;if(!r)return!u&&e;q=d*q/r;r=-d*n/r;n=xd(G,c);G=nb(G,q);c=nb(c,r);gc(G,c);c=
mb(G,n);q=mb(n,n);r=c*c-q*(mb(G,G)-1);if(!(0>r)){var f=Math.sqrt(r),r=nb(n,(-c-f)/q);if(gc(r,G),r=hc(r),!u)return r;var D;u=e[0];var g=a[0];e=e[1];a=a[1];u>g&&(D=u,u=g,g=D);var h=g-u,m=Math.abs(h-C)<N,l=m||N>h;if(!m&&e>a&&(D=e,e=a,a=D),l?m?0<e+a^r[1]<(Math.abs(r[0]-u)<N?e:a):e<=r[1]&&r[1]<=a:h>C^(u<=r[0]&&r[0]<=g))return D=nb(n,(-c+f)/q),gc(D,G),[r,hc(D)]}}function c(a,u){var n=q?e:C-e,d=0;return-n>a?d|=1:a>n&&(d|=2),-n>u?d|=4:u>n&&(d|=8),d}var d=Math.cos(e),q=0<d,f=Math.abs(d)>N,r=ic(e,6*J);return Ad(a,
function(e){var d,A,r,g,h;return{lineStart:function(){g=r=!1;h=1},point:function(m,l){var p,y=[m,l],I=a(m,l),M=q?I?0:c(m,l):I?c(m+(0>m?C:-C),l):0;if(!d&&(g=r=I)&&e.lineStart(),I!==r&&(p=n(d,y),(ob(d,p)||ob(y,p))&&(y[0]+=N,y[1]+=N,I=a(y[0],y[1]))),I!==r)h=0,I?(e.lineStart(),p=n(y,d),e.point(p[0],p[1])):(p=n(d,y),e.point(p[0],p[1]),e.lineEnd()),d=p;else if(f&&d&&q^I){var P;M&A||!(P=n(y,d,!0))||(h=0,q?(e.lineStart(),e.point(P[0][0],P[0][1]),e.point(P[1][0],P[1][1]),e.lineEnd()):(e.point(P[1][0],P[1][1]),
e.lineEnd(),e.lineStart(),e.point(P[0][0],P[0][1])))}!I||d&&ob(d,y)||e.point(y[0],y[1]);d=y;r=I;A=M},lineEnd:function(){r&&e.lineEnd();d=null},clean:function(){return h|(g&&r)<<1}}},r)}function Bf(e,a,n,c){function d(c,G){return Math.abs(c[0]-e)<N?0<G?0:3:Math.abs(c[0]-n)<N?0<G?2:1:Math.abs(c[1]-a)<N?0<G?1:0:0<G?3:2}function q(e,a){return f(e.point,a.point)}function f(e,a){var n=d(e,1),u=d(a,1);return n!==u?n-u:0===n?a[1]-e[1]:1===n?e[0]-a[0]:2===n?e[1]-a[1]:a[0]-e[0]}return function(r){function g(q){q=
d(q,-1);return h([0===q||3===q?e:n,1<q?c:a])}function h(e){for(var a=0,n=E.length,u=e[1],c=0;n>c;++c)for(var d=1,G=E[c],A=G.length,q=G[0];A>d;++d)b=G[d],q[1]<=u?b[1]>u&&0<(b[0]-q[0])*(e[1]-q[1])-(e[0]-q[0])*(b[1]-q[1])&&++a:b[1]<=u&&0>(b[0]-q[0])*(e[1]-q[1])-(e[0]-q[0])*(b[1]-q[1])&&--a,q=b;return 0!==a}function m(q,r,g,S){var h=0,l=0;if(null==q||(h=d(q,g))!==(l=d(r,g))||0>f(q,r)^0<g){do S.point(0===h||3===h?e:n,1<h?c:a);while((h=(h+g+4)%4)!==l)}else S.point(r[0],r[1])}function l(d,A){d>=e&&(n>=d&&
A>=a&&c>=A)&&r.point(d,A)}function F(d,A){d=Math.max(-pb,Math.min(pb,d));A=Math.max(-pb,Math.min(pb,A));var q=d>=e&&n>=d&&A>=a&&c>=A;if(E&&x.push([d,A]),da)B=d,y=A,I=q,da=!1,q&&(r.lineStart(),r.point(d,A));else if(q&&t)r.point(d,A);else{var f=[M,P],D=[d,A],g=D[0]-f[0],S=D[1]-f[1],h=[0,1];(Math.abs(g)<N&&Math.abs(S)<N?e<=f[0]&&f[0]<=n&&a<=f[1]&&f[1]<=c:qb(e-f[0],g,h)&&(qb(f[0]-n,-g,h)&&qb(a-f[1],S,h)&&qb(f[1]-c,-S,h))&&(1>h[1]&&(D[0]=f[0]+h[1]*g,D[1]=f[1]+h[1]*S),0<h[0]&&(f[0]+=h[0]*g,f[1]+=h[0]*S),
!0))?(t||(r.lineStart(),r.point(f[0],f[1])),r.point(D[0],D[1]),q||r.lineEnd()):(r.lineStart(),r.point(d,A))}M=d;P=A;t=q}var s,E,x,B,y,I,M,P,t,da,V=r,v=Cd(),qa={point:l,lineStart:function(){qa.point=F;E&&E.push(x=[]);da=!0;t=!1;M=P=0/0},lineEnd:function(){s&&(F(B,y),I&&t&&v.rejoin(),s.push(v.buffer()));qa.point=l;t&&r.lineEnd()},polygonStart:function(){r=v;s=[];E=[]},polygonEnd:function(){r=V;(s=p.merge(s)).length?(r.polygonStart(),yd(s,q,g,m,r),r.polygonEnd()):h([e,a])&&(r.polygonStart(),r.lineStart(),
m(null,null,1,r),r.lineEnd(),r.polygonEnd());s=E=x=null}};return qa}}function qb(e,a,n){if(Math.abs(a)<N)return 0>=e;e/=a;if(0<a){if(e>n[1])return!1;e>n[0]&&(n[0]=e)}else{if(e<n[0])return!1;e<n[1]&&(n[1]=e)}return!0}function Dd(e,a){function n(n,c){return n=e(n,c),a(n[0],n[1])}return e.invert&&a.invert&&(n.invert=function(n,c){return n=a.invert(n,c),n&&e.invert(n[0],n[1])}),n}function Ed(e){function a(u){function c(a,n){a=e(a,n);u.point(a[0],a[1])}function G(){l=0/0;s.point=f;u.lineStart()}function f(a,
c){var G=lb([a,c]),r=e(a,c);n(l,p,m,E,x,B,l=r[0],p=r[1],m=a,E=G[0],x=G[1],B=G[2],d,u);u.point(l,p)}function g(){s.point=c;u.lineEnd()}function h(){var e,a,c,D,va,t;G();s.point=function(n,u){f(e=n,u);a=l;c=p;D=E;va=x;t=B;s.point=f};s.lineEnd=function(){n(l,p,m,E,x,B,a,c,e,D,va,t,d,u);s.lineEnd=g;g()}}var m,l,p,E,x,B,s={point:c,lineStart:G,lineEnd:g,polygonStart:function(){u.polygonStart();s.lineStart=h},polygonEnd:function(){u.polygonEnd();s.lineStart=G}};return s}function n(a,u,d,A,f,g,h,m,l,p,s,
B,y,I){var M=h-a,P=m-u,t=M*M+P*P;if(t>4*c&&y--){var da=A+p,V=f+s,v=g+B,qa=Math.sqrt(da*da+V*V+v*v),z=Math.asin(v/=qa),w=Math.abs(Math.abs(v)-1)<N?(d+l)/2:Math.atan2(V,da),C=e(w,z),z=C[0],C=C[1],H=z-a,J=C-u,K=P*H-M*J;(K*K/t>c||0.3<Math.abs((M*H+P*J)/t-0.5))&&(n(a,u,d,A,f,g,z,C,w,da/=qa,V/=qa,v,y,I),I.point(z,C),n(z,C,w,da,V,v,h,m,l,p,s,B,y,I))}}var c=0.5,d=16;return a.precision=function(e){return arguments.length?(d=0<(c=e*e)&&16,a):Math.sqrt(c)},a}function za(e){return jc(function(){return e})()}
function jc(e){function a(e){return e=f(e[0]*J,e[1]*J),[e[0]*m+r,g-e[1]*m]}function n(e){return e=f.invert((e[0]-r)/m,(g-e[1])/m),e&&[e[0]*T,e[1]*T]}function c(){f=Dd(q=kc(x,B,y),d);var e=d(s,E);return r=l-e[0]*m,g=F+e[1]*m,a}var d,q,f,r,g,h=Ed(function(e,a){return e=d(e,a),[e[0]*m+r,g-e[1]*m]}),m=150,l=480,F=250,s=0,E=0,x=0,B=0,y=0,I=Fd,M=ia,P=null,t=null;return a.stream=function(e){return Cf(q,I(h(M(e))))},a.clipAngle=function(e){return arguments.length?(I=null==e?(P=e,Fd):Af((P=+e)*J),a):P},a.clipExtent=
function(e){return arguments.length?(t=e,M=null==e?ia:Bf(e[0][0],e[0][1],e[1][0],e[1][1]),a):t},a.scale=function(e){return arguments.length?(m=+e,c()):m},a.translate=function(e){return arguments.length?(l=+e[0],F=+e[1],c()):[l,F]},a.center=function(e){return arguments.length?(s=e[0]%360*J,E=e[1]%360*J,c()):[s*T,E*T]},a.rotate=function(e){return arguments.length?(x=e[0]%360*J,B=e[1]%360*J,y=2<e.length?e[2]%360*J:0,c()):[x*T,B*T,y*T]},p.rebind(a,h,"precision"),function(){return d=e.apply(this,arguments),
a.invert=d.invert&&n,c()}}function Cf(e,a){return{point:function(n,c){c=e(n*J,c*J);n=c[0];a.point(n>C?n-2*C:-C>n?n+2*C:n,c[1])},sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function Ua(e,a){return[e,a]}function kc(e,a,n){return e?a||n?Dd(Gd(e),Hd(a,n)):Gd(e):a||n?Hd(a,n):Ua}function Id(e){return function(a,n){return a+=e,[a>C?a-2*C:-C>a?a+2*C:a,n]}}function Gd(e){var a=
Id(e);return a.invert=Id(-e),a}function Hd(e,a){function n(e,a){var n=Math.cos(a),u=Math.cos(e)*n,n=Math.sin(e)*n,g=Math.sin(a),h=g*c+u*d;return[Math.atan2(n*q-h*f,u*c-g*d),Math.asin(Math.max(-1,Math.min(1,h*q+n*f)))]}var c=Math.cos(e),d=Math.sin(e),q=Math.cos(a),f=Math.sin(a);return n.invert=function(e,a){var n=Math.cos(a),u=Math.cos(e)*n,n=Math.sin(e)*n,g=Math.sin(a),h=g*q-n*f;return[Math.atan2(n*q+g*f,u*c+h*d),Math.asin(Math.max(-1,Math.min(1,h*c-u*d)))]},n}function ic(e,a){var n=Math.cos(e),c=
Math.sin(e);return function(d,q,f,r){null!=d?(d=Jd(n,d),q=Jd(n,q),(0<f?q>d:d>q)&&(d+=2*f*C)):(d=e+2*f*C,q=e);for(var g,h=f*a;0<f?d>q:q>d;d-=h)r.point((g=hc([n,-c*Math.cos(d),-c*Math.sin(d)]))[0],g[1])}}function Jd(e,a){var n=lb(a);n[0]-=e;var c=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=c;n[1]/=c;n[2]/=c;c=Math.acos(Math.max(-1,Math.min(1,-n[1])));return((0>-n[2]?-c:c)+2*Math.PI-N)%(2*Math.PI)}function Kd(e,a,n){var c=p.range(e,a-N,n).concat(a);return function(e){return c.map(function(a){return[e,
a]})}}function Ld(e,a,n){var c=p.range(e,a-N,n).concat(a);return function(e){return c.map(function(a){return[a,e]})}}function lc(e){return e.source}function mc(e){return e.target}function Df(e,a,n,c){var d=Math.cos(a),q=Math.sin(a),f=Math.cos(c),r=Math.sin(c),g=d*Math.cos(e),h=d*Math.sin(e),m=f*Math.cos(n),l=f*Math.sin(n),p=2*Math.asin(Math.sqrt(jd(c-a)+d*f*jd(n-e))),s=1/Math.sin(p);n=p?function(e){var a=Math.sin(e*=p)*s,n=Math.sin(p-e)*s;e=n*g+a*m;var u=n*h+a*l,a=n*q+a*r;return[Math.atan2(u,e)*T,
Math.atan2(a,Math.sqrt(e*e+u*u))*T]}:function(){return[e*T,a*T]};return n.distance=p,n}function nc(e){var a=0,n=C/3,c=jc(e);e=c(a,n);return e.parallels=function(e){return arguments.length?c(a=e[0]*C/180,n=e[1]*C/180):[180*(a/C),180*(n/C)]},e}function Md(e,a){function n(e,a){var n=Math.sqrt(q-2*d*Math.sin(a))/d;return[n*Math.sin(e*=d),f-n*Math.cos(e)]}var c=Math.sin(e),d=(c+Math.sin(a))/2,q=1+c*(2*d-c),f=Math.sqrt(q)/d;return n.invert=function(e,a){var n=f-a;return[Math.atan2(e,n)/d,Math.asin((q-(e*
e+n*n)*d*d)/(2*d))]},n}function oc(e,a){var n=e(a[0]),c=e([0.5*(a[0][0]+a[1][0]),a[0][1]]),d=e([a[1][0],a[0][1]]),q=e(a[1]),f=(c[1]-n[1])/(c[0]-n[0]),r=(d[1]-c[1])/(d[0]-c[0]),g=0.5*(f*r*(n[1]-d[1])+r*(n[0]+c[0])-f*(c[0]+d[0]))/(r-f),h=(0.5*(n[0]+c[0])-g)/f+0.5*(n[1]+c[1]),c=q[0]-g,q=q[1]-h,d=n[0]-g,n=n[1]-h,m=c*c+q*q,l=d*d+n*n,p=Math.atan2(q,c),s=Math.atan2(n,d);return function(a){var n=a[0]-g,c=a[1]-h,u=n*n+c*c,n=Math.atan2(c,n);return u>m&&l>u&&n>p&&s>n?e.invert(a):void 0}}function Ef(){function e(e,
a){rb+=d*e-c*a;c=e;d=a}var a,n,c,d;Aa.point=function(q,f){Aa.point=e;a=c=q;n=d=f};Aa.lineEnd=function(){e(a,n)}}function Ff(){function e(e,a){f.push("M",e,",",a,q)}function a(e,c){f.push("M",e,",",c);r.point=n}function n(e,a){f.push("L",e,",",a)}function c(){r.point=e}function d(){f.push("Z")}var q=Nd(4.5),f=[],r={point:e,lineStart:function(){r.point=a},lineEnd:c,polygonStart:function(){r.lineEnd=d},polygonEnd:function(){r.lineEnd=c;r.point=e},pointRadius:function(e){return q=Nd(e),r},result:function(){if(f.length){var e=
f.join("");return f=[],e}}};return r}function pc(e,a){ba||(X+=e,Y+=a,++W)}function Od(){function e(e,c){var d=e-a,f=c-n,d=Math.sqrt(d*d+f*f);X+=d*(a+e)/2;Y+=d*(n+c)/2;W+=d;a=e;n=c}var a,n;if(1!==ba){if(!(1>ba))return;ba=1;X=Y=W=0}ma.point=function(c,d){ma.point=e;a=c;n=d}}function Pd(){ma.point=pc}function Gf(){function e(e,a){var n=d*e-c*a;X+=n*(c+e);Y+=n*(d+a);W+=3*n;c=e;d=a}var a,n,c,d;2>ba&&(ba=2,X=Y=W=0);ma.point=function(q,f){ma.point=e;a=c=q;n=d=f};ma.lineEnd=function(){e(a,n)}}function Hf(e){function a(n,
c){e.moveTo(n,c);e.arc(n,c,f,0,2*C)}function n(a,n){e.moveTo(a,n);r.point=c}function c(a,n){e.lineTo(a,n)}function d(){r.point=a}function q(){e.closePath()}var f=4.5,r={point:a,lineStart:function(){r.point=n},lineEnd:d,polygonStart:function(){r.lineEnd=q},polygonEnd:function(){r.lineEnd=d;r.point=a},pointRadius:function(e){return f=e,r},result:Z};return r}function Nd(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function If(e){var a=Ed(function(a,c){return e([a*T,c*
T])});return function(e){return e=a(e),{point:function(a,c){e.point(a*J,c*J)},sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}}function Va(e,a){function n(a,n){var c=Math.cos(a),u=Math.cos(n),c=e(c*u);return[c*u*Math.sin(a),c*Math.sin(n)]}return n.invert=function(e,n){var c=Math.sqrt(e*e+n*n),d=a(c),f=Math.sin(d),d=Math.cos(d);return[Math.atan2(e*f,c*d),Math.asin(c&&n*
f/c)]},n}function Qd(e,a){function n(e,a){var n=Math.abs(Math.abs(a)-C/2)<N?0:q/Math.pow(Math.tan(C/4+a/2),d);return[n*Math.sin(d*e),q-n*Math.cos(d*e)]}var c=Math.cos(e),d=e===a?Math.sin(e):Math.log(c/Math.cos(a))/Math.log(Math.tan(C/4+a/2)/Math.tan(C/4+e/2)),q=c*Math.pow(Math.tan(C/4+e/2),d)/d;return d?(n.invert=function(e,a){var n=q-a,c=(0<d?1:0>d?-1:0)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/d,2*Math.atan(Math.pow(q/c,1/d))-C/2]},n):sb}function Rd(e,a){function n(e,a){var n=q-a;return[n*Math.sin(d*
e),q-n*Math.cos(d*e)]}var c=Math.cos(e),d=e===a?Math.sin(e):(c-Math.cos(a))/(a-e),q=c/d+e;return Math.abs(d)<N?Ua:(n.invert=function(e,a){var n=q-a;return[Math.atan2(e,n)/d,q-(0<d?1:0>d?-1:0)*Math.sqrt(e*e+n*n)]},n)}function sb(e,a){return[e,Math.log(Math.tan(C/4+a/2))]}function Sd(e){var a,n=za(e),c=n.scale,d=n.translate,q=n.clipExtent;return n.scale=function(){var e=c.apply(n,arguments);return e===n?a?n.clipExtent(null):n:e},n.translate=function(){var e=d.apply(n,arguments);return e===n?a?n.clipExtent(null):
n:e},n.clipExtent=function(e){var f=q.apply(n,arguments);if(f===n){if(a=null==e){var g=C*c(),h=d();q([[h[0]-g,h[1]-g],[h[0]+g,h[1]+g]])}}else a&&(f=null);return f},n.clipExtent(null)}function qc(e,a){var n=Math.cos(a)*Math.sin(e);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(a),Math.cos(e))]}function Td(e){function a(u){function f(){D.push("M",q(e(h),r))}for(var g,D=[],h=[],m=-1,l=u.length,p=O(n),s=O(c);++m<l;)d.call(this,g=u[m],m)?h.push([+p.call(this,g,m),+s.call(this,g,m)]):h.length&&(f(),
h=[]);return h.length&&f(),D.length?D.join(""):null}var n=na,c=ra,d=Ta,q=ja,f=q.key,r=0.7;return a.x=function(e){return arguments.length?(n=e,a):n},a.y=function(e){return arguments.length?(c=e,a):c},a.defined=function(e){return arguments.length?(d=e,a):d},a.interpolate=function(e){return arguments.length?(f="function"==typeof e?q=e:(q=rc.get(e)||ja).key,a):f},a.tension=function(e){return arguments.length?(r=e,a):r},a}function na(e){return e[0]}function ra(e){return e[1]}function ja(e){return e.join("L")}
function sc(e){for(var a=0,n=e.length,c=e[0],d=[c[0],",",c[1]];++a<n;)d.push("V",(c=e[a])[1],"H",c[0]);return d.join("")}function tc(e){for(var a=0,n=e.length,c=e[0],d=[c[0],",",c[1]];++a<n;)d.push("H",(c=e[a])[0],"V",c[1]);return d.join("")}function tb(e,a){if(1>a.length||e.length!=a.length&&e.length!=a.length+2)return ja(e);var n=e.length!=a.length,c="",d=e[0],q=e[1],f=a[0],r=f,g=1;if(n&&(c+="Q"+(q[0]-2*f[0]/3)+","+(q[1]-2*f[1]/3)+","+q[0]+","+q[1],d=e[1],g=2),1<a.length)for(r=a[1],q=e[g],g++,c+=
"C"+(d[0]+f[0])+","+(d[1]+f[1])+","+(q[0]-r[0])+","+(q[1]-r[1])+","+q[0]+","+q[1],d=2;d<a.length;d++,g++)q=e[g],r=a[d],c+="S"+(q[0]-r[0])+","+(q[1]-r[1])+","+q[0]+","+q[1];n&&(n=e[g],c+="Q"+(q[0]+2*r[0]/3)+","+(q[1]+2*r[1]/3)+","+n[0]+","+n[1]);return c}function uc(e,a){for(var n,c=[],d=(1-a)/2,q=e[0],f=e[1],r=1,g=e.length;++r<g;)n=q,q=f,f=e[r],c.push([d*(f[0]-n[0]),d*(f[1]-n[1])]);return c}function Ud(e){if(3>e.length)return ja(e);var a=1,n=e.length,c=e[0],d=c[0],q=c[1],f=[d,d,d,(c=e[1])[0]],r=[q,
q,q,c[1]],d=[d,",",q];for(Wa(d,f,r);++a<n;)c=e[a],f.shift(),f.push(c[0]),r.shift(),r.push(c[1]),Wa(d,f,r);for(a=-1;2>++a;)f.shift(),f.push(c[0]),r.shift(),r.push(c[1]),Wa(d,f,r);return d.join("")}function oa(e,a){return e[0]*a[0]+e[1]*a[1]+e[2]*a[2]+e[3]*a[3]}function Wa(e,a,n){e.push("C",oa(Vd,a),",",oa(Vd,n),",",oa(Wd,a),",",oa(Wd,n),",",oa(Oa,a),",",oa(Oa,n))}function vc(e,a){return(a[1]-e[1])/(a[0]-e[0])}function Jf(e,a,n,c){var d,q,f,r,g,h,m;return d=c[e],q=d[0],f=d[1],d=c[a],r=d[0],g=d[1],d=
c[n],h=d[0],m=d[1],0<(m-f)*(r-q)-(g-f)*(h-q)}function wc(e,a,n){return(n[0]-a[0])*(e[1]-a[1])<(n[1]-a[1])*(e[0]-a[0])}function Xd(e,a,n,c){var d=e[0],q=n[0],f=a[0]-d,r=c[0]-q;e=e[1];n=n[1];a=a[1]-e;c=c[1]-n;q=(r*(e-n)-c*(d-q))/(c*f-r*a);return[d+q*f,e+q*a]}function xc(e,a){var n=e.map(function(e,a){return{index:a,x:e[0],y:e[1]}}).sort(function(e,a){return e.y<a.y?-1:e.y>a.y?1:e.x<a.x?-1:e.x>a.x?1:0}),c=null,d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l");
d.rightEnd=d.createHalfEdge(null,"l");d.leftEnd.r=d.rightEnd;d.rightEnd.l=d.leftEnd;d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(e,a){return{edge:e,side:a,vertex:null,l:null,r:null}},insert:function(e,a){a.l=e;a.r=e.r;e.r.l=a;e.r=a},leftBound:function(e){var a=d.leftEnd;do a=a.r;while(a!=d.rightEnd&&q.rightOf(a,e));return a.l},del:function(e){e.l.r=e.r;e.r.l=e.l;e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return null==e.edge?c:e.edge.region[e.side]},
rightRegion:function(e){return null==e.edge?c:e.edge.region[yc[e.side]]}},q={bisect:function(e,a){var c={region:{l:e,r:a},ep:{l:null,r:null}},n=a.x-e.x,d=a.y-e.y;return c.c=e.x*n+e.y*d+0.5*(n*n+d*d),(0<n?n:-n)>(0<d?d:-d)?(c.a=1,c.b=d/n,c.c/=n):(c.b=1,c.a=n/d,c.c/=d),c},intersect:function(e,a){var c=e.edge,n=a.edge;if(!c||!n||c.region.r==n.region.r)return null;var d=c.a*n.b-c.b*n.a;if(1E-10>Math.abs(d))return null;var u,q,f=(c.c*n.b-n.c*c.b)/d,d=(n.c*c.a-c.c*n.a)/d,G=c.region.r,r=n.region.r;G.y<r.y||
G.y==r.y&&G.x<r.x?(u=e,q=c):(u=a,q=n);return(c=f>=q.region.r.x)&&"l"===u.side||!c&&"r"===u.side?null:{x:f,y:d}},rightOf:function(e,a){var c=e.edge,n=c.region.r,d=a.x>n.x;if(d&&"l"===e.side)return 1;if(!d&&"r"===e.side)return 0;if(1===c.a){var u=a.y-n.y,q=a.x-n.x,f=0,G=0;(!d&&0>c.b||d&&0<=c.b?G=f=u>=c.b*q:(G=a.x+a.y*c.b>c.c,0>c.b&&(G=!G),G||(f=1)),f)||(n=n.x-c.region.l.x,G=c.b*(q*q-u*u)<n*u*(1+2*q/n+c.b*c.b),0>c.b&&(G=!G))}else q=c.c-c.a*a.x,c=a.y-q,u=a.x-n.x,n=q-n.y,G=c*c>u*u+n*n;return"l"===e.side?
G:!G},endPoint:function(e,c,n){e.ep[c]=n;e.ep[yc[c]]&&a(e)},distance:function(e,a){var c=e.x-a.x,n=e.y-a.y;return Math.sqrt(c*c+n*n)}},f={list:[],insert:function(e,a,c){e.vertex=a;e.ystar=a.y+c;c=0;for(var n=f.list,d=n.length;d>c;c++){var u=n[c];if(!(e.ystar>u.ystar||e.ystar==u.ystar&&a.x>u.vertex.x))break}n.splice(c,0,e)},del:function(e){for(var a=0,c=f.list,n=c.length;n>a&&c[a]!=e;++a);c.splice(a,1)},empty:function(){return 0===f.list.length},nextEvent:function(e){for(var a=0,c=f.list,n=c.length;n>
a;++a)if(c[a]==e)return c[a+1];return null},min:function(){var e=f.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return f.list.shift()}};d.init();for(var c=n.shift(),r,g,h,m,l,p,s,E,x,B,y=n.shift();;)if(f.empty()||(r=f.min()),y&&(f.empty()||y.y<r.y||y.y==r.y&&y.x<r.x))g=d.leftBound(y),h=d.right(g),s=d.rightRegion(g),B=q.bisect(s,y),p=d.createHalfEdge(B,"l"),d.insert(g,p),(x=q.intersect(g,p))&&(f.del(g),f.insert(g,x,q.distance(x,y))),g=p,p=d.createHalfEdge(B,"r"),d.insert(g,p),(x=q.intersect(p,
h))&&f.insert(p,x,q.distance(x,y)),y=n.shift();else{if(f.empty())break;g=f.extractMin();m=d.left(g);h=d.right(g);l=d.right(h);s=d.leftRegion(g);p=d.rightRegion(h);x=g.vertex;q.endPoint(g.edge,g.side,x);q.endPoint(h.edge,h.side,x);d.del(g);f.del(h);d.del(h);g="l";s.y>p.y&&(E=s,s=p,p=E,g="r");B=q.bisect(s,p);p=d.createHalfEdge(B,g);d.insert(m,p);q.endPoint(B,yc[g],x);(x=q.intersect(m,p))&&(f.del(m),f.insert(m,x,q.distance(x,s)));(x=q.intersect(p,l))&&f.insert(p,x,q.distance(x,s))}for(g=d.right(d.leftEnd);g!=
d.rightEnd;g=d.right(g))a(g.edge)}function Kf(e){return e.x}function Lf(e){return e.y}function Yd(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Xa(e,a,c,d,f,q){if(!e(a,c,d,f,q)){var g=0.5*(c+f),r=0.5*(d+q);a=a.nodes;a[0]&&Xa(e,a[0],c,d,g,r);a[1]&&Xa(e,a[1],g,d,f,r);a[2]&&Xa(e,a[2],c,r,g,q);a[3]&&Xa(e,a[3],g,r,f,q)}}function zc(e,a){e=p.rgb(e);a=p.rgb(a);var c=e.r,d=e.g,f=e.b,q=a.r-c,g=a.g-d,r=a.b-f;return function(e){return"#"+Ma(Math.round(c+q*e))+Ma(Math.round(d+g*e))+Ma(Math.round(f+
r*e))}}function Zd(e){var a=[e.a,e.b],c=[e.c,e.d],d=$d(a),f=a[0]*c[0]+a[1]*c[1],q=$d((c[0]+=-f*a[0],c[1]+=-f*a[1],c))||0;a[0]*c[1]<c[0]*a[1]&&(a[0]*=-1,a[1]*=-1,d*=-1,f*=-1);this.rotate=(d?Math.atan2(a[1],a[0]):Math.atan2(-c[0],c[1]))*T;this.translate=[e.e,e.f];this.scale=[d,q];this.skew=q?Math.atan2(f,q)*T:0}function $d(e){var a=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return a&&(e[0]/=a,e[1]/=a),a}function sa(e,a){return a-=e=+e,function(c){return e+a*c}}function ub(e,a){var c,d=[],f=[],q=p.transform(e),
g=p.transform(a),r=q.translate,h=g.translate,m=q.rotate,l=g.rotate,s=q.skew,F=g.skew,q=q.scale,g=g.scale;return r[0]!=h[0]||r[1]!=h[1]?(d.push("translate(",null,",",null,")"),f.push({i:1,x:sa(r[0],h[0])},{i:3,x:sa(r[1],h[1])})):h[0]||h[1]?d.push("translate("+h+")"):d.push(""),m!=l?(180<m-l?l+=360:180<l-m&&(m+=360),f.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:sa(m,l)})):l&&d.push(d.pop()+"rotate("+l+")"),s!=F?f.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:sa(s,F)}):F&&d.push(d.pop()+"skewX("+
F+")"),q[0]!=g[0]||q[1]!=g[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),f.push({i:c-4,x:sa(q[0],g[0])},{i:c-2,x:sa(q[1],g[1])})):(1!=g[0]||1!=g[1])&&d.push(d.pop()+"scale("+g+")"),c=f.length,function(e){for(var a,u=-1;++u<c;)d[(a=f[u]).i]=a.x(e);return d.join("")}}function ae(e,a){var c,d={},f={};for(c in e)c in a?d[c]=("transform"==c?ub:Da)(e[c],a[c]):f[c]=e[c];for(c in a)c in e||(f[c]=a[c]);return function(e){for(c in d)f[c]=d[c](e);return f}}function be(e,a){var c,d,f,q,g=0,r=[],h=[];e+="";
a+="";for(d=vb.lastIndex=0;c=vb.exec(a);++d)c.index&&r.push(a.substring(g,c.index)),h.push({i:r.length,x:c[0]}),r.push(null),g=vb.lastIndex;g<a.length&&r.push(a.substring(g));d=0;for(f=h.length;(c=vb.exec(e))&&f>d;++d)if(q=h[d],q.x==c[0]){if(q.i)if(null==r[q.i+1])for(r[q.i-1]+=q.x,r.splice(q.i,1),c=d+1;f>c;++c)h[c].i--;else for(r[q.i-1]+=q.x+r[q.i+1],r.splice(q.i,2),c=d+1;f>c;++c)h[c].i-=2;else if(null==r[q.i+1])r[q.i]=q.x;else for(r[q.i]=q.x+r[q.i+1],r.splice(q.i+1,1),c=d+1;f>c;++c)h[c].i--;h.splice(d,
1);f--;d--}else q.x=sa(parseFloat(c[0]),parseFloat(q.x));for(;f>d;)q=h.pop(),null==r[q.i+1]?r[q.i]=q.x:(r[q.i]=q.x+r[q.i+1],r.splice(q.i+1,1)),f--;return 1===r.length?null==r[0]?h[0].x:function(){return a}:function(e){for(d=0;f>d;++d)r[(q=h[d]).i]=q.x(e);return r.join("")}}function Da(e,a){for(var c,d=p.interpolators.length;0<=--d&&!(c=p.interpolators[d](e,a)););return c}function ce(e,a){var c,d=[],f=[],q=e.length,g=a.length,r=Math.min(e.length,a.length);for(c=0;r>c;++c)d.push(Da(e[c],a[c]));for(;q>
c;++c)f[c]=e[c];for(;g>c;++c)f[c]=a[c];return function(e){for(c=0;r>c;++c)f[c]=d[c](e);return f}}function Mf(e){return function(a){return 0>=a?0:1<=a?1:e(a)}}function de(e){return function(a){return 1-e(1-a)}}function ee(e){return function(a){return 0.5*(0.5>a?e(2*a):2-e(2-2*a))}}function Nf(e){return e*e}function Of(e){return e*e*e}function Pf(e){return 1-Math.cos(e*C/2)}function Qf(e){return Math.pow(2,10*(e-1))}function Rf(e){return 1-Math.sqrt(1-e*e)}function Sf(e){return 1/2.75>e?7.5625*e*e:
2/2.75>e?7.5625*(e-=1.5/2.75)*e+0.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375}function fe(e,a){return a-=e,function(c){return Math.round(e+a*c)}}function Tf(e,a){return a=a-(e=+e)?1/(a-e):0,function(c){return(c-e)*a}}function Uf(e,a){return a=a-(e=+e)?1/(a-e):0,function(c){return Math.max(0,Math.min(1,(c-e)*a))}}function Vf(e){var a=e.source;e=e.target;var c;var d=e;if(a===d)c=a;else{c=ge(a);for(var d=ge(d),f=c.pop(),q=d.pop(),g=null;f===q;)g=f,f=c.pop(),q=d.pop();
c=g}for(d=[a];a!==c;)a=a.parent,d.push(a);for(a=d.length;e!==c;)d.splice(a,0,e),e=e.parent;return d}function ge(e){for(var a=[],c=e.parent;null!=c;)a.push(e),e=c,c=c.parent;return a.push(e),a}function Wf(e){e.fixed|=2}function Xf(e){e.fixed&=-7}function Yf(e){e.fixed|=4;e.px=e.x;e.py=e.y}function Zf(e){e.fixed&=-5}function he(e,a,c){var d=0,f=0;if(e.charge=0,!e.leaf)for(var q,g=e.nodes,r=g.length,h=-1;++h<r;)q=g[h],null!=q&&(he(q,a,c),e.charge+=q.charge,d+=q.charge*q.cx,f+=q.charge*q.cy);e.point&&
(e.leaf||(e.point.x+=Math.random()-0.5,e.point.y+=Math.random()-0.5),a*=c[e.point.index],e.charge+=e.pointCharge=a,d+=a*e.point.x,f+=a*e.point.y);e.cx=d/e.charge;e.cy=f/e.charge}function Ya(e,a){return p.rebind(e,a,"sort","children","value"),e.nodes=e,e.links=$f,e}function ag(e){return e.children}function bg(e){return e.value}function cg(e,a){return a.value-e.value}function $f(e){return p.merge(e.map(function(e){return(e.children||[]).map(function(a){return{source:e,target:a}})}))}function dg(e){return e.x}
function eg(e){return e.y}function fg(e,a,c){e.y0=a;e.y=c}function Ac(e){return p.range(e.length)}function Bc(e){var a=-1;e=e[0].length;for(var c=[];++a<e;)c[a]=0;return c}function gg(e){for(var a,c=1,d=0,f=e[0][1],q=e.length;q>c;++c)(a=e[c][1])>f&&(d=c,f=a);return d}function hg(e){return e.reduce(ig,0)}function ig(e,a){return e+a[1]}function jg(e,a){return ie(e,Math.ceil(Math.log(a.length)/Math.LN2+1))}function ie(e,a){for(var c=-1,d=+e[0],f=(e[1]-d)/a,q=[];++c<=a;)q[c]=f*c+d;return q}function kg(e){return[p.min(e),
p.max(e)]}function je(e,a){return e.parent==a.parent?1:2}function Cc(e){var a=e.children;return a&&a.length?a[0]:e._tree.thread}function Dc(e){var a,c=e.children;return c&&(a=c.length)?c[a-1]:e._tree.thread}function wb(e,a){var c=e.children;if(c&&(f=c.length))for(var d,f,q=-1;++q<f;)0<a(d=wb(c[q],a),e)&&(e=d);return e}function lg(e,a){return e.x-a.x}function mg(e,a){return a.x-e.x}function ng(e,a){return e.depth-a.depth}function ta(e,a){function c(e,d){var f=e.children;if(f&&(r=f.length))for(var g,
r,h=null,m=-1;++m<r;)g=f[m],c(g,h),h=g;a(e,d)}c(e,null)}function og(e,a){return e.value-a.value}function Ec(e,a){var c=e._pack_next;e._pack_next=a;a._pack_prev=e;a._pack_next=c;c._pack_prev=a}function ke(e,a){e._pack_next=a;a._pack_prev=e}function le(e,a){var c=a.x-e.x,d=a.y-e.y,f=e.r+a.r;return 0.001<f*f-c*c-d*d}function me(e){function a(e){l=Math.min(e.x-e.r,l);p=Math.max(e.x+e.r,p);F=Math.min(e.y-e.r,F);s=Math.max(e.y+e.r,s)}if((c=e.children)&&(m=c.length)){var c,d,f,q,g,r,h,m,l=1/0,p=-1/0,F=1/
0,s=-1/0;if(c.forEach(pg),d=c[0],d.x=-d.r,d.y=0,a(d),1<m&&(f=c[1],f.x=f.r,f.y=0,a(f),2<m))for(q=c[2],ne(d,f,q),a(q),Ec(d,q),d._pack_prev=q,Ec(q,f),f=d._pack_next,g=3;m>g;g++){ne(d,f,q=c[g]);var E=0,x=1,B=1;for(r=f._pack_next;r!==f;r=r._pack_next,x++)if(le(r,q)){E=1;break}if(1==E)for(h=d._pack_prev;h!==r._pack_prev&&!le(h,q);h=h._pack_prev,B++);E?(B>x||x==B&&f.r<d.r?ke(d,f=r):ke(d=h,f),g--):(Ec(d,q),f=q,a(q))}d=(l+p)/2;f=(F+s)/2;for(g=r=0;m>g;g++)q=c[g],q.x-=d,q.y-=f,r=Math.max(r,q.r+Math.sqrt(q.x*
q.x+q.y*q.y));e.r=r;c.forEach(qg)}}function pg(e){e._pack_next=e._pack_prev=e}function qg(e){delete e._pack_next;delete e._pack_prev}function oe(e,a,c,d){var f=e.children;if(e.x=a+=d*e.x,e.y=c+=d*e.y,e.r*=d,f){e=-1;for(var q=f.length;++e<q;)oe(f[e],a,c,d)}}function ne(e,a,c){var d=e.r+c.r,f=a.x-e.x,q=a.y-e.y;if(d&&(f||q)){var g=a.r+c.r,r=f*f+q*q,g=g*g,d=d*d;a=0.5+(d-g)/(2*r);g=Math.sqrt(Math.max(0,2*g*(d+r)-(d-=r)*d-g*g))/(2*r);c.x=e.x+a*f+g*q;c.y=e.y+a*q-g*f}else c.x=e.x+d,c.y=e.y}function rg(e){return 1+
p.max(e,function(e){return e.y})}function sg(e){return e.reduce(function(e,a){return e+a.x},0)/e.length}function pe(e){var a=e.children;return a&&a.length?pe(a[0]):e}function qe(e){var a,c=e.children;return c&&(a=c.length)?qe(c[a-1]):e}function Fc(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function re(e,a){var c=e.x+a[3],d=e.y+a[0],f=e.dx-a[1]-a[3],q=e.dy-a[0]-a[2];return 0>f&&(c+=f/2,f=0),0>q&&(d+=q/2,q=0),{x:c,y:d,dx:f,dy:q}}function Za(e){var a=e[0];e=e[e.length-1];return e>a?[a,e]:[e,a]}function xb(e){return e.rangeExtent?
e.rangeExtent():Za(e.range())}function tg(e,a,c,d){var f=c(e[0],e[1]),q=d(a[0],a[1]);return function(e){return q(f(e))}}function yb(e,a){var c,d=0,f=e.length-1,q=e[d],g=e[f];return q>g&&(c=d,d=f,f=c,c=q,q=g,g=c),(a=a(g-q))&&(e[d]=a.floor(q),e[f]=a.ceil(g)),e}function ug(e,a,c,d){var f=[],q=[],g=0,r=Math.min(e.length,a.length)-1;for(e[r]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++g<=r;)f.push(c(e[g-1],e[g])),q.push(d(a[g-1],a[g]));return function(a){var c=p.bisect(e,a,1,r)-1;return q[c](f[c](a))}}
function se(e,a,c,d){function f(){var h=2<Math.min(e.length,a.length)?ug:tg,A=d?Uf:Tf;return g=h(e,a,A,c),r=h(a,e,A,Da),q}function q(e){return g(e)}var g,r;return q.invert=function(e){return r(e)},q.domain=function(a){return arguments.length?(e=a.map(Number),f()):e},q.range=function(e){return arguments.length?(a=e,f()):a},q.rangeRound=function(e){return q.range(e).interpolate(fe)},q.clamp=function(e){return arguments.length?(d=e,f()):d},q.interpolate=function(e){return arguments.length?(c=e,f()):
c},q.ticks=function(a){return Gc(e,a)},q.tickFormat=function(a,c){return Hc(e,a,c)},q.nice=function(){return yb(e,te),f()},q.copy=function(){return se(e,a,c,d)},f()}function ue(e,a){return p.rebind(e,a,"range","rangeRound","interpolate","clamp")}function te(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(a){return Math.floor(a/e)*e},ceil:function(a){return Math.ceil(a/e)*e}}}function ve(e,a){var c=Za(e),d=c[1]-c[0],f=Math.pow(10,Math.floor(Math.log(d/a)/Math.LN10)),
d=a/d*f;return 0.15>=d?f*=10:0.35>=d?f*=5:0.75>=d&&(f*=2),c[0]=Math.ceil(c[0]/f)*f,c[1]=Math.floor(c[1]/f)*f+0.5*f,c[2]=f,c}function Gc(e,a){return p.range.apply(p,ve(e,a))}function Hc(e,a,c){var d=-Math.floor(Math.log(ve(e,a)[2])/Math.LN10+0.01);return p.format(c?c.replace(we,function(e,a,c,n,u,f,g,h,m,l){return[a,c,n,u,f,g,h,m||"."+(d-2*("%"===l)),l].join("")}):",."+d+"f")}function xe(e,a,c,d){function f(a){return e(c(a))}return f.invert=function(a){return d(e.invert(a))},f.domain=function(a){return arguments.length?
(0>a[0]?(c=Ic,d=vg):(c=ye,d=ze),e.domain(a.map(c)),f):e.domain().map(d)},f.base=function(e){return arguments.length?(a=+e,f):a},f.nice=function(){return e.domain(yb(e.domain(),wg(a))),f},f.ticks=function(){var f=Za(e.domain()),g=[];if(f.every(isFinite)){var r=Math.log(a),h=Math.floor(f[0]/r),r=Math.ceil(f[1]/r),A=d(f[0]),f=d(f[1]),m=a%1?2:a;if(c===Ic)for(g.push(-Math.pow(a,-h));h++<r;)for(var l=m-1;0<l;l--)g.push(-Math.pow(a,-h)*l);else{for(;r>h;h++)for(l=1;m>l;l++)g.push(Math.pow(a,h)*l);g.push(Math.pow(a,
h))}for(h=0;g[h]<A;h++);for(r=g.length;g[r-1]>f;r--);g=g.slice(h,r)}return g},f.tickFormat=function(e,g){if(2>arguments.length&&(g=xg),!arguments.length)return g;var r,h=Math.log(a),m=Math.max(0.1,e/f.ticks().length),l=c===Ic?(r=-1E-12,Math.floor):(r=1E-12,Math.ceil);return function(e){return e/d(h*l(c(e)/h+r))<=m?g(e):""}},f.copy=function(){return xe(e.copy(),a,c,d)},ue(f,e)}function ye(e){return Math.log(0>e?0:e)}function ze(e){return Math.exp(e)}function Ic(e){return-Math.log(0<e?0:-e)}function vg(e){return-Math.exp(-e)}
function wg(e){e=Math.log(e);var a={floor:function(a){return Math.floor(a/e)*e},ceil:function(a){return Math.ceil(a/e)*e}};return function(){return a}}function Ae(e,a){function c(a){return e(d(a))}var d=zb(a),f=zb(1/a);return c.invert=function(a){return f(e.invert(a))},c.domain=function(a){return arguments.length?(e.domain(a.map(d)),c):e.domain().map(f)},c.ticks=function(e){return Gc(c.domain(),e)},c.tickFormat=function(e,a){return Hc(c.domain(),e,a)},c.nice=function(){return c.domain(yb(c.domain(),
te))},c.exponent=function(e){if(!arguments.length)return a;var g=c.domain();return d=zb(a=e),f=zb(1/a),c.domain(g)},c.copy=function(){return Ae(e.copy(),a)},ue(c,e)}function zb(e){return function(a){return 0>a?-Math.pow(-a,e):Math.pow(a,e)}}function Be(e,c){function d(a){return q[((g.get(a)||g.set(a,e.push(a)))-1)%q.length]}function f(a,c){return p.range(e.length).map(function(e){return a+c*e})}var g,q,h;return d.domain=function(f){if(!arguments.length)return e;e=[];g=new a;for(var q,h=-1,G=f.length;++h<
G;)g.has(q=f[h])||g.set(q,e.push(q));return d[c.t].apply(d,c.a)},d.range=function(e){return arguments.length?(q=e,h=0,c={t:"range",a:arguments},d):q},d.rangePoints=function(a,g){2>arguments.length&&(g=0);var A=a[0],m=a[1],l=(m-A)/(Math.max(1,e.length-1)+g);return q=f(2>e.length?(A+m)/2:A+l*g/2,l),h=0,c={t:"rangePoints",a:arguments},d},d.rangeBands=function(a,g,A){2>arguments.length&&(g=0);3>arguments.length&&(A=g);var m=a[1]<a[0],l=a[m-0],p=(a[1-m]-l)/(e.length-g+2*A);return q=f(l+p*A,p),m&&q.reverse(),
h=p*(1-g),c={t:"rangeBands",a:arguments},d},d.rangeRoundBands=function(a,g,A){2>arguments.length&&(g=0);3>arguments.length&&(A=g);var m=a[1]<a[0],l=a[m-0],p=a[1-m],s=Math.floor((p-l)/(e.length-g+2*A));return q=f(l+Math.round((p-l-(e.length-g)*s)/2),s),m&&q.reverse(),h=Math.round(s*(1-g)),c={t:"rangeRoundBands",a:arguments},d},d.rangeBand=function(){return h},d.rangeExtent=function(){return Za(c.a[0])},d.copy=function(){return Be(e,c)},d.domain(e)}function Ce(e,a){function c(){var n=0,g=a.length;for(f=
[];++n<g;)f[n-1]=p.quantile(e,n/g);return d}function d(e){return isNaN(e=+e)?0/0:a[p.bisect(f,e)]}var f;return d.domain=function(a){return arguments.length?(e=a.filter(function(e){return!isNaN(e)}).sort(p.ascending),c()):e},d.range=function(e){return arguments.length?(a=e,c()):a},d.quantiles=function(){return f},d.copy=function(){return Ce(e,a)},c()}function De(e,a,c){function d(a){return c[Math.max(0,Math.min(g,Math.floor(q*(a-e))))]}function f(){return q=c.length/(a-e),g=c.length-1,d}var q,g;return d.domain=
function(c){return arguments.length?(e=+c[0],a=+c[c.length-1],f()):[e,a]},d.range=function(e){return arguments.length?(c=e,f()):c},d.copy=function(){return De(e,a,c)},f()}function Ee(e,a){function c(d){return a[p.bisect(e,d)]}return c.domain=function(a){return arguments.length?(e=a,c):e},c.range=function(e){return arguments.length?(a=e,c):a},c.copy=function(){return Ee(e,a)},c}function Fe(e){function a(e){return+e}return a.invert=a,a.domain=a.range=function(c){return arguments.length?(e=c.map(a),
a):e},a.ticks=function(a){return Gc(e,a)},a.tickFormat=function(a,c){return Hc(e,a,c)},a.copy=function(){return Fe(e)},a}function yg(e){return e.innerRadius}function zg(e){return e.outerRadius}function Ge(e){return e.startAngle}function He(e){return e.endAngle}function Ie(e){for(var a,c,d,f=-1,q=e.length;++f<q;)a=e[f],c=a[0],d=a[1]+Ea,a[0]=c*Math.cos(d),a[1]=c*Math.sin(d);return e}function Je(e){function a(u){function h(){y.push("M",r(e(M),p),l,m(e(I.reverse()),p),"Z")}for(var S,s,B,y=[],I=[],M=[],
t=-1,v=u.length,z=O(c),V=O(f),w=c===d?function(){return s}:O(d),qa=f===q?function(){return B}:O(q);++t<v;)g.call(this,S=u[t],t)?(I.push([s=+z.call(this,S,t),B=+V.call(this,S,t)]),M.push([+w.call(this,S,t),+qa.call(this,S,t)])):I.length&&(h(),I=[],M=[]);return I.length&&h(),y.length?y.join(""):null}var c=na,d=na,f=0,q=ra,g=Ta,r=ja,h=r.key,m=r,l="L",p=0.7;return a.x=function(e){return arguments.length?(c=d=e,a):d},a.x0=function(e){return arguments.length?(c=e,a):c},a.x1=function(e){return arguments.length?
(d=e,a):d},a.y=function(e){return arguments.length?(f=q=e,a):q},a.y0=function(e){return arguments.length?(f=e,a):f},a.y1=function(e){return arguments.length?(q=e,a):q},a.defined=function(e){return arguments.length?(g=e,a):g},a.interpolate=function(e){return arguments.length?(h="function"==typeof e?r=e:(r=rc.get(e)||ja).key,m=r.reverse||r,l=r.closed?"M":"L",a):h},a.tension=function(e){return arguments.length?(p=e,a):p},a}function Ag(e){return e.radius}function Ke(e){return[e.x,e.y]}function Bg(e){return function(){var a=
e.apply(this,arguments),c=a[0],a=a[1]+Ea;return[c*Math.cos(a),c*Math.sin(a)]}}function Cg(){return 64}function Dg(){return"circle"}function Le(e){e=Math.sqrt(e/C);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function $a(e,a){return Pb(e,aa),e.id=a,e}function Jc(e,a,c,d){var f=e.id;return xa(e,"function"==typeof c?function(e,g,r){e.__transition__[f].tween.set(a,d(c.call(e,e.__data__,g,r)))}:(c=d(c),function(e){e.__transition__[f].tween.set(a,c)}))}function Eg(e){return null==
e&&(e=""),function(){this.textContent=e}}function Ab(e,c,d,f){var g=e.__transition__||(e.__transition__={active:0,count:0}),q=g[d];if(!q){var h=f.time;return q=g[d]={tween:new a,event:p.dispatch("start","end"),time:h,ease:f.ease,delay:f.delay,duration:f.duration},++g.count,p.timer(function(a){function f(a){return g.active>d?m():(g.active=d,t.start.call(e,l,c),q.tween.forEach(function(a,d){(d=d.call(e,l,c))&&B.push(d)}),G(a)||p.timer(G,0,h),1)}function G(a){if(g.active!==d)return m();a=(a-E)/x;for(var f=
s(a),q=B.length;0<q;)B[--q].call(e,f);return 1<=a?(m(),t.end.call(e,l,c),1):void 0}function m(){return--g.count?delete g[d]:delete e.__transition__,1}var l=e.__data__,s=q.ease,t=q.event,E=q.delay,x=q.duration,B=[];return a>=E?f(a):p.timer(f,E,h),1},0,h),q}}function Me(e,a){e.attr("transform",function(e){return"translate("+a(e)+",0)"})}function Ne(e,a){e.attr("transform",function(e){return"translate(0,"+a(e)+")"})}function Fg(e,a,c){if(d=[],c&&1<a.length){for(var d,f,g=Za(e.domain()),h=-1,r=a.length,
m=(a[1]-a[0])/++c;++h<r;)for(e=c;0<--e;)(f=+a[h]-e*m)>=g[0]&&d.push(f);--h;for(e=0;++e<c&&(f=+a[h]+e*m)<g[1];)d.push(f)}return d}function Fa(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ga(e,a,c){function d(a){var c=e(a),n=g(c,1);return n-a>a-c?c:n}function f(c){return a(c=e(new ea(c-1)),1),c}function g(e,c){return a(e=new ea(+e),c),e}function h(e,d,g){e=f(e);var q=[];if(1<g)for(;d>e;)c(e)%g||q.push(new Date(+e)),a(e,1);else for(;d>e;)q.push(new Date(+e)),
a(e,1);return q}e.floor=e;e.round=d;e.ceil=f;e.offset=g;e.range=h;var r=e.utc=Bb(e);return r.floor=r,r.round=Bb(d),r.ceil=Bb(f),r.offset=Bb(g),r.range=function(e,a,c){try{ea=Fa;var d=new Fa;return d._=e,h(d,a,c)}finally{ea=Date}},e}function Bb(e){return function(a,c){try{ea=Fa;var d=new Fa;return d._=a,e(d,c)._}finally{ea=Date}}}function Cb(e,a,c,d){for(var f,g,h=0,r=a.length,m=c.length;r>h;){if(d>=m)return-1;if(f=a.charCodeAt(h++),37===f){if(g=Gg[a.charAt(h++)],!g||0>(d=g(e,c,d)))return-1}else if(f!=
c.charCodeAt(d++))return-1}return d}function Db(e){return RegExp("^(?:"+e.map(p.requote).join("|")+")","i")}function Oe(e){for(var c=new a,d=-1,f=e.length;++d<f;)c.set(e[d].toLowerCase(),d);return c}function ha(e,a,c){e+="";var d=e.length;return c>d?Array(c-d+1).join(a)+e:e}function Pe(e,a,c){fa.lastIndex=0;return(a=fa.exec(a.substring(c,c+2)))?(e.d=+a[0],c+a[0].length):-1}function Qe(e,a,c){fa.lastIndex=0;return(a=fa.exec(a.substring(c,c+2)))?(e.H=+a[0],c+a[0].length):-1}function Kc(e){return e.toISOString()}
function Lc(e,a,c){function d(a){return e(a)}return d.invert=function(a){return Mc(e.invert(a))},d.domain=function(a){return arguments.length?(e.domain(a),d):e.domain().map(Mc)},d.nice=function(e){return d.domain(yb(d.domain(),function(){return e}))},d.ticks=function(c,n){var f,g=d.domain();f=g[0];g=g[g.length-1];f=g>f?[f,g]:[g,f];if("function"!=typeof c){var g=(f[1]-f[0])/c,h=p.bisect(Eb,g);if(h==Eb.length)return a.year(f,c);if(!h)return e.ticks(c).map(Mc);Math.log(g/Eb[h-1])<Math.log(Eb[h]/g)&&
--h;c=a[h];n=c[1];c=c[0].range}return c(f[0],new Date(+f[1]+1),n)},d.tickFormat=function(){return c},d.copy=function(){return Lc(e.copy(),a,c)},p.rebind(d,e,"range","rangeRound","interpolate","clamp")}function Mc(e){return new Date(e)}function Re(e){return function(a){for(var c=e.length-1,d=e[c];!d[1](a);)d=e[--c];return d[0](a)}}function Nc(e){var a=new Date(e,0,1);return a.setFullYear(e),a}function Hg(e){var a=e.getFullYear(),c=Nc(a),d=Nc(a+1);return a+(e-c)/(d-c)}function Oc(e){var a=new Date(Date.UTC(e,
0,1));return a.setUTCFullYear(e),a}function Ig(e){var a=e.getUTCFullYear(),c=Oc(a),d=Oc(a+1);return a+(e-c)/(d-c)}function Jg(e){return e.responseText}function Kg(e){return JSON.parse(e.responseText)}function Lg(e){var a=ga.createRange();return a.selectNode(ga.body),a.createContextualFragment(e.responseText)}function Mg(e){return e.responseXML}var p={version:"3.1.5"};Date.now||(Date.now=function(){return+new Date});var ga=document,ca=window;try{ga.createElement("div").style.setProperty("opacity",
0,"")}catch(qh){var Se=ca.CSSStyleDeclaration.prototype,Ng=Se.setProperty;Se.setProperty=function(e,a,c){Ng.call(this,e,a+"",c)}}p.ascending=function(e,a){return a>e?-1:e>a?1:e>=a?0:0/0};p.descending=function(e,a){return e>a?-1:a>e?1:a>=e?0:0/0};p.min=function(e,a){var c,d,f=-1,g=e.length;if(1===arguments.length){for(;++f<g&&(null==(c=e[f])||c!=c);)c=void 0;for(;++f<g;)null!=(d=e[f])&&c>d&&(c=d)}else{for(;++f<g&&(null==(c=a.call(e,e[f],f))||c!=c);)c=void 0;for(;++f<g;)null!=(d=a.call(e,e[f],f))&&
c>d&&(c=d)}return c};p.max=function(e,a){var c,d,f=-1,g=e.length;if(1===arguments.length){for(;++f<g&&(null==(c=e[f])||c!=c);)c=void 0;for(;++f<g;)null!=(d=e[f])&&d>c&&(c=d)}else{for(;++f<g&&(null==(c=a.call(e,e[f],f))||c!=c);)c=void 0;for(;++f<g;)null!=(d=a.call(e,e[f],f))&&d>c&&(c=d)}return c};p.extent=function(e,a){var c,d,f,g=-1,h=e.length;if(1===arguments.length){for(;++g<h&&(null==(c=f=e[g])||c!=c);)c=f=void 0;for(;++g<h;)null!=(d=e[g])&&(c>d&&(c=d),d>f&&(f=d))}else{for(;++g<h&&(null==(c=f=
a.call(e,e[g],g))||c!=c);)c=void 0;for(;++g<h;)null!=(d=a.call(e,e[g],g))&&(c>d&&(c=d),d>f&&(f=d))}return[c,f]};p.sum=function(e,a){var c,d=0,f=e.length,g=-1;if(1===arguments.length)for(;++g<f;)isNaN(c=+e[g])||(d+=c);else for(;++g<f;)isNaN(c=+a.call(e,e[g],g))||(d+=c);return d};p.mean=function(e,a){var c,f=e.length,g=0,q=-1,h=0;if(1===arguments.length)for(;++q<f;)d(c=e[q])&&(g+=(c-g)/++h);else for(;++q<f;)d(c=a.call(e,e[q],q))&&(g+=(c-g)/++h);return h?g:void 0};p.quantile=function(e,a){var c=(e.length-
1)*a+1,d=Math.floor(c),f=+e[d-1];return(c-=d)?f+c*(e[d]-f):f};p.median=function(e,a){return 1<arguments.length&&(e=e.map(a)),e=e.filter(d),e.length?p.quantile(e.sort(p.ascending),0.5):void 0};p.bisector=function(e){return{left:function(a,c,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&(f=a.length);f>d;){var g=d+f>>>1;e.call(a,a[g],g)<c?d=g+1:f=g}return d},right:function(a,c,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&(f=a.length);f>d;){var g=d+f>>>1;c<e.call(a,a[g],g)?f=g:d=g+
1}return d}}};var Te=p.bisector(function(e){return e});p.bisectLeft=Te.left;p.bisect=p.bisectRight=Te.right;p.shuffle=function(e){for(var a,c,d=e.length;d;)c=Math.random()*d--|0,a=e[d],e[d]=e[c],e[c]=a;return e};p.permute=function(e,a){for(var c=[],d=-1,f=a.length;++d<f;)c[d]=e[a[d]];return c};p.zip=function(){if(!(d=arguments.length))return[];for(var e=-1,a=p.min(arguments,h),c=Array(a);++e<a;)for(var d,f=-1,g=c[e]=Array(d);++f<d;)g[f]=arguments[f][e];return c};p.transpose=function(e){return p.zip.apply(p,
e)};p.keys=function(e){var a=[],c;for(c in e)a.push(c);return a};p.values=function(e){var a=[],c;for(c in e)a.push(e[c]);return a};p.entries=function(e){var a=[],c;for(c in e)a.push({key:c,value:e[c]});return a};p.merge=function(e){return Array.prototype.concat.apply([],e)};p.range=function(e,a,c){if(3>arguments.length&&(c=1,2>arguments.length&&(a=e,e=0)),1/0===(a-e)/c)throw Error("infinite range");var d,f=[],g;d=Math.abs(c);for(g=1;d*g%1;)g*=10;var h=-1;if(e*=g,a*=g,c*=g,0>c)for(;(d=e+c*++h)>a;)f.push(d/
g);else for(;(d=e+c*++h)<a;)f.push(d/g);return f};p.map=function(e){var c=new a,d;for(d in e)c.set(d,e[d]);return c};l(a,{has:function(e){return Ba+e in this},get:function(e){return this[Ba+e]},set:function(e,a){return this[Ba+e]=a},remove:function(e){return e=Ba+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(a){e.push(a)}),e},values:function(){var e=[];return this.forEach(function(a,c){e.push(c)}),e},entries:function(){var e=[];return this.forEach(function(a,c){e.push({key:a,
value:c})}),e},forEach:function(e){for(var a in this)a.charCodeAt(0)===Ue&&e.call(this,a.substring(1),this[a])}});var Ba="\x00",Ue=Ba.charCodeAt(0);p.nest=function(){function e(c,u,h){if(h>=q.length)return f?f.call(g,u):d?u.sort(d):u;for(var m,l,p,D,s=-1,x=u.length,B=q[h++],y=new a;++s<x;)(D=y.get(m=B(l=u[s])))?D.push(l):y.set(m,[l]);return c?(l=c(),p=function(a,d){l.set(a,e(c,d,h))}):(l={},p=function(a,d){l[a]=e(c,d,h)}),y.forEach(p),l}function c(e,a){if(a>=q.length)return e;var d=[],f=h[a++];return e.forEach(function(e,
f){d.push({key:e,values:c(f,a)})}),f?d.sort(function(e,a){return f(e.key,a.key)}):d}var d,f,g={},q=[],h=[];return g.map=function(a,c){return e(c,a,0)},g.entries=function(a){return c(e(p.map,a,0),0)},g.key=function(e){return q.push(e),g},g.sortKeys=function(e){return h[q.length-1]=e,g},g.sortValues=function(e){return d=e,g},g.rollup=function(e){return f=e,g},g};p.set=function(e){var a=new c;if(e)for(var d=0;d<e.length;d++)a.add(e[d]);return a};l(c,{has:function(e){return Ba+e in this},add:function(e){return this[Ba+
e]=!0,e},remove:function(e){return e=Ba+e,e in this&&delete this[e]},values:function(){var e=[];return this.forEach(function(a){e.push(a)}),e},forEach:function(e){for(var a in this)a.charCodeAt(0)===Ue&&e.call(this,a.substring(1))}});p.behavior={};p.rebind=function(e,a){for(var c,d=1,f=arguments.length;++d<f;)e[c=arguments[d]]=g(e,a,a[c]);return e};p.dispatch=function(){for(var e=new m,a=-1,c=arguments.length;++a<c;)e[arguments[a]]=f(e);return e};m.prototype.on=function(e,a){var c=e.indexOf("."),
d="";if(0<=c&&(d=e.substring(c+1),e=e.substring(0,c)),e)return 2>arguments.length?this[e].on(d):this[e].on(d,a);if(2===arguments.length){if(null==a)for(e in this)this.hasOwnProperty(e)&&this[e].on(d,null);return this}};p.event=null;p.mouse=function(e){return w(e,v())};var Ob=/WebKit/.test(ca.navigator.userAgent)?-1:0,wa=function(e){return Array.prototype.slice.call(e)};try{wa(ga.documentElement.childNodes)[0].nodeType}catch(rh){wa=Q}var Pb=[].__proto__?function(e,a){e.__proto__=a}:function(e,a){for(var c in a)e[c]=
a[c]};p.touches=function(e,a){return 2>arguments.length&&(a=v().touches),a?wa(a).map(function(a){var c=w(e,a);return c.identifier=a.identifier,c}):[]};p.behavior.drag=function(){function e(){this.on("mousedown.drag",a).on("touchstart.drag",a)}function a(){function e(){var a=u.parentNode;return null!=l?p.touches(a).filter(function(e){return e.identifier===l})[0]:p.mouse(a)}function f(){h({type:"dragend"});F&&(s(),p.event.target===m&&z(t,"click"));t.on(null!=l?"touchmove.drag-"+l:"mousemove.drag",null).on(null!=
l?"touchend.drag-"+l:"mouseup.drag",null)}var g,u=this,h=c.of(u,arguments),m=p.event.target,l=p.event.touches?p.event.changedTouches[0].identifier:null,U=e(),F=0,t=p.select(ca).on(null!=l?"touchmove.drag-"+l:"mousemove.drag",function(){if(!u.parentNode)return f();var a=e(),c=a[0]-U[0],d=a[1]-U[1];F|=c|d;U=a;s();h({type:"drag",x:a[0]+g[0],y:a[1]+g[1],dx:c,dy:d})}).on(null!=l?"touchend.drag-"+l:"mouseup.drag",f,!0);d?(g=d.apply(u,arguments),g=[g.x-U[0],g.y-U[1]]):g=[0,0];null==l&&s();h({type:"dragstart"})}
var c=t(e,"drag","dragstart","dragend"),d=null;return e.origin=function(a){return arguments.length?(d=a,e):d},p.rebind(e,c,"on")};var $c=function(e,a){return a.querySelector(e)},ad=function(e,a){return a.querySelectorAll(e)},Pa=ga.documentElement,Og=Pa.matchesSelector||Pa.webkitMatchesSelector||Pa.mozMatchesSelector||Pa.msMatchesSelector||Pa.oMatchesSelector,ed=function(e,a){return Og.call(e,a)};"function"==typeof Sizzle&&($c=function(e,a){return Sizzle(e,a)[0]||null},ad=function(e,a){return Sizzle.uniqueSort(Sizzle(e,
a))},ed=Sizzle.matchesSelector);var L=[];p.selection=function(){return ab};p.selection.prototype=L;L.select=function(e){var a,c,d,f,g=[];"function"!=typeof e&&(e=H(e));for(var h=-1,r=this.length;++h<r;){g.push(a=[]);a.parentNode=(d=this[h]).parentNode;for(var m=-1,l=d.length;++m<l;)(f=d[m])?(a.push(c=e.call(f,f.__data__,m)),c&&"__data__"in f&&(c.__data__=f.__data__)):a.push(null)}return K(g)};L.selectAll=function(e){var a,c,d=[];"function"!=typeof e&&(e=R(e));for(var f=-1,g=this.length;++f<g;)for(var h=
this[f],r=-1,m=h.length;++r<m;)(c=h[r])&&(d.push(a=wa(e.call(c,c.__data__,r))),a.parentNode=c);return K(d)};var Pc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};p.ns={prefix:Pc,qualify:function(e){var a=e.indexOf(":"),c=e;return 0<=a&&(c=e.substring(0,a),e=e.substring(a+1)),Pc.hasOwnProperty(c)?{space:Pc[c],local:e}:e}};L.attr=function(e,a){if(2>arguments.length){if("string"==
typeof e){var c=this.node();return e=p.ns.qualify(e),e.local?c.getAttributeNS(e.space,e.local):c.getAttribute(e)}for(a in e)this.each(Sa(a,e[a]));return this}return this.each(Sa(e,a))};p.requote=function(e){return e.replace(Pg,"\\$&")};var Pg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;L.classed=function(e,a){if(2>arguments.length){if("string"==typeof e){var c=this.node(),d=(e=e.trim().split(/^|\s+/g)).length,f=-1;if(a=c.classList)for(;++f<d;){if(!a.contains(e[f]))return!1}else for(a=c.getAttribute("class");++f<
d;)if(!Yc(e[f]).test(a))return!1;return!0}for(a in e)this.each(Zc(a,e[a]));return this}return this.each(Zc(e,a))};L.style=function(e,a,c){var d=arguments.length;if(3>d){if("string"!=typeof e){2>d&&(a="");for(c in e)this.each(bd(c,e[c],a));return this}if(2>d)return ca.getComputedStyle(this.node(),null).getPropertyValue(e);c=""}return this.each(bd(e,a,c))};L.property=function(e,a){if(2>arguments.length){if("string"==typeof e)return this.node()[e];for(a in e)this.each(cd(a,e[a]));return this}return this.each(cd(e,
a))};L.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var a=e.apply(this,arguments);this.textContent=null==a?"":a}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};L.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var a=e.apply(this,arguments);this.innerHTML=null==a?"":a}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};L.append=function(e){function a(){return this.appendChild(ga.createElementNS(this.namespaceURI,
e))}function c(){return this.appendChild(ga.createElementNS(e.space,e.local))}return e=p.ns.qualify(e),this.select(e.local?c:a)};L.insert=function(a,c){function d(f,n){return this.insertBefore(ga.createElementNS(this.namespaceURI,a),c.call(this,f,n))}function f(d,n){return this.insertBefore(ga.createElementNS(a.space,a.local),c.call(this,d,n))}return a=p.ns.qualify(a),"function"!=typeof c&&(c=H(c)),this.select(a.local?f:d)};L.remove=function(){return this.each(function(){var a=this.parentNode;a&&
a.removeChild(this)})};L.data=function(e,c){function d(e,f){var n,g,q,h=e.length,p=f.length,A=Math.min(h,p),G=Array(p),D=Array(p),s=Array(h);if(c){var t=new a,v=new a,V=[];for(n=-1;++n<h;)A=c.call(g=e[n],g.__data__,n),t.has(A)?s[n]=g:t.set(A,g),V.push(A);for(n=-1;++n<p;)A=c.call(f,q=f[n],n),(g=t.get(A))?(G[n]=g,g.__data__=q):v.has(A)||(D[n]={__data__:q}),v.set(A,q),t.remove(A);for(n=-1;++n<h;)t.has(V[n])&&(s[n]=e[n])}else{for(n=-1;++n<A;)g=e[n],q=f[n],g?(g.__data__=q,G[n]=g):D[n]={__data__:q};for(;p>
n;++n)D[n]={__data__:f[n]};for(;h>n;++n)s[n]=e[n]}D.update=G;D.parentNode=G.parentNode=s.parentNode=e.parentNode;r.push(D);m.push(G);l.push(s)}var f,g,q=-1,h=this.length;if(!arguments.length){for(e=Array(h=(f=this[0]).length);++q<h;)(g=f[q])&&(e[q]=g.__data__);return e}var r=id([]),m=K([]),l=K([]);if("function"==typeof e)for(;++q<h;)d(f=this[q],e.call(f,f.parentNode.__data__,q));else for(;++q<h;)d(f=this[q],e);return m.enter=function(){return r},m.exit=function(){return l},m};L.datum=function(a){return arguments.length?
this.property("__data__",a):this.property("__data__")};L.filter=function(a){var c,d,f,g=[];"function"!=typeof a&&(a=dd(a));for(var q=0,h=this.length;h>q;q++){g.push(c=[]);c.parentNode=(d=this[q]).parentNode;for(var r=0,m=d.length;m>r;r++)(f=d[r])&&a.call(f,f.__data__,r)&&c.push(f)}return K(g)};L.order=function(){for(var a=-1,c=this.length;++a<c;)for(var d,f=this[a],g=f.length-1,q=f[g];0<=--g;)(d=f[g])&&(q&&q!==d.nextSibling&&q.parentNode.insertBefore(d,q),q=d);return this};L.sort=function(a){a=sf.apply(this,
arguments);for(var c=-1,d=this.length;++c<d;)this[c].sort(a);return this.order()};L.on=function(a,c,d){var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(c=!1);for(d in a)this.each(fd(d,a[d],c));return this}if(2>f)return(f=this.node()["__on"+a])&&f._;d=!1}return this.each(fd(a,c,d))};var Qb=p.map({mouseenter:"mouseover",mouseleave:"mouseout"});Qb.forEach(function(a){"on"+a in ga&&Qb.remove(a)});L.each=function(a){return xa(this,function(c,d,f){a.call(c,c.__data__,d,f)})};L.call=function(a){var c=
wa(arguments);return a.apply(c[0]=this,c),this};L.empty=function(){return!this.node()};L.node=function(){for(var a=0,c=this.length;c>a;a++)for(var d=this[a],f=0,g=d.length;g>f;f++){var q=d[f];if(q)return q}return null};var Ca=[];p.selection.enter=id;p.selection.enter.prototype=Ca;Ca.append=L.append;Ca.insert=L.insert;Ca.empty=L.empty;Ca.node=L.node;Ca.select=function(a){for(var c,d,f,g,q,h=[],r=-1,m=this.length;++r<m;){f=(g=this[r]).update;h.push(c=[]);c.parentNode=g.parentNode;for(var l=-1,p=g.length;++l<
p;)(q=g[l])?(c.push(f[l]=d=a.call(g.parentNode,q.__data__,l)),d.__data__=q.__data__):c.push(null)}return K(h)};L.transition=function(){var a,c,d=bb||++Ve,f=[],g=Object.create(Fb);g.time=Date.now();for(var q=-1,h=this.length;++q<h;){f.push(a=[]);for(var r=this[q],m=-1,l=r.length;++m<l;)(c=r[m])&&Ab(c,m,d,g),a.push(c)}return $a(f,d)};var ab=K([[ga]]);ab[0].parentNode=Pa;p.select=function(a){return"string"==typeof a?ab.select(a):K([[a]])};p.selectAll=function(a){return"string"==typeof a?ab.selectAll(a):
K([wa(a)])};p.behavior.zoom=function(){function a(){this.on("mousedown.zoom",h).on("mousemove.zoom",m).on(Qg+".zoom",r).on("dblclick.zoom",l).on("touchstart.zoom",va).on("touchmove.zoom",U).on("touchend.zoom",va)}function c(a){return[(a[0]-M[0])/P,(a[1]-M[1])/P]}function d(a){P=Math.max(v[0],Math.min(v[1],a))}function f(a,e){e=[e[0]*P+M[0],e[1]*P+M[1]];M[0]+=a[0]-e[0];M[1]+=a[1]-e[1]}function g(){x&&x.domain(E.range().map(function(a){return(a-M[0])/P}).map(E.invert));y&&y.domain(B.range().map(function(a){return(a-
M[1])/P}).map(B.invert))}function q(a){g();p.event.preventDefault();a({type:"zoom",scale:P,translate:M})}function h(){var a=this,e=da.of(a,arguments),d=p.event.target,n=0,g=p.select(ca).on("mousemove.zoom",function(){n=1;f(p.mouse(a),r);q(e)}).on("mouseup.zoom",function(){n&&s();g.on("mousemove.zoom",null).on("mouseup.zoom",null);n&&p.event.target===d&&z(g,"click.zoom")}),r=c(p.mouse(a));ca.focus();s()}function r(){F||(F=c(p.mouse(this)));d(Math.pow(2,0.002*Gb())*P);f(p.mouse(this),F);q(da.of(this,
arguments))}function m(){F=null}function l(){var a=p.mouse(this),e=c(a),g=Math.log(P)/Math.LN2;d(Math.pow(2,p.event.shiftKey?Math.ceil(g)-1:Math.floor(g)+1));f(a,e);q(da.of(this,arguments))}function va(){var a=p.touches(this),e=Date.now();if(gd=P,F={},a.forEach(function(a){F[a.identifier]=c(a)}),s(),1===a.length){if(500>e-I){var g=a[0],a=c(a[0]);d(2*P);f(g,a);q(da.of(this,arguments))}I=e}}function U(){var a=p.touches(this),e=a[0],c=F[e.identifier];if(a=a[1]){var g=F[a.identifier],e=[(e[0]+a[0])/2,
(e[1]+a[1])/2],c=[(c[0]+g[0])/2,(c[1]+g[1])/2];d(p.event.scale*gd)}f(e,c);I=null;q(da.of(this,arguments))}var F,gd,E,x,B,y,I,M=[0,0],P=1,v=We,da=t(a,"zoom");return a.translate=function(c){return arguments.length?(M=c.map(Number),g(),a):M},a.scale=function(c){return arguments.length?(P=+c,g(),a):P},a.scaleExtent=function(c){return arguments.length?(v=null==c?We:c.map(Number),a):v},a.x=function(c){return arguments.length?(x=c,E=c.copy(),M=[0,0],P=1,a):x},a.y=function(c){return arguments.length?(y=c,
B=c.copy(),M=[0,0],P=1,a):y},p.rebind(a,da,"on")};var Gb,We=[0,1/0],Qg="onwheel"in ga?(Gb=function(){return-p.event.deltaY*(p.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ga?(Gb=function(){return p.event.wheelDelta},"mousewheel"):(Gb=function(){return-p.event.detail},"MozMousePixelScroll");Ia.prototype.toString=function(){return this.rgb()+""};p.hsl=function(a,c,d){return 1===arguments.length?a instanceof Sb?Ja(a.h,a.s,a.l):Yb(""+a,od,Ja):Ja(+a,+c,+d)};var Qc=Sb.prototype=new Ia;Qc.brighter=
function(a){return a=Math.pow(0.7,arguments.length?a:1),Ja(this.h,this.s,this.l/a)};Qc.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),Ja(this.h,this.s,a*this.l)};Qc.rgb=function(){return cb(this.h,this.s,this.l)};var C=Math.PI,N=1E-6,J=C/180,T=180/C;p.hcl=function(a,c,d){var f;if(1===arguments.length)if(a instanceof db)f=Ka(a.h,a.c,a.l);else if(a instanceof eb)f=Ka(Math.atan2(a.b,a.a)*T,Math.sqrt(a.a*a.a+a.b*a.b),a.l);else{f=(a=pd((a=p.rgb(a)).r,a.g,a.b)).l;var g=a.a,q=a.b;f=Ka(Math.atan2(q,
g)*T,Math.sqrt(g*g+q*q),f)}else f=Ka(+a,+c,+d);return f};var Rc=db.prototype=new Ia;Rc.brighter=function(a){return Ka(this.h,this.c,Math.min(100,this.l+Hb*(arguments.length?a:1)))};Rc.darker=function(a){return Ka(this.h,this.c,Math.max(0,this.l-Hb*(arguments.length?a:1)))};Rc.rgb=function(){return Tb(this.h,this.c,this.l).rgb()};p.lab=function(a,c,d){return 1===arguments.length?a instanceof eb?La(a.l,a.a,a.b):a instanceof db?Tb(a.l,a.c,a.h):pd((a=p.rgb(a)).r,a.g,a.b):La(+a,+c,+d)};var Hb=18,ld=0.95047,
md=1,nd=1.08883,Sc=eb.prototype=new Ia;Sc.brighter=function(a){return La(Math.min(100,this.l+Hb*(arguments.length?a:1)),this.a,this.b)};Sc.darker=function(a){return La(Math.max(0,this.l-Hb*(arguments.length?a:1)),this.a,this.b)};Sc.rgb=function(){return kd(this.l,this.a,this.b)};p.rgb=function(a,c,d){return 1===arguments.length?a instanceof Xb?pa(a.r,a.g,a.b):Yb(""+a,pa,cb):pa(~~a,~~c,~~d)};var Ib=Xb.prototype=new Ia;Ib.brighter=function(a){a=Math.pow(0.7,arguments.length?a:1);var c=this.r,d=this.g,
f=this.b;return c||d||f?(c&&30>c&&(c=30),d&&30>d&&(d=30),f&&30>f&&(f=30),pa(Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a)),Math.min(255,Math.floor(f/a)))):pa(30,30,30)};Ib.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),pa(Math.floor(a*this.r),Math.floor(a*this.g),Math.floor(a*this.b))};Ib.hsl=function(){return od(this.r,this.g,this.b)};Ib.toString=function(){return"#"+Ma(this.r)+Ma(this.g)+Ma(this.b)};var fb=p.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",
aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",
darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",
greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",
lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",
olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",
slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});fb.forEach(function(a,c){fb.set(a,Yb(c,pa,cb))});p.functor=O;p.xhr=function(a,c,d){function f(){var a=m.status;!a&&m.responseText||200<=a&&300>a||304===a?q.load.call(g,r.call(g,m)):q.error.call(g,m)}var g={},q=
p.dispatch("progress","load","error"),h={},r=ia,m=new (ca.XDomainRequest&&/^(http(s)?:)?\/\//.test(a)?XDomainRequest:XMLHttpRequest);return"onload"in m?m.onload=m.onerror=f:m.onreadystatechange=function(){3<m.readyState&&f()},m.onprogress=function(a){var e=p.event;p.event=a;try{q.progress.call(g,m)}finally{p.event=e}},g.header=function(a,e){return a=(a+"").toLowerCase(),2>arguments.length?h[a]:(null==e?delete h[a]:h[a]=e+"",g)},g.mimeType=function(a){return arguments.length?(c=null==a?null:a+"",g):
c},g.response=function(a){return r=a,g},["get","post"].forEach(function(a){g[a]=function(){return g.send.apply(g,[a].concat(wa(arguments)))}}),g.send=function(d,f,n){if(2===arguments.length&&"function"==typeof f&&(n=f,f=null),m.open(d,a,!0),null==c||"accept"in h||(h.accept=c+",*/*"),m.setRequestHeader)for(var q in h)m.setRequestHeader(q,h[q]);return null!=c&&m.overrideMimeType&&m.overrideMimeType(c),null!=n&&g.on("error",n).on("load",function(a){n(null,a)}),m.send(null==f?null:f),g},g.abort=function(){return m.abort(),
g},p.rebind(g,q,"on"),2===arguments.length&&"function"==typeof c&&(d=c,c=null),null==d?g:g.get(uf(d))};p.csv=qd(",","text/csv");p.tsv=qd("\t","text/tab-separated-values");var hb,gb,Rg=0,bc={},Na=null;p.timer=function(a,c,d){if(3>arguments.length){if(2>arguments.length)c=0;else if(!isFinite(c))return;d=Date.now()}var f=bc[a.id];f&&f.callback===a?(f.then=d,f.delay=c):bc[a.id=++Rg]=Na={callback:a,then:d,delay:c,next:Na};hb||(gb=clearTimeout(gb),hb=1,sd(ac))};p.timer.flush=function(){for(var a,c=Date.now(),
d=Na;d;)a=c-d.then,d.delay||(d.flush=d.callback(a)),d=d.next;rd()};var sd=ca.requestAnimationFrame||ca.webkitRequestAnimationFrame||ca.mozRequestAnimationFrame||ca.oRequestAnimationFrame||ca.msRequestAnimationFrame||function(a){setTimeout(a,17)},Jb=[3,3],Sg="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(a,c){var d=Math.pow(10,3*Math.abs(8-c));return{scale:8<c?function(a){return a/d}:function(a){return a*d},symbol:a}});p.formatPrefix=function(a,c){var d=0;return a&&(0>a&&(a*=-1),c&&
(a=p.round(a,cc(a,c))),d=1+Math.floor(1E-12+Math.log(a)/Math.LN10),d=Math.max(-24,Math.min(24,3*Math.floor((0>=d?d+1:d-1)/3)))),Sg[8+d/3]};p.round=function(a,c){return c?Math.round(a*(c=Math.pow(10,c)))/c:Math.round(a)};p.format=function(a){a=we.exec(a);var c=a[1]||" ",d=a[2]||">",f=a[3]||"",g=a[4]||"",q=a[5],h=+a[6],r=a[7],m=a[8],l=a[9],s=1,t="",F=!1;switch(m&&(m=+m.substring(1)),(q||"0"===c&&"="===d)&&(q=c="0",d="=",r&&(h-=Math.floor((h-1)/4))),l){case "n":r=!0;l="g";break;case "%":s=100;t="%";
l="f";break;case "p":s=100;t="%";l="r";break;case "b":case "o":case "x":case "X":g&&(g="0"+l.toLowerCase());case "c":case "d":F=!0;m=0;break;case "s":s=-1,l="r"}"#"===g&&(g="");"r"!=l||m||(l="g");null!=m&&("g"==l?m=Math.max(1,Math.min(21,m)):("e"==l||"f"==l)&&(m=Math.max(0,Math.min(20,m))));var l=Tg.get(l)||vf,v=q&&r;return function(a){if(F&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):f;if(0>s){var B=p.formatPrefix(a,m);a=B.scale(a);t=B.symbol}else a*=s;a=l(a,m);!q&&r&&(a=Tc(a));var B=g.length+
a.length+(v?0:e.length),y=h>B?Array(B=h-B+1).join(c):"";return v&&(a=Tc(y+a)),a.replace(".","."),e+=g,("<"===d?e+a+y:">"===d?y+e+a:"^"===d?y.substring(0,B>>=1)+e+a+y.substring(B):e+(v?a:y+a))+t}};var we=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Tg=p.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,
c){return a.toPrecision(c)},e:function(a,c){return a.toExponential(c)},f:function(a,c){return a.toFixed(c)},r:function(a,c){return(a=p.round(a,cc(a,c))).toFixed(Math.max(0,Math.min(20,cc(a*(1+1E-15),c))))}}),Tc=ia;if(Jb)var Ug=Jb.length,Tc=function(a){for(var c=a.lastIndexOf("."),d=0<=c?"."+a.substring(c+1):(c=a.length,""),f=[],g=0,q=Jb[0];0<c&&0<q;)f.push(a.substring(c-=q,c+q)),q=Jb[g=(g+1)%Ug];return f.reverse().join(",")+d};p.geo={};p.geo.stream=function(a,c){a&&Xe.hasOwnProperty(a.type)?Xe[a.type](a,
c):ib(a,c)};var Xe={Feature:function(a,c){ib(a.geometry,c)},FeatureCollection:function(a,c){for(var d=a.features,f=-1,g=d.length;++f<g;)ib(d[f].geometry,c)}},td={Sphere:function(a,c){c.sphere()},Point:function(a,c){var d=a.coordinates;c.point(d[0],d[1])},MultiPoint:function(a,c){for(var d,f=a.coordinates,g=-1,q=f.length;++g<q;)d=f[g],c.point(d[0],d[1])},LineString:function(a,c){dc(a.coordinates,c,0)},MultiLineString:function(a,c){for(var d=a.coordinates,f=-1,g=d.length;++f<g;)dc(d[f],c,0)},Polygon:function(a,
c){ud(a.coordinates,c)},MultiPolygon:function(a,c){for(var d=a.coordinates,f=-1,g=d.length;++f<g;)ud(d[f],c)},GeometryCollection:function(a,c){for(var d=a.geometries,f=-1,g=d.length;++f<g;)ib(d[f],c)}};p.geo.area=function(a){return Qa=0,p.geo.stream(a,ya),Qa};var Qa,jb,kb,ya={sphere:function(){Qa+=4*C},point:Z,lineStart:Z,lineEnd:Z,polygonStart:function(){jb=1;kb=0;ya.lineStart=wf},polygonEnd:function(){var a=2*Math.atan2(kb,jb);Qa+=0>a?4*C+a:a;ya.lineStart=ya.lineEnd=ya.point=Z}};p.geo.bounds=vd(ia);
p.geo.centroid=function(a){ba=ka=X=Y=W=0;p.geo.stream(a,la);var c;return ka&&Math.abs(c=Math.sqrt(X*X+Y*Y+W*W))>N?[Math.atan2(Y,X)*T,Math.asin(Math.max(-1,Math.min(1,W/c)))*T]:void 0};var ba,ka,X,Y,W,la={sphere:function(){2>ba&&(ba=2,ka=X=Y=W=0)},point:wd,lineStart:ec,lineEnd:fc,polygonStart:function(){2>ba&&(ba=2,ka=X=Y=W=0);la.lineStart=xf},polygonEnd:function(){la.lineStart=ec}},Fd=Ad(Ta,function(a){var c,d=0/0,f=0/0,g=0/0;return{lineStart:function(){a.lineStart();c=1},point:function(q,h){var r=
0<q?C:-C,m=Math.abs(q-d);if(Math.abs(m-C)<N)a.point(d,f=0<(f+h)/2?C/2:-C/2),a.point(g,f),a.lineEnd(),a.lineStart(),a.point(r,f),a.point(q,f),c=0;else if(g!==r&&m>=C){Math.abs(d-g)<N&&(d-=g*N);Math.abs(q-r)<N&&(q-=r*N);var m=d,l=f,p=q,s,F,t=Math.sin(m-p);f=Math.abs(t)>N?Math.atan((Math.sin(l)*(F=Math.cos(h))*Math.sin(p)-Math.sin(h)*(s=Math.cos(l))*Math.sin(m))/(s*F*t)):(l+h)/2;a.point(g,f);a.lineEnd();a.lineStart();a.point(r,f);c=0}a.point(d=q,f=h);g=r},lineEnd:function(){a.lineEnd();d=f=0/0},clean:function(){return 2-
c}}},function(a,c,d,f){null==a?(d=d*C/2,f.point(-C,d),f.point(0,d),f.point(C,d),f.point(C,0),f.point(C,-d),f.point(0,-d),f.point(-C,-d),f.point(-C,0),f.point(-C,d)):Math.abs(a[0]-c[0])>N?(a=(a[0]<c[0]?1:-1)*C,d=d*a/2,f.point(-a,d),f.point(0,d),f.point(a,d)):f.point(c[0],c[1])}),pb=1E9;p.geo.projection=za;p.geo.projectionMutator=jc;(p.geo.equirectangular=function(){return za(Ua)}).raw=Ua.invert=Ua;p.geo.rotation=function(a){function c(d){return d=a(d[0]*J,d[1]*J),d[0]*=T,d[1]*=T,d}return a=kc(a[0]%
360*J,a[1]*J,2<a.length?a[2]*J:0),c.invert=function(c){return c=a.invert(c[0]*J,c[1]*J),c[0]*=T,c[1]*=T,c},c};p.geo.circle=function(){function a(){var e="function"==typeof f?f.apply(this,arguments):f,c=kc(-e[0]*J,-e[1]*J,0).invert,g=[];return d(null,null,1,{point:function(a,e){g.push(a=c(a,e));a[0]*=T;a[1]*=T}}),{type:"Polygon",coordinates:[g]}}var c,d,f=[0,0],g=6;return a.origin=function(c){return arguments.length?(f=c,a):f},a.angle=function(f){return arguments.length?(d=ic((c=+f)*J,g*J),a):c},a.precision=
function(f){return arguments.length?(d=ic(c*J,(g=+f)*J),a):g},a.angle(90)};p.geo.distance=function(a,c){var d,f=(c[0]-a[0])*J,g=a[1]*J,h=c[1]*J,m=Math.sin(f),f=Math.cos(f),r=Math.sin(g),g=Math.cos(g),l=Math.sin(h),h=Math.cos(h);return Math.atan2(Math.sqrt((d=h*m)*d+(d=g*l-r*h*f)*d),r*l+g*h*f)};p.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:c()}}function c(){return p.range(Math.ceil(h/B)*B,g,B).map(F).concat(p.range(Math.ceil(s/y)*y,l,y).map(v)).concat(p.range(Math.ceil(f/
E)*E,d,E).filter(function(a){return Math.abs(a%B)>N}).map(t)).concat(p.range(Math.ceil(r/x)*x,m,x).filter(function(a){return Math.abs(a%y)>N}).map(U))}var d,f,g,h,m,r,l,s,t,U,F,v,E=10,x=E,B=90,y=360,I=2.5;return a.lines=function(){return c().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[F(h).concat(v(l).slice(1),F(g).reverse().slice(1),v(s).reverse().slice(1))]}},a.extent=function(c){return arguments.length?a.majorExtent(c).minorExtent(c):
a.minorExtent()},a.majorExtent=function(c){return arguments.length?(h=+c[0][0],g=+c[1][0],s=+c[0][1],l=+c[1][1],h>g&&(c=h,h=g,g=c),s>l&&(c=s,s=l,l=c),a.precision(I)):[[h,s],[g,l]]},a.minorExtent=function(c){return arguments.length?(f=+c[0][0],d=+c[1][0],r=+c[0][1],m=+c[1][1],f>d&&(c=f,f=d,d=c),r>m&&(c=r,r=m,m=c),a.precision(I)):[[f,r],[d,m]]},a.step=function(c){return arguments.length?a.majorStep(c).minorStep(c):a.minorStep()},a.majorStep=function(c){return arguments.length?(B=+c[0],y=+c[1],a):[B,
y]},a.minorStep=function(c){return arguments.length?(E=+c[0],x=+c[1],a):[E,x]},a.precision=function(c){return arguments.length?(I=+c,t=Kd(r,m,90),U=Ld(f,d,I),F=Kd(s,l,90),v=Ld(h,g,I),a):I},a.majorExtent([[-180,-90+N],[180,90-N]]).minorExtent([[-180,-80-N],[180,80+N]])};p.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[c||f.apply(this,arguments),d||g.apply(this,arguments)]}}var c,d,f=lc,g=mc;return a.distance=function(){return p.geo.distance(c||f.apply(this,arguments),d||
g.apply(this,arguments))},a.source=function(d){return arguments.length?(f=d,c="function"==typeof d?null:d,a):f},a.target=function(c){return arguments.length?(g=c,d="function"==typeof c?null:c,a):g},a.precision=function(){return arguments.length?a:0},a};p.geo.interpolate=function(a,c){return Df(a[0]*J,a[1]*J,c[0]*J,c[1]*J)};p.geo.length=function(a){return Kb=0,p.geo.stream(a,Ra),Kb};var Kb,Ra={sphere:Z,point:Z,lineStart:function(){function a(e,g){var h=Math.sin(g*=J),r=Math.cos(g),m=Math.abs((e*=J)-
c),l=Math.cos(m);Kb+=Math.atan2(Math.sqrt((m=r*Math.sin(m))*m+(m=f*h-d*r*l)*m),d*h+f*r*l);c=e;d=h;f=r}var c,d,f;Ra.point=function(g,h){c=g*J;d=Math.sin(h*=J);f=Math.cos(h);Ra.point=a};Ra.lineEnd=function(){Ra.point=Ra.lineEnd=Z}},lineEnd:Z,polygonStart:Z,polygonEnd:Z};(p.geo.conicEqualArea=function(){return nc(Md)}).raw=Md;p.geo.albersUsa=function(){function a(e){var c=e[0],d=e[1];return(50<d?h:-140>c?m:21>d?r:g)(e)}var c,d,f,g=p.geo.conicEqualArea().rotate([98,0]).center([0,38]).parallels([29.5,
45.5]),h=p.geo.conicEqualArea().rotate([160,0]).center([0,60]).parallels([55,65]),m=p.geo.conicEqualArea().rotate([160,0]).center([0,20]).parallels([8,18]),r=p.geo.conicEqualArea().rotate([60,0]).center([0,10]).parallels([8,18]);return a.invert=function(a){return c(a)||d(a)||f(a)||g.invert(a)},a.scale=function(c){return arguments.length?(g.scale(c),h.scale(0.6*c),m.scale(c),r.scale(1.5*c),a.translate(g.translate())):g.scale()},a.translate=function(l){if(!arguments.length)return g.translate();var p=
g.scale(),s=l[0],t=l[1];return g.translate(l),h.translate([s-0.4*p,t+0.17*p]),m.translate([s-0.19*p,t+0.2*p]),r.translate([s+0.58*p,t+0.43*p]),c=oc(h,[[-180,50],[-130,72]]),d=oc(m,[[-164,18],[-154,24]]),f=oc(r,[[-67.5,17.5],[-65,19]]),a},a.scale(1E3)};var Lb,rb,Aa={point:Z,lineStart:Z,lineEnd:Z,polygonStart:function(){rb=0;Aa.lineStart=Ef},polygonEnd:function(){Aa.lineStart=Aa.lineEnd=Aa.point=Z;Lb+=Math.abs(rb/2)}},ma={point:pc,lineStart:Od,lineEnd:Pd,polygonStart:function(){ma.lineStart=Gf},polygonEnd:function(){ma.point=
pc;ma.lineStart=Od;ma.lineEnd=Pd}};p.geo.path=function(){function a(e){return e&&p.geo.stream(e,f(g.pointRadius("function"==typeof h?+h.apply(this,arguments):h))),g.result()}var c,d,f,g,h=4.5;return a.area=function(a){return Lb=0,p.geo.stream(a,f(Aa)),Lb},a.centroid=function(a){return ba=X=Y=W=0,p.geo.stream(a,f(ma)),W?[X/W,Y/W]:void 0},a.bounds=function(a){return vd(f)(a)},a.projection=function(d){return arguments.length?(f=(c=d)?d.stream||If(d):ia,a):c},a.context=function(c){return arguments.length?
(g=null==(d=c)?new Ff:new Hf(c),a):d},a.pointRadius=function(c){return arguments.length?(h="function"==typeof c?c:+c,a):h},a.projection(p.geo.albersUsa()).context(null)};p.geo.albers=function(){return p.geo.conicEqualArea().parallels([29.5,45.5]).rotate([98,0]).center([0,38]).scale(1E3)};var Ye=Va(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(p.geo.azimuthalEqualArea=function(){return za(Ye)}).raw=Ye;var Ze=Va(function(a){return(a=Math.acos(a))&&a/Math.sin(a)},ia);
(p.geo.azimuthalEquidistant=function(){return za(Ze)}).raw=Ze;(p.geo.conicConformal=function(){return nc(Qd)}).raw=Qd;(p.geo.conicEquidistant=function(){return nc(Rd)}).raw=Rd;var $e=Va(function(a){return 1/a},Math.atan);(p.geo.gnomonic=function(){return za($e)}).raw=$e;sb.invert=function(a,c){return[a,2*Math.atan(Math.exp(c))-C/2]};(p.geo.mercator=function(){return Sd(sb)}).raw=sb;var af=Va(function(){return 1},Math.asin);(p.geo.orthographic=function(){return za(af)}).raw=af;var bf=Va(function(a){return 1/
(1+a)},function(a){return 2*Math.atan(a)});(p.geo.stereographic=function(){return za(bf)}).raw=bf;qc.invert=function(a,c){var d=Math.atan2((Math.exp(a)-Math.exp(-a))/2,Math.cos(c)),f;f=Math.sin(c)/((Math.exp(a)+Math.exp(-a))/2);f=1<f?C/2:-1>f?-C/2:Math.asin(f);return[d,f]};(p.geo.transverseMercator=function(){return Sd(qc)}).raw=qc;p.geom={};p.svg={};p.svg.line=function(){return Td(ia)};var rc=p.map({linear:ja,"linear-closed":function(a){return ja(a)+"Z"},"step-before":sc,"step-after":tc,basis:Ud,
"basis-open":function(a){if(4>a.length)return ja(a);for(var c,d=[],f=-1,g=a.length,h=[0],m=[0];3>++f;)c=a[f],h.push(c[0]),m.push(c[1]);d.push(oa(Oa,h)+","+oa(Oa,m));for(--f;++f<g;)c=a[f],h.shift(),h.push(c[0]),m.shift(),m.push(c[1]),Wa(d,h,m);return d.join("")},"basis-closed":function(a){for(var c,d,f=-1,g=a.length,h=g+4,m=[],r=[];4>++f;)d=a[f%g],m.push(d[0]),r.push(d[1]);c=[oa(Oa,m),",",oa(Oa,r)];for(--f;++f<h;)d=a[f%g],m.shift(),m.push(d[0]),r.shift(),r.push(d[1]),Wa(c,m,r);return c.join("")},bundle:function(a,
c){var d=a.length-1;if(d)for(var f,g,h=a[0][0],m=a[0][1],r=a[d][0]-h,l=a[d][1]-m,p=-1;++p<=d;)f=a[p],g=p/d,f[0]=c*f[0]+(1-c)*(h+g*r),f[1]=c*f[1]+(1-c)*(m+g*l);return Ud(a)},cardinal:function(a,c){return 3>a.length?ja(a):a[0]+tb(a,uc(a,c))},"cardinal-open":function(a,c){return 4>a.length?ja(a):a[1]+tb(a.slice(1,a.length-1),uc(a,c))},"cardinal-closed":function(a,c){return 3>a.length?ja(a):a[0]+tb((a.push(a[0]),a),uc([a[a.length-2]].concat(a,[a[1]]),c))},monotone:function(a){if(3>a.length)a=ja(a);else{var c=
a[0],d,f,g,h,m=[],r;d=0;r=a.length-1;for(var l=[],p=a[1],s=l[0]=vc(a[0],p);++d<r;)l[d]=(s+(s=vc(p,p=a[d+1])))/2;r=(l[d]=s,l);l=-1;for(p=a.length-1;++l<p;)d=vc(a[l],a[l+1]),1E-6>Math.abs(d)?r[l]=r[l+1]=0:(f=r[l]/d,g=r[l+1]/d,h=f*f+g*g,9<h&&(h=3*d/Math.sqrt(h),r[l]=h*f,r[l+1]=h*g));for(l=-1;++l<=p;)h=(a[Math.min(p,l+1)][0]-a[Math.max(0,l-1)][0])/(6*(1+r[l]*r[l])),m.push([h||0,r[l]*h||0]);a=c+tb(a,m)}return a}});rc.forEach(function(a,c){c.key=a;c.closed=/-closed$/.test(a)});var Vd=[0,2/3,1/3,0],Wd=[0,
1/3,2/3,0],Oa=[0,1/6,2/3,1/6];p.geom.hull=function(a){function c(a){if(3>a.length)return[];var e,g,h,m,l,u,p,s,t,E;s=O(d);t=O(f);E=a.length;var x=E-1,B=[],y=[],I=0;if(s===na&&f===ra)e=a;else for(h=0,e=[];E>h;++h)e.push([+s.call(this,g=a[h],h),+t.call(this,g,h)]);for(h=1;E>h;++h)e[h][1]<e[I][1]?I=h:e[h][1]==e[I][1]&&(I=e[h][0]<e[I][0]?h:I);for(h=0;E>h;++h)h!==I&&(l=e[h][1]-e[I][1],m=e[h][0]-e[I][0],B.push({angle:Math.atan2(l,m),index:h}));B.sort(function(a,e){return a.angle-e.angle});E=B[0].angle;
t=B[0].index;s=0;for(h=1;x>h;++h)g=B[h].index,E==B[h].angle?(m=e[t][0]-e[I][0],l=e[t][1]-e[I][1],u=e[g][0]-e[I][0],p=e[g][1]-e[I][1],m*m+l*l>=u*u+p*p?B[h].index=-1:(B[s].index=-1,E=B[h].angle,s=h,t=g)):(E=B[h].angle,s=h,t=g);y.push(I);for(g=h=0;2>h;++g)-1!==B[g].index&&(y.push(B[g].index),h++);for(m=y.length;x>g;++g)if(-1!==B[g].index){for(;!Jf(y[m-2],y[m-1],B[g].index,e);)--m;y[m++]=B[g].index}e=[];for(h=0;m>h;++h)e.push(a[y[h]]);return e}var d=na,f=ra;return arguments.length?c(a):(c.x=function(a){return arguments.length?
(d=a,c):d},c.y=function(a){return arguments.length?(f=a,c):f},c)};p.geom.polygon=function(a){return a.area=function(){for(var c=0,d=a.length,f=a[d-1][1]*a[0][0]-a[d-1][0]*a[0][1];++c<d;)f+=a[c-1][1]*a[c][0]-a[c-1][0]*a[c][1];return 0.5*f},a.centroid=function(c){var d,f,g=-1,h=a.length,m=0,r=0,l=a[h-1];for(arguments.length||(c=-1/(6*a.area()));++g<h;)d=l,l=a[g],f=d[0]*l[1]-l[0]*d[1],m+=(d[0]+l[0])*f,r+=(d[1]+l[1])*f;return[m*c,r*c]},a.clip=function(c){for(var d,f,g,h,m,r,l=-1,p=a.length,s=a[p-1];++l<
p;){d=c.slice();c.length=0;h=a[l];m=d[(g=d.length)-1];for(f=-1;++f<g;)r=d[f],wc(r,s,h)?(wc(m,s,h)||c.push(Xd(m,r,s,h)),c.push(r)):wc(m,s,h)&&c.push(Xd(m,r,s,h)),m=r;s=h}return c},a};p.geom.delaunay=function(a){var c=a.map(function(){return[]}),d=[];return xc(a,function(d){c[d.region.l.index].push(a[d.region.r.index])}),c.forEach(function(c,f){var g=a[f],h=g[0],m=g[1];c.forEach(function(a){a.angle=Math.atan2(a[0]-h,a[1]-m)});c.sort(function(a,e){return a.angle-e.angle});for(var l=0,u=c.length-1;u>
l;l++)d.push([g,c[l],c[l+1]])}),d};p.geom.voronoi=function(a){function c(a){var e,f,m,l=a.map(function(){return[]}),u=O(g),s=O(h),G=a.length;if(u===na&&s===ra)e=a;else for(e=[],m=0;G>m;++m)e.push([+u.call(this,f=a[m],m),+s.call(this,f,m)]);if(xc(e,function(a){var e,c,d,f,g,h;1===a.a&&0<=a.b?(e=a.ep.r,c=a.ep.l):(e=a.ep.l,c=a.ep.r);1===a.a?(g=e?e.y:-1E6,d=a.c-a.b*g,h=c?c.y:1E6,f=a.c-a.b*h):(d=e?e.x:-1E6,g=a.c-a.a*d,f=c?c.x:1E6,h=a.c-a.a*f);e=[d,g];f=[f,h];l[a.region.l.index].push(e,f);l[a.region.r.index].push(e,
f)}),l=l.map(function(a,c){var d=e[c][0],f=e[c][1],g=a.map(function(a){return Math.atan2(a[0]-d,a[1]-f)}),h=p.range(a.length).sort(function(a,e){return g[a]-g[e]});return h.filter(function(a,e){return!e||g[a]-g[h[e-1]]>N}).map(function(e){return a[e]})}),l.forEach(function(a,c){var d=a.length;if(!d)return a.push([-1E6,-1E6],[-1E6,1E6],[1E6,1E6],[1E6,-1E6]);if(!(2<d)){var f=e[c],g=a[0],h=a[1],d=f[0],f=f[1],n=g[0],g=g[1],m=h[0],q=h[1],l=Math.abs(m-n),h=q-g;Math.abs(h)<N?(d=g>f?-1E6:1E6,a.push([-1E6,
d],[1E6,d])):N>l?(d=n>d?-1E6:1E6,a.push([d,-1E6],[d,1E6])):(d=(n-d)*(q-g)>(m-n)*(g-f)?1E6:-1E6,f=Math.abs(h)-l,Math.abs(f)<N?a.push([0>h?d:-d,d]):(0<f&&(d*=-1),a.push([-1E6,d],[1E6,d])))}}),d)for(m=0;G>m;++m)d(l[m]);for(m=0;G>m;++m)l[m].point=a[m];return l}var d,f=null,g=na,h=ra;return arguments.length?c(a):(c.x=function(a){return arguments.length?(g=a,c):g},c.y=function(a){return arguments.length?(h=a,c):h},c.size=function(a){return arguments.length?(null==a?d=null:(f=[+a[0],+a[1]],d=p.geom.polygon([[0,
0],[0,f[1]],f,[f[0],0]]).clip),c):f},c.links=function(a){var e,c,d,f=a.map(function(){return[]}),n=[],m=O(g),l=O(h),u=a.length;if(m===na&&l===ra)e=a;else for(d=0;u>d;++d)e.push([+m.call(this,c=a[d],d),+l.call(this,c,d)]);return xc(e,function(e){var c=e.region.l.index;e=e.region.r.index;f[c][e]||(f[c][e]=f[e][c]=!0,n.push({source:a[c],target:a[e]}))}),n},c.triangles=function(a){if(g===na&&h===ra)return p.geom.delaunay(a);var e,c,d,f,n,m=O(g),l=O(h);f=0;e=[];for(n=a.length;n>f;++f)c=[+m.call(this,d=
a[f],f),+l.call(this,d,f)],c.data=d,e.push(c);return p.geom.delaunay(e).map(function(a){return a.map(function(a){return a.data})})},c)};var yc={l:"r",r:"l"};p.geom.quadtree=function(a,c,d,f,g){function h(a){function e(a,c,d,f,g,h,n,m){if(!isNaN(d)&&!isNaN(f))if(a.leaf){var l=a.x,r=a.y;if(null!=l){if(!(0.01>Math.abs(l-d)+Math.abs(r-f))){var p=a.point;a.x=a.y=a.point=null;q(a,p,l,r,g,h,n,m)}q(a,c,d,f,g,h,n,m)}else a.x=d,a.y=f,a.point=c}else q(a,c,d,f,g,h,n,m)}function q(a,c,d,f,g,h,n,m){var l=0.5*(g+
n),r=0.5*(h+m),p=d>=l,u=f>=r,s=(u<<1)+p;a.leaf=!1;a=a.nodes[s]||(a.nodes[s]=Yd());p?g=l:n=l;u?h=r:m=r;e(a,c,d,f,g,h,n,m)}var s,t,E,x,B,y,I,M,v,z=O(l),w=O(p);if(null!=c)y=c,I=d,M=f,v=g;else if(M=v=-(y=I=1/0),t=[],E=[],B=a.length,m)for(x=0;B>x;++x)s=a[x],s.x<y&&(y=s.x),s.y<I&&(I=s.y),s.x>M&&(M=s.x),s.y>v&&(v=s.y),t.push(s.x),E.push(s.y);else for(x=0;B>x;++x){var V=+z(s=a[x],x);s=+w(s,x);y>V&&(y=V);I>s&&(I=s);V>M&&(M=V);s>v&&(v=s);t.push(V);E.push(s)}V=M-y;s=v-I;V>s?v=I+V:M=y+s;var C=Yd();if(C.add=function(a){e(C,
a,+z(a,++x),+w(a,x),y,I,M,v)},C.visit=function(a){Xa(a,C,y,I,M,v)},x=-1,null==c){for(;++x<B;)e(C,a[x],t[x],E[x],y,I,M,v);--x}else a.forEach(C.add);return t=E=a=s=null,C}var m,l=na,p=ra;return(m=arguments.length)?(l=Kf,p=Lf,3===m&&(g=d,f=c,d=c=0),h(a)):(h.x=function(a){return arguments.length?(l=a,h):l},h.y=function(a){return arguments.length?(p=a,h):p},h.size=function(a){return arguments.length?(null==a?c=d=f=g=null:(c=d=0,f=+a[0],g=+a[1]),h):null==c?null:[f,g]},h)};p.interpolateRgb=zc;p.transform=
function(a){var c=ga.createElementNS(p.ns.prefix.svg,"g");return(p.transform=function(a){c.setAttribute("transform",a);a=c.transform.baseVal.consolidate();return new Zd(a?a.matrix:Vg)})(a)};Zd.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Vg={a:1,b:0,c:0,d:1,e:0,f:0};p.interpolateNumber=sa;p.interpolateTransform=ub;p.interpolateObject=ae;p.interpolateString=be;var vb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;
p.interpolate=Da;p.interpolators=[function(a,c){var d=typeof c;return("string"===d||d!==typeof a?fb.has(c)||/^(#|rgb\(|hsl\()/.test(c)?zc:be:c instanceof Ia?zc:"object"===d?Array.isArray(c)?ce:ae:sa)(a,c)}];p.interpolateArray=ce;var cf=function(){return ia},Wg=p.map({linear:cf,poly:function(a){return function(c){return Math.pow(c,a)}},quad:function(){return Nf},cubic:function(){return Of},sin:function(){return Pf},exp:function(){return Qf},circle:function(){return Rf},elastic:function(a,c){var d;
return 2>arguments.length&&(c=0.45),arguments.length?d=c/(2*C)*Math.asin(1/a):(a=1,d=c/4),function(f){return 1+a*Math.pow(2,10*-f)*Math.sin(2*(f-d)*C/c)}},back:function(a){return a||(a=1.70158),function(c){return c*c*((a+1)*c-a)}},bounce:function(){return Sf}}),Xg=p.map({"in":ia,out:de,"in-out":ee,"out-in":function(a){return ee(de(a))}});p.ease=function(a){var c=a.indexOf("-"),d=0<=c?a.substring(0,c):a,c=0<=c?a.substring(c+1):"in";return d=Wg.get(d)||cf,c=Xg.get(c)||ia,Mf(c(d.apply(null,Array.prototype.slice.call(arguments,
1))))};p.interpolateHcl=function(a,c){a=p.hcl(a);c=p.hcl(c);var d=a.h,f=a.c,g=a.l,h=c.h-d,m=c.c-f,l=c.l-g;return 180<h?h-=360:-180>h&&(h+=360),function(a){return Tb(d+h*a,f+m*a,g+l*a)+""}};p.interpolateHsl=function(a,c){a=p.hsl(a);c=p.hsl(c);var d=a.h,f=a.s,g=a.l,h=c.h-d,m=c.s-f,l=c.l-g;return 180<h?h-=360:-180>h&&(h+=360),function(a){return cb(d+h*a,f+m*a,g+l*a)+""}};p.interpolateLab=function(a,c){a=p.lab(a);c=p.lab(c);var d=a.l,f=a.a,g=a.b,h=c.l-d,m=c.a-f,l=c.b-g;return function(a){return kd(d+
h*a,f+m*a,g+l*a)+""}};p.interpolateRound=fe;p.layout={};p.layout.bundle=function(){return function(a){for(var c=[],d=-1,f=a.length;++d<f;)c.push(Vf(a[d]));return c}};p.layout.chord=function(){function a(){var e,t,Rb,E,x,B={},y=[],I=p.range(h),M=[];d=[];f=[];e=0;for(E=-1;++E<h;){t=0;for(x=-1;++x<h;)t+=g[E][x];y.push(t);M.push(p.range(h));e+=t}m&&I.sort(function(a,c){return m(y[a],y[c])});l&&M.forEach(function(a,c){a.sort(function(a,e){return l(g[c][a],g[c][e])})});e=(2*C-v*h)/e;t=0;for(E=-1;++E<h;){Rb=
t;for(x=-1;++x<h;){var P=I[E],z=M[P][x],w=g[P][z],V=t,H=t+=w*e;B[P+"-"+z]={index:P,subindex:z,startAngle:V,endAngle:H,value:w}}f[P]={index:P,startAngle:Rb,endAngle:t,value:(t-Rb)/e};t+=v}for(E=-1;++E<h;)for(x=E-1;++x<h;)e=B[E+"-"+x],t=B[x+"-"+E],(e.value||t.value)&&d.push(e.value<t.value?{source:t,target:e}:{source:e,target:t});s&&c()}function c(){d.sort(function(a,c){return s((a.source.value+a.target.value)/2,(c.source.value+c.target.value)/2)})}var d,f,g,h,m,l,s,t={},v=0;return t.matrix=function(a){return arguments.length?
(h=(g=a)&&g.length,d=f=null,t):g},t.padding=function(a){return arguments.length?(v=a,d=f=null,t):v},t.sortGroups=function(a){return arguments.length?(m=a,d=f=null,t):m},t.sortSubgroups=function(a){return arguments.length?(l=a,d=null,t):l},t.sortChords=function(a){return arguments.length?(s=a,d&&c(),t):s},t.chords=function(){return d||a(),d},t.groups=function(){return f||a(),f},t};p.layout.force=function(){function a(c){return function(a,e,d,f){if(a.point!==c){d=a.cx-c.x;var g=a.cy-c.y,h=1/Math.sqrt(d*
d+g*g);if(x>(f-e)*h)return e=a.charge*h*h,c.px-=d*e,c.py-=g*e,!0;a.point&&isFinite(h)&&(e=a.pointCharge*h*h,c.px-=d*e,c.py-=g*e)}return!a.charge}}function c(a){a.px=p.event.x;a.py=p.event.y;l.resume()}var d,f,g,h,m,l={},s=p.dispatch("start","tick","end"),t=[1,1],v=0.9,U=Yg,F=Zg,z=-30,E=0.1,x=0.8,B=[],y=[];return l.tick=function(){if(0.005>(f*=0.99))return s.end({type:"end",alpha:f=0}),!0;var c,d,n,l,r,u,x,F,U=B.length,w=y.length;for(d=0;w>d;++d)n=y[d],c=n.source,l=n.target,x=l.x-c.x,F=l.y-c.y,(r=
x*x+F*F)&&(r=f*h[d]*((r=Math.sqrt(r))-g[d])/r,x*=r,F*=r,l.x-=x*(u=c.weight/(l.weight+c.weight)),l.y-=F*u,c.x+=x*(u=1-u),c.y+=F*u);if((u=f*E)&&(x=t[0]/2,F=t[1]/2,d=-1,u))for(;++d<U;)n=B[d],n.x+=(x-n.x)*u,n.y+=(F-n.y)*u;if(z)for(he(c=p.geom.quadtree(B),f,m),d=-1;++d<U;)(n=B[d]).fixed||c.visit(a(n));for(d=-1;++d<U;)n=B[d],n.fixed?(n.x=n.px,n.y=n.py):(n.x-=(n.px-(n.px=n.x))*v,n.y-=(n.py-(n.py=n.y))*v);s.tick({type:"tick",alpha:f})},l.nodes=function(a){return arguments.length?(B=a,l):B},l.links=function(a){return arguments.length?
(y=a,l):y},l.size=function(a){return arguments.length?(t=a,l):t},l.linkDistance=function(a){return arguments.length?(U="function"==typeof a?a:+a,l):U},l.distance=l.linkDistance,l.linkStrength=function(a){return arguments.length?(F="function"==typeof a?a:+a,l):F},l.friction=function(a){return arguments.length?(v=+a,l):v},l.charge=function(a){return arguments.length?(z="function"==typeof a?a:+a,l):z},l.gravity=function(a){return arguments.length?(E=+a,l):E},l.theta=function(a){return arguments.length?
(x=+a,l):x},l.alpha=function(a){return arguments.length?(a=+a,f?f=0<a?a:0:0<a&&(s.start({type:"start",alpha:f=a}),p.timer(l.tick)),l):f},l.start=function(){function a(f,g){var h,m;if(!d){d=[];for(e=0;n>e;++e)d[e]=[];for(e=0;p>e;++e)h=y[e],d[h.source.index].push(h.target),d[h.target.index].push(h.source)}m=d[c];for(var l=-1,q=m.length;++l<q;)if(!isNaN(h=m[l][f]))return h;return Math.random()*g}var c,e,d,f,n=B.length,p=y.length,u=t[0],s=t[1];for(c=0;n>c;++c)(f=B[c]).index=c,f.weight=0;for(c=0;p>c;++c)f=
y[c],"number"==typeof f.source&&(f.source=B[f.source]),"number"==typeof f.target&&(f.target=B[f.target]),++f.source.weight,++f.target.weight;for(c=0;n>c;++c)f=B[c],isNaN(f.x)&&(f.x=a("x",u)),isNaN(f.y)&&(f.y=a("y",s)),isNaN(f.px)&&(f.px=f.x),isNaN(f.py)&&(f.py=f.y);if(g=[],"function"==typeof U)for(c=0;p>c;++c)g[c]=+U.call(this,y[c],c);else for(c=0;p>c;++c)g[c]=U;if(h=[],"function"==typeof F)for(c=0;p>c;++c)h[c]=+F.call(this,y[c],c);else for(c=0;p>c;++c)h[c]=F;if(m=[],"function"==typeof z)for(c=0;n>
c;++c)m[c]=+z.call(this,B[c],c);else for(c=0;n>c;++c)m[c]=z;return l.resume()},l.resume=function(){return l.alpha(0.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return d||(d=p.behavior.drag().origin(ia).on("dragstart.force",Wf).on("drag.force",c).on("dragend.force",Xf)),arguments.length?(this.on("mouseover.force",Yf).on("mouseout.force",Zf).call(d),void 0):d},p.rebind(l,s,"on")};var Yg=20,Zg=1;p.layout.hierarchy=function(){function a(c,m,l){var p=g.call(d,c,m);if(c.depth=m,l.push(c),
p&&(u=p.length)){for(var u,s=-1,t=c.children=[],v=0,E=m+1;++s<u;)m=a(p[s],E,l),m.parent=c,t.push(m),v+=m.value;f&&t.sort(f);h&&(c.value=v)}else h&&(c.value=+h.call(d,c,m)||0);return c}function c(a,e){var f=a.children,g=0;if(f&&(m=f.length))for(var m,l=-1,p=e+1;++l<m;)g+=c(f[l],p);else h&&(g=+h.call(d,a,e)||0);return h&&(a.value=g),g}function d(c){var f=[];return a(c,0,f),f}var f=cg,g=ag,h=bg;return d.sort=function(a){return arguments.length?(f=a,d):f},d.children=function(a){return arguments.length?
(g=a,d):g},d.value=function(a){return arguments.length?(h=a,d):h},d.revalue=function(a){return c(a,0),a},d};p.layout.partition=function(){function a(c,d,f,g){var h=c.children;if(c.x=d,c.y=c.depth*g,c.dx=f,c.dy=g,h&&(n=h.length)){var n,m,l=-1;for(f=c.value?f/c.value:0;++l<n;)a(m=h[l],d,c=m.value*f,g),d+=c}}function c(a){a=a.children;var e=0;if(a&&(d=a.length))for(var d,f=-1;++f<d;)e=Math.max(e,c(a[f]));return 1+e}function d(h,n){var m=f.call(this,h,n);return a(m[0],0,g[0],g[1]/c(m[0])),m}var f=p.layout.hierarchy(),
g=[1,1];return d.size=function(a){return arguments.length?(g=a,d):g},Ya(d,f)};p.layout.pie=function(){function a(h){var m=h.map(function(d,f){return+c.call(a,d,f)}),l=+("function"==typeof f?f.apply(this,arguments):f),s=(("function"==typeof g?g.apply(this,arguments):g)-l)/p.sum(m),t=p.range(h.length);null!=d&&t.sort(d===df?function(a,c){return m[c]-m[a]}:function(a,c){return d(h[a],h[c])});var v=[];return t.forEach(function(a){var c;v[a]={data:h[a],value:c=m[a],startAngle:l,endAngle:l+=c*s}}),v}var c=
Number,d=df,f=0,g=2*C;return a.value=function(d){return arguments.length?(c=d,a):c},a.sort=function(c){return arguments.length?(d=c,a):d},a.startAngle=function(c){return arguments.length?(f=c,a):f},a.endAngle=function(c){return arguments.length?(g=c,a):g},a};var df={};p.layout.stack=function(){function a(l,s){var t=l.map(function(d,f){return c.call(a,d,f)}),v=t.map(function(c){return c.map(function(c,d){return[h.call(a,c,d),m.call(a,c,d)]})}),z=d.call(a,v,s),t=p.permute(t,z),v=p.permute(v,z),F,w,
E=f.call(a,v,s),x=t.length,B=t[0].length;for(F=0;B>F;++F)for(g.call(a,t[0][F],w=E[F],v[0][F][1]),z=1;x>z;++z)g.call(a,t[z][F],w+=v[z-1][F][1],v[z][F][1]);return l}var c=ia,d=Ac,f=Bc,g=fg,h=dg,m=eg;return a.values=function(d){return arguments.length?(c=d,a):c},a.order=function(c){return arguments.length?(d="function"==typeof c?c:$g.get(c)||Ac,a):d},a.offset=function(c){return arguments.length?(f="function"==typeof c?c:ah.get(c)||Bc,a):f},a.x=function(c){return arguments.length?(h=c,a):h},a.y=function(c){return arguments.length?
(m=c,a):m},a.out=function(c){return arguments.length?(g=c,a):g},a};var $g=p.map({"inside-out":function(a){var c,d=a.length,f=a.map(gg),g=a.map(hg),h=p.range(d).sort(function(a,c){return f[a]-f[c]}),m=0,l=0,s=[],t=[];for(a=0;d>a;++a)c=h[a],l>m?(m+=g[c],s.push(c)):(l+=g[c],t.push(c));return t.reverse().concat(s)},reverse:function(a){return p.range(a.length).reverse()},"default":Ac}),ah=p.map({silhouette:function(a){var c,d,f,g=a.length,h=a[0].length,m=[],l=0,p=[];for(d=0;h>d;++d){for(f=c=0;g>c;c++)f+=
a[c][d][1];f>l&&(l=f);m.push(f)}for(d=0;h>d;++d)p[d]=(l-m[d])/2;return p},wiggle:function(a){var c,d,f,g,h,m,l,p,s,t=a.length,v=a[0],F=v.length,z=[];z[0]=p=s=0;for(d=1;F>d;++d){for(g=c=0;t>c;++c)g+=a[c][d][1];h=c=0;for(l=v[d][0]-v[d-1][0];t>c;++c){f=0;for(m=(a[c][d][1]-a[c][d-1][1])/(2*l);c>f;++f)m+=(a[f][d][1]-a[f][d-1][1])/l;h+=m*a[c][d][1]}z[d]=p-=g?h/g*l:0;s>p&&(s=p)}for(d=0;F>d;++d)z[d]-=s;return z},expand:function(a){var c,d,f,g=a.length,h=a[0].length,m=1/g,l=[];for(d=0;h>d;++d){for(f=c=0;g>
c;c++)f+=a[c][d][1];if(f)for(c=0;g>c;c++)a[c][d][1]/=f;else for(c=0;g>c;c++)a[c][d][1]=m}for(d=0;h>d;++d)l[d]=0;return l},zero:Bc});p.layout.histogram=function(){function a(e,h){var m,l,s=[],t=e.map(d,this),v=f.call(this,t,h),F=g.call(this,v,t,h);h=-1;for(var z=t.length,E=F.length-1,x=c?1:1/z;++h<E;)m=s[h]=[],m.dx=F[h+1]-(m.x=F[h]),m.y=0;if(0<E)for(h=-1;++h<z;)l=t[h],l>=v[0]&&l<=v[1]&&(m=s[p.bisect(F,l,1,E)-1],m.y+=x,m.push(e[h]));return s}var c=!0,d=Number,f=kg,g=jg;return a.value=function(c){return arguments.length?
(d=c,a):d},a.range=function(c){return arguments.length?(f=O(c),a):f},a.bins=function(c){return arguments.length?(g="number"==typeof c?function(a){return ie(a,c)}:O(c),a):g},a.frequency=function(d){return arguments.length?(c=!!d,a):c},a};p.layout.tree=function(){function a(e,g){function h(a,c){var e=a.children,f=a._tree;if(e&&(g=e.length)){for(var g,m,l,p=e[0],q=p,r=-1;++r<g;){l=e[r];h(l,m);var u=l;if(m){for(var s=void 0,t=u,A=u,E=u.parent.children[0],G=t._tree.mod,v=A._tree.mod,x=m._tree.mod,F=E._tree.mod;m=
Dc(m),t=Cc(t),m&&t;){E=Cc(E);A=Dc(A);A._tree.ancestor=u;s=m._tree.prelim+x-t._tree.prelim-G+d(m,t);if(0<s){var z=m._tree.ancestor.parent==u.parent?m._tree.ancestor:q,S=u,w=s,z=z._tree,S=S._tree,va=w/(S.number-z.number);z.change+=va;S.change-=va;S.shift+=w;S.prelim+=w;S.mod+=w;G+=s;v+=s}x+=m._tree.mod;G+=t._tree.mod;F+=E._tree.mod;v+=A._tree.mod}m&&!Dc(A)&&(A._tree.thread=m,A._tree.mod+=x-v);t&&!Cc(E)&&(E._tree.thread=t,E._tree.mod+=G-F,q=u)}m=l}r=g=0;u=a.children;for(q=u.length;0<=--q;)e=u[q]._tree,
e.prelim+=g,e.mod+=g,g+=e.shift+(r+=e.change);l=0.5*(p._tree.prelim+l._tree.prelim);c?(f.prelim=c._tree.prelim+d(a,c),f.mod=f.prelim-l):f.prelim=l}else c&&(f.prelim=c._tree.prelim+d(a,c))}function m(a,c){a.x=a._tree.prelim+c;var e=a.children;if(e&&(d=e.length)){var d,f=-1;for(c+=a._tree.mod;++f<d;)m(e[f],c)}}var l=c.call(this,e,g),p=l[0];ta(p,function(a,c){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:c?c._tree.number+1:0}});h(p);m(p,-p._tree.prelim);var s=wb(p,mg),t=wb(p,lg),v=wb(p,
ng),z=s.x-d(s,t)/2,E=t.x+d(t,s)/2,x=v.depth||1;return ta(p,function(a){a.x=(a.x-z)/(E-z)*f[0];a.y=a.depth/x*f[1];delete a._tree}),l}var c=p.layout.hierarchy().sort(null).value(null),d=je,f=[1,1];return a.separation=function(c){return arguments.length?(d=c,a):d},a.size=function(c){return arguments.length?(f=c,a):f},Ya(a,c)};p.layout.pack=function(){function a(e,g){var h=c.call(this,e,g),m=h[0];m.x=0;m.y=0;ta(m,function(a){a.r=Math.sqrt(a.value)});ta(m,me);var l=f[0],p=f[1],s=Math.max(2*m.r/l,2*m.r/
p);if(0<d){var t=d*s/2;ta(m,function(a){a.r+=t});ta(m,me);ta(m,function(a){a.r-=t});s=Math.max(2*m.r/l,2*m.r/p)}return oe(m,l/2,p/2,1/s),h}var c=p.layout.hierarchy().sort(og),d=0,f=[1,1];return a.size=function(c){return arguments.length?(f=c,a):f},a.padding=function(c){return arguments.length?(d=+c,a):d},Ya(a,c)};p.layout.cluster=function(){function a(e,g){var h,m=c.call(this,e,g),l=m[0],p=0;ta(l,function(a){var c=a.children;c&&c.length?(a.x=sg(c),a.y=rg(c)):(a.x=h?p+=d(a,h):0,a.y=0,h=a)});var s=
pe(l),t=qe(l),v=s.x-d(s,t)/2,z=t.x+d(t,s)/2;return ta(l,function(a){a.x=(a.x-v)/(z-v)*f[0];a.y=(1-(l.y?a.y/l.y:1))*f[1]}),m}var c=p.layout.hierarchy().sort(null).value(null),d=je,f=[1,1];return a.separation=function(c){return arguments.length?(d=c,a):d},a.size=function(c){return arguments.length?(f=c,a):f},Ya(a,c)};p.layout.treemap=function(){function a(c,e){for(var d,f,g=-1,h=c.length;++g<h;)f=(d=c[g]).value*(0>e?0:e),d.area=isNaN(f)||0>=f?0:f}function c(d){var g=d.children;if(g&&g.length){var h,
m=v(d),n=[],l=g.slice(),p=1/0,q="slice"===F?m.dx:"dice"===F?m.dy:"slice-dice"===F?d.depth&1?m.dy:m.dx:Math.min(m.dx,m.dy);a(l,m.dx*m.dy/d.value);for(n.area=0;0<(d=l.length);){n.push(d=l[d-1]);n.area+=d.area;var r;if(!(r="squarify"!==F)){d=q;h=void 0;var s=n.area;r=0;for(var t=1/0,A=-1,D=n.length;++A<D;)(h=n[A].area)&&(t>h&&(t=h),h>r&&(r=h));r=(h=(s*=s,d*=d,s?Math.max(d*r*w/s,s/(d*t*w)):1/0))<=p}r?(l.pop(),p=h):(n.area-=n.pop().area,f(n,q,m,!1),q=Math.min(m.dx,m.dy),n.length=n.area=0,p=1/0)}n.length&&
(f(n,q,m,!0),n.length=n.area=0);g.forEach(c)}}function d(c){var g=c.children;if(g&&g.length){var h=v(c),m=g.slice(),l=[];a(m,h.dx*h.dy/c.value);for(l.area=0;c=m.pop();)l.push(c),l.area+=c.area,null!=c.z&&(f(l,c.z?h.dx:h.dy,h,!m.length),l.length=l.area=0);g.forEach(d)}}function f(a,c,e,d){var g,h=-1,m=a.length,n=e.x,p=e.y,q=c?l(a.area/c):0;if(c==e.dx){for((d||q>e.dy)&&(q=e.dy);++h<m;)g=a[h],g.x=n,g.y=p,g.dy=q,n+=g.dx=Math.min(e.x+e.dx-n,q?l(g.area/q):0);g.z=!0;g.dx+=e.x+e.dx-n;e.y+=q;e.dy-=q}else{for((d||
q>e.dx)&&(q=e.dx);++h<m;)g=a[h],g.x=n,g.y=p,g.dx=q,p+=g.dy=Math.min(e.y+e.dy-p,q?l(g.area/q):0);g.z=!1;g.dy+=e.y+e.dy-p;e.x+=q;e.dx-=q}}function g(f){f=h||m(f);var l=f[0];return l.x=0,l.y=0,l.dx=s[0],l.dy=s[1],h&&m.revalue(l),a([l],l.dx*l.dy/l.value),(h?d:c)(l),z&&(h=f),f}var h,m=p.layout.hierarchy(),l=Math.round,s=[1,1],t=null,v=Fc,z=!1,F="squarify",w=0.5*(1+Math.sqrt(5));return g.size=function(a){return arguments.length?(s=a,g):s},g.padding=function(a){function c(e){var d=a.call(g,e,e.depth);return null==
d?Fc(e):re(e,"number"==typeof d?[d,d,d,d]:d)}function e(c){return re(c,a)}if(!arguments.length)return t;var d;return v=null==(t=a)?Fc:"function"==(d=typeof a)?c:"number"===d?(a=[a,a,a,a],e):e,g},g.round=function(a){return arguments.length?(l=a?Math.round:Number,g):l!=Number},g.sticky=function(a){return arguments.length?(z=a,h=null,g):z},g.ratio=function(a){return arguments.length?(w=a,g):w},g.mode=function(a){return arguments.length?(F=a+"",g):F},Ya(g,m)};p.random={normal:function(a,c){var d=arguments.length;
return 2>d&&(c=1),1>d&&(a=0),function(){var d,f;do d=2*Math.random()-1,f=2*Math.random()-1,f=d*d+f*f;while(!f||1<f);return a+c*d*Math.sqrt(-2*Math.log(f)/f)}},logNormal:function(){var a=p.random.normal.apply(p,arguments);return function(){return Math.exp(a())}},irwinHall:function(a){return function(){for(var c=0,d=0;a>d;d++)c+=Math.random();return c/a}}};p.scale={};p.scale.linear=function(){return se([0,1],[0,1],Da,!1)};p.scale.log=function(){return xe(p.scale.linear().domain([0,Math.LN10]),10,ye,
ze)};var xg=p.format(".0e");p.scale.pow=function(){return Ae(p.scale.linear(),1)};p.scale.sqrt=function(){return p.scale.pow().exponent(0.5)};p.scale.ordinal=function(){return Be([],{t:"range",a:[[]]})};p.scale.category10=function(){return p.scale.ordinal().range(bh)};p.scale.category20=function(){return p.scale.ordinal().range(ch)};p.scale.category20b=function(){return p.scale.ordinal().range(dh)};p.scale.category20c=function(){return p.scale.ordinal().range(eh)};var bh="#1f77b4 #ff7f0e #2ca02c #d62728 #9467bd #8c564b #e377c2 #7f7f7f #bcbd22 #17becf".split(" "),
ch="#1f77b4 #aec7e8 #ff7f0e #ffbb78 #2ca02c #98df8a #d62728 #ff9896 #9467bd #c5b0d5 #8c564b #c49c94 #e377c2 #f7b6d2 #7f7f7f #c7c7c7 #bcbd22 #dbdb8d #17becf #9edae5".split(" "),dh="#393b79 #5254a3 #6b6ecf #9c9ede #637939 #8ca252 #b5cf6b #cedb9c #8c6d31 #bd9e39 #e7ba52 #e7cb94 #843c39 #ad494a #d6616b #e7969c #7b4173 #a55194 #ce6dbd #de9ed6".split(" "),eh="#3182bd #6baed6 #9ecae1 #c6dbef #e6550d #fd8d3c #fdae6b #fdd0a2 #31a354 #74c476 #a1d99b #c7e9c0 #756bb1 #9e9ac8 #bcbddc #dadaeb #636363 #969696 #bdbdbd #d9d9d9".split(" ");
p.scale.quantile=function(){return Ce([],[])};p.scale.quantize=function(){return De(0,1,[0,1])};p.scale.threshold=function(){return Ee([0.5],[0,1])};p.scale.identity=function(){return Fe([0,1])};p.svg.arc=function(){function a(){var e=c.apply(this,arguments),h=d.apply(this,arguments),m=f.apply(this,arguments)+Ea,l=g.apply(this,arguments)+Ea,p=(m>l&&(p=m,m=l,l=p),l-m),s=C>p?"0":"1",t=Math.cos(m),m=Math.sin(m),v=Math.cos(l),l=Math.sin(l);return p>=fh?e?"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+
" 0 1,1 0,"+h+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":e?"M"+h*t+","+h*m+"A"+h+","+h+" 0 "+s+",1 "+h*v+","+h*l+"L"+e*v+","+e*l+"A"+e+","+e+" 0 "+s+",0 "+e*t+","+e*m+"Z":"M"+h*t+","+h*m+"A"+h+","+h+" 0 "+s+",1 "+h*v+","+h*l+"L0,0Z"}var c=yg,d=zg,f=Ge,g=He;return a.innerRadius=function(d){return arguments.length?(c=O(d),a):c},a.outerRadius=function(c){return arguments.length?(d=O(c),a):d},a.startAngle=function(c){return arguments.length?
(f=O(c),a):f},a.endAngle=function(c){return arguments.length?(g=O(c),a):g},a.centroid=function(){var a=(c.apply(this,arguments)+d.apply(this,arguments))/2,e=(f.apply(this,arguments)+g.apply(this,arguments))/2+Ea;return[Math.cos(e)*a,Math.sin(e)*a]},a};var Ea=-C/2,fh=2*C-1E-6;p.svg.line.radial=function(){var a=Td(Ie);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};sc.reverse=tc;tc.reverse=sc;p.svg.area=function(){return Je(ia)};p.svg.area.radial=function(){var a=Je(Ie);return a.radius=a.x,
delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};p.svg.chord=function(){function a(e,g){var h=c(this,d,e,g),m=c(this,f,e,g);return"M"+h.p0+("A"+h.r+","+h.r+" 0 "+ +(h.a1-h.a0>C)+",1 "+h.p1)+(h.a0==m.a0&&h.a1==m.a1?"Q 0,0 "+h.p0:"Q 0,0 "+m.p0+("A"+m.r+","+m.r+" 0 "+ +(m.a1-m.a0>C)+",1 "+m.p1)+("Q 0,0 "+h.p0))+"Z"}function c(a,e,d,f){var l=e.call(a,d,f);e=g.call(a,l,f);d=h.call(a,l,f)+Ea;a=m.call(a,
l,f)+Ea;return{r:e,a0:d,a1:a,p0:[e*Math.cos(d),e*Math.sin(d)],p1:[e*Math.cos(a),e*Math.sin(a)]}}var d=lc,f=mc,g=Ag,h=Ge,m=He;return a.radius=function(c){return arguments.length?(g=O(c),a):g},a.source=function(c){return arguments.length?(d=O(c),a):d},a.target=function(c){return arguments.length?(f=O(c),a):f},a.startAngle=function(c){return arguments.length?(h=O(c),a):h},a.endAngle=function(c){return arguments.length?(m=O(c),a):m},a};p.svg.diagonal=function(){function a(e,g){var h=c.call(this,e,g),
m=d.call(this,e,g),l=(h.y+m.y)/2,h=[h,{x:h.x,y:l},{x:m.x,y:l},m];return h=h.map(f),"M"+h[0]+"C"+h[1]+" "+h[2]+" "+h[3]}var c=lc,d=mc,f=Ke;return a.source=function(d){return arguments.length?(c=O(d),a):c},a.target=function(c){return arguments.length?(d=O(c),a):d},a.projection=function(c){return arguments.length?(f=c,a):f},a};p.svg.diagonal.radial=function(){var a=p.svg.diagonal(),c=Ke,d=a.projection;return a.projection=function(a){return arguments.length?d(Bg(c=a)):c},a};p.svg.symbol=function(){function a(e,
f){return(ef.get(c.call(this,e,f))||Le)(d.call(this,e,f))}var c=Dg,d=Cg;return a.type=function(d){return arguments.length?(c=O(d),a):c},a.size=function(c){return arguments.length?(d=O(c),a):d},a};var ef=p.map({circle:Le,cross:function(a){a=Math.sqrt(a/5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*ff));var c=a*ff;return"M0,"+-a+"L"+c+",0 0,"+a+" "+-c+",0Z"},square:function(a){a=Math.sqrt(a)/2;return"M"+
-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/Mb);var c=a*Mb/2;return"M0,"+c+"L"+a+","+-c+" "+-a+","+-c+"Z"},"triangle-up":function(a){a=Math.sqrt(a/Mb);var c=a*Mb/2;return"M0,"+-c+"L"+a+","+c+" "+-a+","+c+"Z"}});p.svg.symbolTypes=ef.keys();var bb,Mb=Math.sqrt(3),ff=Math.tan(30*J),aa=[],Ve=0,Fb={ease:function(a){if(0>=a)return 0;if(1<=a)return 1;var c=a*a,d=c*a;return 4*(0.5>a?d:3*(a-c)+d-0.75)},delay:0,duration:250};aa.call=L.call;aa.empty=L.empty;
aa.node=L.node;p.transition=function(a){return arguments.length?bb?a.transition():a:ab.transition()};p.transition.prototype=aa;aa.select=function(a){var c,d,f,g=this.id,h=[];"function"!=typeof a&&(a=H(a));for(var m=-1,l=this.length;++m<l;){h.push(c=[]);for(var p=this[m],s=-1,t=p.length;++s<t;)(f=p[s])&&(d=a.call(f,f.__data__,s))?("__data__"in f&&(d.__data__=f.__data__),Ab(d,s,g,f.__transition__[g]),c.push(d)):c.push(null)}return $a(h,g)};aa.selectAll=function(a){var c,d,f,g,h=this.id,m=[];"function"!=
typeof a&&(a=R(a));for(var l=-1,p=this.length;++l<p;)for(var s=this[l],t=-1,v=s.length;++t<v;)if(c=s[t]){g=c.__transition__[h];d=a.call(c,c.__data__,t);m.push(c=[]);for(var z=-1,w=d.length;++z<w;)Ab(f=d[z],z,h,g),c.push(f)}return $a(m,h)};aa.filter=function(a){var c,d,f,g=[];"function"!=typeof a&&(a=dd(a));for(var h=0,m=this.length;m>h;h++){g.push(c=[]);d=this[h];for(var l=0,p=d.length;p>l;l++)(f=d[l])&&a.call(f,f.__data__,l)&&c.push(f)}return $a(g,this.id,this.time).ease(this.ease())};aa.tween=function(a,
c){var d=this.id;return 2>arguments.length?this.node().__transition__[d].tween.get(a):xa(this,null==c?function(c){c.__transition__[d].tween.remove(a)}:function(f){f.__transition__[d].tween.set(a,c)})};aa.attr=function(a,c){function d(){this.removeAttribute(h)}function f(){this.removeAttributeNS(h.space,h.local)}if(2>arguments.length){for(c in a)this.attr(c,a[c]);return this}var g="transform"==a?ub:Da,h=p.ns.qualify(a);return Jc(this,"attr."+a,c,function(a){function c(){var e,d=this.getAttribute(h);
return d!==a&&(e=g(d,a),function(a){this.setAttribute(h,e(a))})}function e(){var c,d=this.getAttributeNS(h.space,h.local);return d!==a&&(c=g(d,a),function(a){this.setAttributeNS(h.space,h.local,c(a))})}return null==a?h.local?f:d:(a+="",h.local?e:c)})};aa.attrTween=function(a,c){function d(a,e){var f=c.call(this,a,e,this.getAttribute(g));return f&&function(a){this.setAttribute(g,f(a))}}function f(a,e){var d=c.call(this,a,e,this.getAttributeNS(g.space,g.local));return d&&function(a){this.setAttributeNS(g.space,
g.local,d(a))}}var g=p.ns.qualify(a);return this.tween("attr."+a,g.local?f:d)};aa.style=function(a,c,d){function f(){this.style.removeProperty(a)}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(c="");for(d in a)this.style(d,a[d],c);return this}d=""}var h="transform"==a?ub:Da;return Jc(this,"style."+a,c,function(c){function g(){var f,m=ca.getComputedStyle(this,null).getPropertyValue(a);return m!==c&&(f=h(m,c),function(c){this.style.setProperty(a,f(c),d)})}return null==c?f:(c+="",g)})};
aa.styleTween=function(a,c,d){return 3>arguments.length&&(d=""),this.tween("style."+a,function(f,g){var h=c.call(this,f,g,ca.getComputedStyle(this,null).getPropertyValue(a));return h&&function(c){this.style.setProperty(a,h(c),d)}})};aa.text=function(a){return Jc(this,"text",a,Eg)};aa.remove=function(){return this.each("end.transition",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})};aa.ease=function(a){var c=this.id;return 1>arguments.length?this.node().__transition__[c].ease:
("function"!=typeof a&&(a=p.ease.apply(p,arguments)),xa(this,function(d){d.__transition__[c].ease=a}))};aa.delay=function(a){var c=this.id;return xa(this,"function"==typeof a?function(d,f,g){d.__transition__[c].delay=a.call(d,d.__data__,f,g)|0}:(a|=0,function(d){d.__transition__[c].delay=a}))};aa.duration=function(a){var c=this.id;return xa(this,"function"==typeof a?function(d,f,g){d.__transition__[c].duration=Math.max(1,a.call(d,d.__data__,f,g)|0)}:(a=Math.max(1,0|a),function(d){d.__transition__[c].duration=
a}))};aa.each=function(a,c){var d=this.id;if(2>arguments.length){var f=Fb,g=bb;bb=d;xa(this,function(c,f,g){Fb=c.__transition__[d];a.call(c,c.__data__,f,g)});Fb=f;bb=g}else xa(this,function(f){f.__transition__[d].event.on(a,c)});return this};aa.transition=function(){for(var a,c,d,f,g=this.id,h=++Ve,m=[],l=0,p=this.length;p>l;l++){m.push(a=[]);c=this[l];for(var s=0,t=c.length;t>s;s++)(d=c[s])&&(f=Object.create(d.__transition__[g]),f.delay+=f.duration,Ab(d,s,h,f)),a.push(d)}return $a(m,h)};p.svg.axis=
function(){function a(e){e.each(function(){var a,e=p.select(this),z=null==t?d.ticks?d.ticks.apply(d,s):d.domain():t,x=null==c?d.tickFormat?d.tickFormat.apply(d,s):String:c,B=Fg(d,z,v),y=e.selectAll(".tick.minor").data(B,String),B=y.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1E-6),w=p.transition(y.exit()).style("opacity",1E-6).remove(),y=p.transition(y).style("opacity",1),C=e.selectAll(".tick.major").data(z,String),z=C.enter().insert("g","path").attr("class","tick major").style("opacity",
1E-6),H=p.transition(C.exit()).style("opacity",1E-6).remove(),U=p.transition(C).style("opacity",1),J=xb(d),e=e.selectAll(".domain").data([0]),e=(e.enter().append("path").attr("class","domain"),p.transition(e)),K=d.copy(),N=this.__chart__||K;this.__chart__=K;z.append("line");z.append("text");var Q=z.select("line"),O=U.select("line"),x=C.select("text").text(x),C=z.select("text"),L=U.select("text");switch(f){case "bottom":a=Me;B.attr("y2",h);y.attr("x2",0).attr("y2",h);Q.attr("y2",g);C.attr("y",Math.max(g,
0)+l);O.attr("x2",0).attr("y2",g);L.attr("x",0).attr("y",Math.max(g,0)+l);x.attr("dy",".71em").style("text-anchor","middle");e.attr("d","M"+J[0]+","+m+"V0H"+J[1]+"V"+m);break;case "top":a=Me;B.attr("y2",-h);y.attr("x2",0).attr("y2",-h);Q.attr("y2",-g);C.attr("y",-(Math.max(g,0)+l));O.attr("x2",0).attr("y2",-g);L.attr("x",0).attr("y",-(Math.max(g,0)+l));x.attr("dy","0em").style("text-anchor","middle");e.attr("d","M"+J[0]+","+-m+"V0H"+J[1]+"V"+-m);break;case "left":a=Ne;B.attr("x2",-h);y.attr("x2",
-h).attr("y2",0);Q.attr("x2",-g);C.attr("x",-(Math.max(g,0)+l));O.attr("x2",-g).attr("y2",0);L.attr("x",-(Math.max(g,0)+l)).attr("y",0);x.attr("dy",".32em").style("text-anchor","end");e.attr("d","M"+-m+","+J[0]+"H0V"+J[1]+"H"+-m);break;case "right":a=Ne,B.attr("x2",h),y.attr("x2",h).attr("y2",0),Q.attr("x2",g),C.attr("x",Math.max(g,0)+l),O.attr("x2",g).attr("y2",0),L.attr("x",Math.max(g,0)+l).attr("y",0),x.attr("dy",".32em").style("text-anchor","start"),e.attr("d","M"+m+","+J[0]+"H0V"+J[1]+"H"+m)}if(d.ticks)z.call(a,
N),U.call(a,K),H.call(a,K),B.call(a,N),y.call(a,K),w.call(a,K);else{var R=K.rangeBand()/2,B=function(a){return K(a)+R};z.call(a,B);U.call(a,B)}})}var c,d=p.scale.linear(),f=gf,g=6,h=6,m=6,l=3,s=[10],t=null,v=0;return a.scale=function(c){return arguments.length?(d=c,a):d},a.orient=function(c){return arguments.length?(f=c in gh?c+"":gf,a):f},a.ticks=function(){return arguments.length?(s=arguments,a):s},a.tickValues=function(c){return arguments.length?(t=c,a):t},a.tickFormat=function(d){return arguments.length?
(c=d,a):c},a.tickSize=function(c,d){if(!arguments.length)return g;var f=arguments.length-1;return g=+c,h=1<f?+d:g,m=0<f?+arguments[f]:g,a},a.tickPadding=function(c){return arguments.length?(l=+c,a):l},a.tickSubdivide=function(c){return arguments.length?(v=+c,a):v},a};var gf="bottom",gh={top:1,right:1,bottom:1,left:1};p.svg.brush=function(){function a(h){h.each(function(){var h,m=p.select(this),q=m.selectAll(".background").data([0]),s=m.selectAll(".extent").data([0]),t=m.selectAll(".resize").data(z,
String);m.style("pointer-events","all").on("mousedown.brush",g).on("touchstart.brush",g);q.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");s.enter().append("rect").attr("class","extent").style("cursor","move");t.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return hh[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",
6).attr("height",6).style("visibility","hidden");t.style("display",a.empty()?"none":null);t.exit().remove();l&&(h=xb(l),q.attr("x",h[0]).attr("width",h[1]-h[0]),d(m));v&&(h=xb(v),q.attr("y",h[0]).attr("height",h[1]-h[0]),f(m));c(m)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+w[+/e$/.test(a)][0]+","+w[+/^s/.test(a)][1]+")"})}function d(a){a.select(".extent").attr("x",w[0][0]);a.selectAll(".extent,.n>rect,.s>rect").attr("width",w[1][0]-w[0][0])}function f(a){a.select(".extent").attr("y",
w[0][1]);a.selectAll(".extent,.e>rect,.w>rect").attr("height",w[1][1]-w[0][1])}function g(){function t(){var a=p.event.changedTouches;return a?p.touches(y,a)[0]:p.mouse(y)}function z(){var a=t(),e=!1;B&&(a[0]+=B[0],a[1]+=B[1]);O||(p.event.altKey?(x||(x=[(w[0][0]+w[1][0])/2,(w[0][1]+w[1][1])/2]),L[0]=w[+(a[0]<x[0])][0],L[1]=w[+(a[1]<x[1])][1]):x=null);N&&A(a,l,0)&&(d(J),e=!0);Q&&A(a,v,1)&&(f(J),e=!0);e&&(c(J),H({type:"brush",mode:O?"move":"resize"}))}function A(a,c,d){var e,f,g=xb(c);c=g[0];var g=
g[1],m=L[d],l=w[1][d]-w[0][d];return O&&(c-=m,g-=l+m),e=Math.max(c,Math.min(g,a[d])),O?f=(e+=m)+l:(x&&(m=Math.max(c,Math.min(g,2*x[d]-e))),e>m?(f=e,e=m):f=m),w[0][d]!==e||w[1][d]!==f?(h=null,w[0][d]=e,w[1][d]=f,!0):void 0}function E(){z();J.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);p.select("body").style("cursor",null);R.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",
null);H({type:"brushend"});s()}var x,B,y=this,C=p.select(p.event.target),H=m.of(y,arguments),J=p.select(y),K=C.datum(),N=!/^(n|s)$/.test(K)&&l,Q=!/^(e|w)$/.test(K)&&v,O=C.classed("extent"),L=t(),R=p.select(ca).on("mousemove.brush",z).on("mouseup.brush",E).on("touchmove.brush",z).on("touchend.brush",E).on("keydown.brush",function(){32==p.event.keyCode&&(O||(x=null,L[0]-=w[1][0],L[1]-=w[1][1],O=2),s())}).on("keyup.brush",function(){32==p.event.keyCode&&2==O&&(L[0]+=w[1][0],L[1]+=w[1][1],O=0,s())});
if(O)L[0]=w[0][0]-L[0],L[1]=w[0][1]-L[1];else if(K){var T=+/w$/.test(K),K=+/^n/.test(K);B=[w[1-T][0]-L[0],w[1-K][1]-L[1]];L[0]=w[T][0];L[1]=w[K][1]}else p.event.altKey&&(x=L.slice());J.style("pointer-events","none").selectAll(".resize").style("display",null);p.select("body").style("cursor",C.style("cursor"));H({type:"brushstart"});z();s()}var h,m=t(a,"brushstart","brush","brushend"),l=null,v=null,z=Uc[0],w=[[0,0],[0,0]];return a.x=function(c){return arguments.length?(l=c,z=Uc[!l<<1|!v],a):l},a.y=
function(c){return arguments.length?(v=c,z=Uc[!l<<1|!v],a):v},a.extent=function(c){var d,f,g,m,n;return arguments.length?(h=[[0,0],[0,0]],l&&(d=c[0],f=c[1],v&&(d=d[0],f=f[0]),h[0][0]=d,h[1][0]=f,l.invert&&(d=l(d),f=l(f)),d>f&&(n=d,d=f,f=n),w[0][0]=0|d,w[1][0]=0|f),v&&(g=c[0],m=c[1],l&&(g=g[1],m=m[1]),h[0][1]=g,h[1][1]=m,v.invert&&(g=v(g),m=v(m)),g>m&&(n=g,g=m,m=n),w[0][1]=0|g,w[1][1]=0|m),a):(c=h||w,l&&(d=c[0][0],f=c[1][0],h||(d=w[0][0],f=w[1][0],l.invert&&(d=l.invert(d),f=l.invert(f)),d>f&&(n=d,
d=f,f=n))),v&&(g=c[0][1],m=c[1][1],h||(g=w[0][1],m=w[1][1],v.invert&&(g=v.invert(g),m=v.invert(m)),g>m&&(n=g,g=m,m=n))),l&&v?[[d,g],[f,m]]:l?[d,f]:v&&[g,m])},a.clear=function(){return h=null,w[0][0]=w[0][1]=w[1][0]=w[1][1]=0,a},a.empty=function(){return l&&w[0][0]===w[1][0]||v&&w[0][1]===w[1][1]},p.rebind(a,m,"on")};var hh={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Uc=["n e s w nw ne se sw".split(" "),["e","w"],["n",
"s"],[]];p.time={};var ea=Date;Fa.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},
getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ua.setUTCDate.apply(this._,arguments)},setDay:function(){ua.setUTCDay.apply(this._,arguments)},setFullYear:function(){ua.setUTCFullYear.apply(this._,arguments)},setHours:function(){ua.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ua.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ua.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ua.setUTCMonth.apply(this._,
arguments)},setSeconds:function(){ua.setUTCSeconds.apply(this._,arguments)},setTime:function(){ua.setTime.apply(this._,arguments)}};var ua=Date.prototype,hf="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),jf="Sun Mon Tue Wed Thu Fri Sat".split(" "),Vc="January February March April May June July August September October November December".split(" "),Wc="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");p.time.year=Ga(function(a){return a=p.time.day(a),a.setMonth(0,1),
a},function(a,c){a.setFullYear(a.getFullYear()+c)},function(a){return a.getFullYear()});p.time.years=p.time.year.range;p.time.years.utc=p.time.year.utc.range;p.time.day=Ga(function(a){var c=new ea(1970,0);return c.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),c},function(a,c){a.setDate(a.getDate()+c)},function(a){return a.getDate()-1});p.time.days=p.time.day.range;p.time.days.utc=p.time.day.utc.range;p.time.dayOfYear=function(a){var c=p.time.year(a);return Math.floor((a-c-6E4*(a.getTimezoneOffset()-
c.getTimezoneOffset()))/864E5)};"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ").forEach(function(a,c){a=a.toLowerCase();c=7-c;var d=p.time[a]=Ga(function(a){return(a=p.time.day(a)).setDate(a.getDate()-(a.getDay()+c)%7),a},function(a,c){a.setDate(a.getDate()+7*Math.floor(c))},function(a){var d=p.time.year(a).getDay();return Math.floor((p.time.dayOfYear(a)+(d+c)%7)/7)-(d!==c)});p.time[a+"s"]=d.range;p.time[a+"s"].utc=d.utc.range;p.time[a+"OfYear"]=function(a){var d=p.time.year(a).getDay();
return Math.floor((p.time.dayOfYear(a)+(d+c)%7)/7)}});p.time.week=p.time.sunday;p.time.weeks=p.time.sunday.range;p.time.weeks.utc=p.time.sunday.utc.range;p.time.weekOfYear=p.time.sundayOfYear;p.time.format=function(a){function c(f){for(var g,h,m,l=[],p=-1,s=0;++p<d;)37===a.charCodeAt(p)&&(l.push(a.substring(s,p)),null!=(h=ih[g=a.charAt(++p)])&&(g=a.charAt(++p)),(m=Nb[g])&&(g=m(f,null==h?"e"===g?" ":"0":h)),l.push(g),s=p+1);return l.push(a.substring(s,p)),l.join("")}var d=a.length;return c.parse=function(c){var d=
{y:1900,m:0,d:1,H:0,M:0,S:0,L:0};if(Cb(d,a,c,0)!=c.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);c=new ea;return c.setFullYear(d.y,d.m,d.d),c.setHours(d.H,d.M,d.S,d.L),c},c.toString=function(){return a},c};var kf=Db(hf),lf=Db(jf),mf=Db(Vc),jh=Oe(Vc),nf=Db(Wc),kh=Oe(Wc),ih={"-":"",_:" ",0:"0"},Nb={a:function(a){return jf[a.getDay()]},A:function(a){return hf[a.getDay()]},b:function(a){return Wc[a.getMonth()]},B:function(a){return Vc[a.getMonth()]},c:p.time.format("%a %b %e %X %Y"),d:function(a,c){return ha(a.getDate(),
c,2)},e:function(a,c){return ha(a.getDate(),c,2)},H:function(a,c){return ha(a.getHours(),c,2)},I:function(a,c){return ha(a.getHours()%12||12,c,2)},j:function(a,c){return ha(1+p.time.dayOfYear(a),c,3)},L:function(a,c){return ha(a.getMilliseconds(),c,3)},m:function(a,c){return ha(a.getMonth()+1,c,2)},M:function(a,c){return ha(a.getMinutes(),c,2)},p:function(a){return 12<=a.getHours()?"PM":"AM"},S:function(a,c){return ha(a.getSeconds(),c,2)},U:function(a,c){return ha(p.time.sundayOfYear(a),c,2)},w:function(a){return a.getDay()},
W:function(a,c){return ha(p.time.mondayOfYear(a),c,2)},x:p.time.format("%m/%d/%Y"),X:p.time.format("%H:%M:%S"),y:function(a,c){return ha(a.getFullYear()%100,c,2)},Y:function(a,c){return ha(a.getFullYear()%1E4,c,4)},Z:function(a){var c=a.getTimezoneOffset();a=0<c?"-":"+";var d=~~(Math.abs(c)/60),c=Math.abs(c)%60;return a+ha(d,"0",2)+ha(c,"0",2)},"%":function(){return"%"}},Gg={a:function(a,c,d){lf.lastIndex=0;return(a=lf.exec(c.substring(d)))?d+a[0].length:-1},A:function(a,c,d){kf.lastIndex=0;return(a=
kf.exec(c.substring(d)))?d+a[0].length:-1},b:function(a,c,d){nf.lastIndex=0;return(c=nf.exec(c.substring(d)))?(a.m=kh.get(c[0].toLowerCase()),d+c[0].length):-1},B:function(a,c,d){mf.lastIndex=0;return(c=mf.exec(c.substring(d)))?(a.m=jh.get(c[0].toLowerCase()),d+c[0].length):-1},c:function(a,c,d){return Cb(a,""+Nb.c,c,d)},d:Pe,e:Pe,H:Qe,I:Qe,L:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,d+3)))?(a.L=+c[0],d+c[0].length):-1},m:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,
d+2)))?(a.m=c[0]-1,d+c[0].length):-1},M:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,d+2)))?(a.M=+c[0],d+c[0].length):-1},p:function(a,c,d){c=lh.get(c.substring(d,d+=2).toLowerCase());return null==c?-1:(a.p=c,d)},S:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,d+2)))?(a.S=+c[0],d+c[0].length):-1},x:function(a,c,d){return Cb(a,""+Nb.x,c,d)},X:function(a,c,d){return Cb(a,""+Nb.X,c,d)},y:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,d+2)))?(a.y=+c[0]+
(68<+c[0]?1900:2E3),d+c[0].length):-1},Y:function(a,c,d){fa.lastIndex=0;return(c=fa.exec(c.substring(d,d+4)))?(a.y=+c[0],d+c[0].length):-1}},fa=/^\s*\d+/,lh=p.map({am:0,pm:1});p.time.format.utc=function(a){function c(a){try{ea=Fa;var e=new ea;return e._=a,d(e)}finally{ea=Date}}var d=p.time.format(a);return c.parse=function(a){try{ea=Fa;var c=d.parse(a);return c&&c._}finally{ea=Date}},c.toString=d.toString,c};var of=p.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");p.time.format.iso=Date.prototype.toISOString&&
+new Date("2000-01-01T00:00:00.000Z")?Kc:of;Kc.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Kc.toString=of.toString;p.time.second=Ga(function(a){return new ea(1E3*Math.floor(a/1E3))},function(a,c){a.setTime(a.getTime()+1E3*Math.floor(c))},function(a){return a.getSeconds()});p.time.seconds=p.time.second.range;p.time.seconds.utc=p.time.second.utc.range;p.time.minute=Ga(function(a){return new ea(6E4*Math.floor(a/6E4))},function(a,c){a.setTime(a.getTime()+6E4*Math.floor(c))},function(a){return a.getMinutes()});
p.time.minutes=p.time.minute.range;p.time.minutes.utc=p.time.minute.utc.range;p.time.hour=Ga(function(a){var c=a.getTimezoneOffset()/60;return new ea(36E5*(Math.floor(a/36E5-c)+c))},function(a,c){a.setTime(a.getTime()+36E5*Math.floor(c))},function(a){return a.getHours()});p.time.hours=p.time.hour.range;p.time.hours.utc=p.time.hour.utc.range;p.time.month=Ga(function(a){return a=p.time.day(a),a.setDate(1),a},function(a,c){a.setMonth(a.getMonth()+c)},function(a){return a.getMonth()});p.time.months=p.time.month.range;
p.time.months.utc=p.time.month.utc.range;var Eb=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Xc=[[p.time.second,1],[p.time.second,5],[p.time.second,15],[p.time.second,30],[p.time.minute,1],[p.time.minute,5],[p.time.minute,15],[p.time.minute,30],[p.time.hour,1],[p.time.hour,3],[p.time.hour,6],[p.time.hour,12],[p.time.day,1],[p.time.day,2],[p.time.week,1],[p.time.month,1],[p.time.month,3],[p.time.year,1]],mh=[[p.time.format("%Y"),Ta],[p.time.format("%B"),
function(a){return a.getMonth()}],[p.time.format("%b %d"),function(a){return 1!=a.getDate()}],[p.time.format("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[p.time.format("%I %p"),function(a){return a.getHours()}],[p.time.format("%I:%M"),function(a){return a.getMinutes()}],[p.time.format(":%S"),function(a){return a.getSeconds()}],[p.time.format(".%L"),function(a){return a.getMilliseconds()}]],pf=p.scale.linear(),nh=Re(mh);Xc.year=function(a,c){return pf.domain(a.map(Hg)).ticks(c).map(Nc)};
p.time.scale=function(){return Lc(p.scale.linear(),Xc,nh)};var qf=Xc.map(function(a){return[a[0].utc,a[1]]}),oh=[[p.time.format.utc("%Y"),Ta],[p.time.format.utc("%B"),function(a){return a.getUTCMonth()}],[p.time.format.utc("%b %d"),function(a){return 1!=a.getUTCDate()}],[p.time.format.utc("%a %d"),function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],[p.time.format.utc("%I %p"),function(a){return a.getUTCHours()}],[p.time.format.utc("%I:%M"),function(a){return a.getUTCMinutes()}],[p.time.format.utc(":%S"),
function(a){return a.getUTCSeconds()}],[p.time.format.utc(".%L"),function(a){return a.getUTCMilliseconds()}]],ph=Re(oh);return qf.year=function(a,c){return pf.domain(a.map(Ig)).ticks(c).map(Oc)},p.time.scale.utc=function(){return Lc(p.scale.linear(),qf,ph)},p.text=function(){return p.xhr.apply(p,arguments).response(Jg)},p.json=function(a,c){return p.xhr(a,"application/json",c).response(Kg)},p.html=function(a,c){return p.xhr(a,"text/html",c).response(Lg)},p.xml=function(){return p.xhr.apply(p,arguments).response(Mg)},
p}();
(function(d){var h=d.d3,l=Error("d3.layer must be initialized with a base"),a=Error("d3.layer must specify a `dataBind` method."),c=Error("d3.layer must specify an `insert` method."),g=function(a){if(!a)throw l;this._base=a;this._handlers={}};g.prototype.dataBind=function(){throw a;};g.prototype.insert=function(){throw c;};g.prototype.on=function(a,c,d){d=d||{};a in this._handlers||(this._handlers[a]=[]);this._handlers[a].push({callback:c,chart:d.chart||null})};g.prototype.off=function(a,c){var d,g=
this._handlers[a];if(g){if(1===arguments.length)return g.length=0,void 0;for(d=g.length-1;-1<d;--d)g[d].callback===c&&g.splice(d,1)}};g.prototype.draw=function(a){var c,d,g,l,t;if(c=this.dataBind.call(this._base,a),!(c instanceof h.selection))throw Error("Invalid selection defined by `dataBind` method.");a=c.enter();a._chart=this._base._chart;c=[{name:"update",selection:c},{name:"enter",selection:this.insert.bind(a)},{name:"merge",selection:c},{name:"exit",selection:c.exit.bind(c)}];for(var w=0,Q=
c.length;Q>w;++w){if(g=c[w].name,d=c[w].selection,"function"==typeof d&&(d=d()),!(d instanceof h.selection))throw Error('Invalid selection defined for "'+g+"' lifecycle event.");if(a=this._handlers[g])for(l=0,t=a.length;t>l;++l)d._chart=a[l].chart||this._base._chart,d.call(a[l].callback);if(a=this._handlers[g+":transition"],a&&a.length)for(d=d.transition(),l=0,t=a.length;t>l;++l)d._chart=a[l].chart||this._base._chart,d.call(a[l].callback)}};h.selection.prototype.layer=function(a){var c,d=new g(this);
if(d.dataBind=a.dataBind,d.insert=a.insert,"events"in a)for(c in a.events)d.on(c,a.events[c]);return this.on=function(){return d.on.apply(d,arguments)},this.off=function(){return d.off.apply(d,arguments)},this.draw=function(){return d.draw.apply(d,arguments)},this}})(this);
(function(d,h){function l(a){var c,d,f,g;if(!a)return a;d=arguments.length;for(c=1;d>c;c++)if(f=arguments[c])for(g in f)a[g]=f[g];return a}var a=d.d3,c=function(a){this.constructor=a},g=function(a,d){var f;return c.prototype=a.prototype,f=new c(a),a.apply(f,d),f},m=function(a,c){var d=this.constructor.__super__;d&&m.call(d,a,c);Object.hasOwnProperty.call(this.constructor.prototype,"initialize")&&this.initialize.apply(a,c)},f=function(a){this.base=a;this._layers={};this._mixins=[];this._events={};
m.call(this,this,Array.prototype.slice.call(arguments,1))};f.prototype.unlayer=function(a){var c=this.layer(a),c=this._layerList.indexOf(c);return delete this._layers[a],this._layerList.splice(c,1),this};f.prototype.layer=function(a,c,d){var f;return 1===arguments.length?this._layers[a]:(f=c.layer(d),this._layers[a]=f,c._chart=this,f)};f.prototype.initialize=function(){};f.prototype.transform=function(a){return a};f.prototype.mixin=function(a,c){var d=Array.prototype.slice.call(arguments,2);d.unshift(c);
d=g(f[a],d);return this._mixins.push(d),d};f.prototype.draw=function(a){var c,d;a=this.transform(a);for(c in this._layers)this._layers[c].draw(a);for(d in this._mixins)this._mixins[d].draw(a)};f.prototype.on=function(a,c,d){return(this._events[a]||(this._events[a]=[])).push({callback:c,context:d||this,_chart:this}),this};f.prototype.once=function(a,c,d){var f=this,g=function(){f.off(a,g);c.apply(this,arguments)};return this.on(a,g,d)};f.prototype.off=function(a,c,d){var f,g,h,m,l;if(0===arguments.length){for(a in this._events)this._events[a].length=
0;return this}if(1===arguments.length)return g=this._events[a],g&&(g.length=0),this;f=a?[a]:Object.keys(this._events);for(m=0;f.length>m;m++)for(g=f[m],g=this._events[g],l=g.length;l--;)h=g[l],(c&&c===h.callback||d&&d===h.context)&&g.splice(l,1);return this};f.prototype.trigger=function(a){var c,d,f=Array.prototype.slice.call(arguments,1),g=this._events[a];if(g!==h)for(c=0;g.length>c;c++)d=g[c],d.callback.apply(d.context,f);return this};f.extend=function(a,c,d){var g,h=this;g=c&&Object.hasOwnProperty.call(c,
"constructor")?c.constructor:function(){return h.apply(this,arguments)};l(g,h,d);d=function(){this.constructor=g};return d.prototype=h.prototype,g.prototype=new d,c&&l(g.prototype,c),g.__super__=h.prototype,f[a]=g,g};a.chart=function(a){return 0===arguments.length?f:1===arguments.length?f[a]:f.extend.apply(f,arguments)};a.selection.prototype.chart=function(a){if(0===arguments.length)return this._chart;var c=Array.prototype.slice.call(arguments,1);c.unshift(this);return g(f[a],c)};a.selection.enter.prototype.chart=
function(){return this._chart};a.transition.prototype.chart=a.selection.enter.prototype.chart})(this);var golden_ratio=1.61803398875;function sortByKey(d,h){return d.sort(function(d,a){var c=d[h],g=a[h];return c<g?-1:c>g?1:0})}$("#masonry-container").masonry({itemSelector:".mbox",columnWidth:384});$.fn.scrollView=function(){return this.each(function(){$("html, body").animate({scrollTop:$(this).offset().top},0)})};
$(function(){$(".column").each(function(d){var h=this;$(h).sortable({connectWith:".column",handle:".portlet-header",update:function(d,a){$.cookie("sortorder"+h.id,$(h).sortable("toArray").join(),{path:"/"})}})});$(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend("<span class='ui-icon ui-icon-minusthick'></span>").end().find(".portlet-content");$(".portlet-header .ui-icon").click(function(){$(this).toggleClass("ui-icon-minusthick").toggleClass("ui-icon-plusthick");
$(this).parents(".portlet:first").find(".portlet-content").toggle($.cookie($(this).parents(".portlet:first")[0].id,$(this).parents(".portlet:first").find(".portlet-content").is(":hidden")?"expanded":"collapsed",{path:"/"}))})});
function loadCookie(){$(".column").each(function(d){d=$.cookie("sortorder"+this.id);var h=this;d&&$(d.split(",")).each(function(d,a){$("#"+a).appendTo(h)});$(this).sortable()});$(".portlet").each(function(d){(d=$.cookie(this.id))&&"collapsed"===d&&($(this).find(".ui-icon").toggleClass("ui-icon-minusthick").toggleClass("ui-icon-plusthick"),$(this).find(".portlet-content").hide())});"true"===$.cookie("shotTracking")?turnOnShotTracker():turnOffShotTracker()}var shot_stream_client=new XMLHttpRequest;
function turnOffShotTracker(){$("#h1ds-track-latest-shot").hide();$("#h1ds-shot-controller").show();$("#h1ds-toggle-track-latest-shot").html('<FORM class="inline-form right" action="." onsubmit="javascript:toggleTrackLatestShot()" method="post"><INPUT type="submit" id="h1ds-toggletrack-shot" name="h1ds-toggletrack-shot" value="track latest shot"></FORM>');$.cookie("shotTracking","false",{path:"/"});shot_stream_client.abort()}
function turnOnShotTracker(){$("#h1ds-shot-controller").hide();$("#h1ds-track-latest-shot").show();$("#h1ds-toggletrack-latest-shot").html('<FORM class="inline-form right" action="." onsubmit="javascript:toggleTrackLatestShot()" method="post"><INPUT type="submit" id="h1ds-toggletrack-shot" name="h1ds-toggletrack-shot" value="stop tracking latest shot"></FORM>');$.cookie("shotTracking","true",{path:"/"});shot_stream_client.open("get","/_/shot_stream/");shot_stream_client.send();shot_stream_client.onprogress=
function(){var d=this.responseText.split("\n");$.getJSON("/_/url_for_shot",{input_path:window.location.toString(),shot:d[d.length-2]},function(d){window.location=d.new_url})}}function toggleTrackLatestShot(){"true"===$.cookie("shotTracking")?turnOffShotTracker():turnOnShotTracker();return!1}
function autoPollSummaryDB(){var d=d3.select("#poll-summarydb-server");if(null!==d[0][0]&&"True"===d.text()){var h=null,l=window.location.toString()+(window.location.search+(window.location.search.length?"&":"?")+"format=json"),a=d3.select("table.main-table tbody"),c=function(c){$.ajax({url:l,dataType:"json",async:!1}).done(function(d){h=new Date(d.timestamp);d=a.selectAll("tr").data(cross(d),function(a){return a[0].shot});d.enter().insert("tr","tr").style("background-color","yellow");var f=d.selectAll("td").data(function(a){return a});
f.enter().append("td").html(function(a,c){return'<a href="/summary/_/go_to_source/'+a.attr+"/"+a.shot+'/" >'+a.value+"</a>"});f.transition().duration(500).each(function(a){d3.select(this).html(function(a,c){return'<a href="/summary/_/go_to_source/'+a.attr+"/"+a.shot+'/" >'+a.value+"</a>"})});d.transition().duration(c).style("background-color","white");d.exit().remove()})};c(1E3);setInterval(function(){summaryUpdateRequired(h)&&c(3E5)},2E3)}}
function getLastShotInDisplayedPage(){var d=-1;d3.selectAll("table.main-table tr").each(function(h,l){if(0<l){var a=Number(d3.select(this).select("td").text());a>d&&(d=a)}});return d}function summaryUpdateRequired(d){$.ajax({url:"/summary/_/get_last_update_time/",dataType:"json",async:!1}).done(function(d){latest_summdb_update=new Date(d.last_update)});return latest_summdb_update>d}
function updateSummaryDB(){var d=getLastShotInDisplayedPage(),h=-1;$.ajax({url:"/summary/_/get_latest_summarydb_shot/",dataType:"json",async:!1}).done(function(d){h=Number(d.latest_shot)});h>d&&$.ajax({url:window.location.toString()+(window.location.search+(window.location.search.length?"&":"?")+"format=json"),dataType:"json",async:!1}).done(function(d){})}
function cross(d){var h=[],l,a;for(l=0;l<d.data.length;l++)for(h[l]=[],h[l].shot,a=0;a<d.attributes.length;a++)h[l][a]={shot:d.data[l].shot,attr:d.attributes[a],value:d.data[l].d[a]};return h}$("span.toggleVertical").each(function(){"true"===$.cookie("vertical-"+$(this).text())&&($(this).toggleClass("verticalText"),$(this).html($(this).text().replace(/(.)/g,"$1<br />")))});
$("span.toggleVertical").click(function(){$(this).toggleClass("verticalText");$(this).hasClass("verticalText")?($(this).html($(this).text().replace(/(.)/g,"$1<br />")),$.cookie("vertical-"+$(this).text(),!0)):($(this).html($(this).text().replace("$1<br />","")),$.cookie("vertical-"+$(this).text(),!1))});
function H1DSUri(d){this.base_uri=d;this.base_uri_components=parseUri(d);this.base_h1ds_filters=[];this.base_non_h1ds_query={};this.extra_h1ds_filters=[];this.extra_non_h1ds_query={};d={fids:[]};var h=/^f(\d+)(_(\w+))?/,l;for(l in this.base_uri_components.queryKey)if(this.base_uri_components.queryKey.hasOwnProperty(l)){var a=h.exec(l);a?(d.hasOwnProperty(a[1])||(d.fids.push(a[1]),d[a[1]]={name:"",kwargs:{},fid:parseInt(a[1])}),"undefined"===typeof a[2]?d[a[1]].name=this.base_uri_components.queryKey[l]:
d[a[1]].kwargs[a[3]]=this.base_uri_components.queryKey[l]):this.base_non_h1ds_query[l]=this.base_uri_components.queryKey[l]}for(l=0;l<d.fids.length;l++)this.base_h1ds_filters.push(d[d.fids[l]]);this.sortH1DSFilters()}H1DSUri.prototype.sortH1DSFilters=function(){this.base_h1ds_filters=sortByKey(this.base_h1ds_filters,"fid");this.extra_h1ds_filters=sortByKey(this.extra_h1ds_filters,"fid")};
H1DSUri.prototype.updateOrAddBaseFilter=function(d,h){var l=this.base_h1ds_filters.length;0<l&&this.base_h1ds_filters[l-1].name==d?this.base_h1ds_filters[l-1].kwargs=h:this.addBaseFilter(d,h)};H1DSUri.prototype.shiftExtraH1DSFilterFIDs=function(d){for(var h=0;h<this.extra_h1ds_filters.length;h++)this.extra_h1ds_filters[h].fid+=d};
H1DSUri.prototype.shiftExtraFilterIDs=function(){this.sortH1DSFilters();if(0<this.extra_h1ds_filters.length){var d=new_fid-this.extra_h1ds_filters[0].fid;0<=d&&this.shiftExtraH1DSFilterFIDs(d+1)}};H1DSUri.prototype.addBaseFilter=function(d,h){this.sortH1DSFilters();var l=this.base_h1ds_filters.length;this.base_h1ds_filters.push({name:d,kwargs:h,fid:0<l?this.base_h1ds_filters[l-1].fid+1:0});this.shiftExtraH1DSFilterFIDs()};
H1DSUri.prototype.addExtraFilter=function(d,h){this.sortH1DSFilters();var l=this.extra_h1ds_filters.length,a=this.base_h1ds_filters.length;this.extra_h1ds_filters.push({name:d,kwargs:h,fid:0<l?this.extra_h1ds_filters[l-1].fid+1:0<a?this.base_h1ds_filters[a-1].fid+1:0})};H1DSUri.prototype.packFilterIDs=function(){console.log(this.extra_h1ds_filters)};
H1DSUri.prototype.changeFilterID=function(d,h){for(var l=0;l<this.base_h1ds_filters.length;l++)this.base_h1ds_filters[l].fid==parseInt(d)&&(this.base_h1ds_filters[l].fid=parseInt(h));for(l=0;l<this.extra_h1ds_filters.length;l++)this.extra_h1ds_filters[l].fid==parseInt(d)&&(this.extra_h1ds_filters[l].fid=parseInt(h));this.shiftExtraFilterIDs()};
H1DSUri.prototype.renderBaseUri=function(){var d={},h;for(h in this.base_non_h1ds_query)this.base_non_h1ds_query.hasOwnProperty(h)&&(d[h]=this.base_non_h1ds_query[h]);for(h=0;h<this.base_h1ds_filters.length;h++){var l=this.base_h1ds_filters[h].fid;d["f"+l]=this.base_h1ds_filters[h].name;for(var a in this.base_h1ds_filters[h].kwargs)d["f"+l+"_"+a]=this.base_h1ds_filters[h].kwargs[a]}a=jQuery.extend({},this.base_uri_components);a.queryKey=d;return makeUri(a)};
H1DSUri.prototype.renderExtraUri=function(){var d={},h;for(h in this.base_non_h1ds_query)this.base_non_h1ds_query.hasOwnProperty(h)&&(d[h]=this.base_non_h1ds_query[h]);for(var l=0;l<this.base_h1ds_filters.length;l++){var a=this.base_h1ds_filters[l].fid;d["f"+a]=this.base_h1ds_filters[l].name;for(var c in this.base_h1ds_filters[l].kwargs)d["f"+a+"_"+c]=this.base_h1ds_filters[l].kwargs[c]}for(h in this.extra_non_h1ds_query)this.extra_non_h1ds_query.hasOwnProperty(h)&&(d[h]=this.extra_non_h1ds_query[h]);
for(l=0;l<this.extra_h1ds_filters.length;l++)for(c in a=this.extra_h1ds_filters[l].fid,d["f"+a]=this.extra_h1ds_filters[l].name,this.extra_h1ds_filters[l].kwargs)d["f"+a+"_"+c]=this.extra_h1ds_filters[l].kwargs[c];h=jQuery.extend({},this.base_uri_components);h.queryKey=d;return makeUri(h)};H1DSUri.prototype.isBinary=function(){return"bin"===this.base_non_h1ds_query.format};
H1DSUri.prototype.getShot=function(){var d=this.uri_components.path;"/"!==d[d.length-1]&&(d+="/");d=d.match(/\/\d+\//);return null===d?0:Number(d[0].substring(1,d[0].length-1))};H1DSUri.prototype.setShot=function(d){var h=this.uri_components.path;"/"!==h[h.length-1]&&(h+="/");d=h.replace(/\/\d+\//,"/"+d+"/");this.uri_components.path=d};d3.select(window).on("mousemove",mousemove).on("mouseup",mouseup);var rect,x0,x1,count,par_rect;
function mousedown(){x0=d3.mouse(this);count=0;par_rect=d3.select(this);rect=d3.select(this.parentNode).append("svg:rect").attr("y",par_rect.attr("y")).attr("height",par_rect.attr("height")).style("fill","#999").style("fill-opacity",0.5);d3.event.preventDefault()}function mousemove(){if(rect){x1=d3.mouse(rect.node());var d=Math.min(x0[0],x1[0]),h=Math.max(x0[0],x1[0]);Math.min(x0[1],x1[1]);Math.max(x0[1],x1[1]);rect.attr("x",d-0.5).attr("width",h-d+1)}}
function mouseup(){rect&&(rect.each(function(d){var h=d.xAxis.scale().invert(d3.select(this).attr("x"));d=d.xAxis.scale().invert(+d3.select(this).attr("x")+ +d3.select(this).attr("width"));var l=new H1DSUri(window.location.href),a=Number(l.getNextFilterID());0==a?l.appendFilter("dim_range",{min:h,max:d}):(a-=1,"dim_range"===l.h1ds_filters[String(a)].name?l.h1ds_filters[String(a)].kwargs={min:h,max:d}:l.appendFilter("dim_range",{min:h,max:d}));$(".h1ds-pagelet").each(function(){d3.select(this).html("");
populatePagelet($(this),l.renderUri())});Modernizr.history&&history.pushState(null,null,l.renderUri())}),rect.remove(),rect=null)}
function PlotContainer(d,h,l){this.id=d;this.plotTypes={raw:this.plotLine,spectrogram:this.plotSpectrogram,powerspectrum:this.plotLine,raw2d:this.plotSpectrogram};var a=$(d).width(),c=d3.min([a/1.618,0.9*$(window).height()]);this.control_panel=d3.select(d).append("div").classed("pc-control-panel",!0).append("ul");this.svg=d3.select(d).append("svg:svg").attr("width",a).attr("height",c);this.data_colours="#A11D20 #662C91 #1859A9 #008C47 #ED2D2E #010101".split(" ");this.plotGrid=this.setPlotGrid(h,l);
this.url_cache={};this.data_ids={};this.dataPadding=0.05;this.xAxisPadding=40;this.yAxisPadding=60}
PlotContainer.prototype.setPlotGrid=function(d,h){for(var l=d3.sum(h),a=d3.sum(d),c=[],g=[],m=this.svg.attr("width"),f=this.svg.attr("height"),s=0;s<h.length;s++)c[s]=m*h[s]/l;for(s=0;s<d.length;s++)g[s]=f*d[s]/a;l=[];for(s=f=m=a=0;s<d.length;s++){for(var v=f=0;v<c.length;v++)l[a]={translate:[f,m],width:c[v],height:g[s],data_ids:[],data:[],plotType:"",flip:!1,bindAxis:[-1,-1]},f+=c[v],a++;m+=g[s]}this.svg.attr("height",m);$(this.id).height(m);return l};
PlotContainer.prototype.plotLine=function(d){var h=d.datum().plot.flip;d.append("path").classed("path-filled",function(d){return d.data.data.metadata.is_minmax}).style("stroke",function(d,a){return d.data.colour}).style("fill",function(d,a){return d.data.data.metadata.is_minmax?d.data.colour:"none"}).attr("d",function(d,a){if(d.data.data.metadata.is_minmax){var c=fillPlot(d.data),g=d3.svg.line().x(function(a){return d.plot.x(a[h?1:0])}).y(function(a){return d.plot.y(a[h?0:1])});return g(c)}g=d3.svg.line().x(function(a,
c){return d.plot.x(h?a:d.data.data.dimension[0][c])}).y(function(a,c){return d.plot.y(h?d.data.data.dimension[0][c]:a)});return g(d.data.data.value[0])})};PlotContainer.prototype.plotRaw2D=function(d){};
PlotContainer.prototype.plotSpectrogram=function(d){var h=[];d3.scale.linear().domain([0,1]).range(["blue","red"]);d3.scale.linear().domain([0,1]).range([0,1]);var l=0;data=d.datum();for(var a=data.plot.x(data.data.dim[0][1])-data.plot.x(data.data.dim[0][0]),c=data.plot.y(data.data.dim[1][0])-data.plot.y(data.data.dim[1][1]),g=data.plot.x(data.data.dim[0][0]),m=data.plot.y(data.data.dim[1][0]),f=0;f<data.data.dim[0].length-1;f++)for(var s=0;s<data.data.dim[1].length-1;s++)0<data.data.data[f][s]&&
(h.push({xi:f,yi:s}),data.data.data[f][s]>l&&(l=data.data.data[f][s]));d.selectAll("rect").data(h).enter().append("rect").attr("x",function(c,d){return g+c.xi*a}).attr("y",function(a,d){return m-a.yi*c}).attr("width",a).attr("height",c).style("fill",function(a,c){return data.data.colour}).style("fill-opacity",function(a,c){return data.data.data[a.xi][a.yi]/l})};PlotContainer.prototype.plotPowerSpectrum=function(d){};
PlotContainer.prototype.setPlot=function(d,h,l){for(var a in h)this.plotGrid[d][a]=h[a];"undefined"!==typeof l&&l&&this.updateDisplay()};PlotContainer.prototype.addData=function(d,h){this.data_ids[d]={uri:h,colour:this.data_colours.pop()}};PlotContainer.prototype.addDataToPlot=function(d,h,l){l="undefined"!==typeof l?l:!0;this.plotGrid[h].data_ids.push(d);l&&this.updateDisplay()};
PlotContainer.prototype.loadURL=function(d,h){var l=this;if(h){var a=$.ajax({url:d,async:!1}),c=ProcessH1DSHeaders(a.getAllResponseHeaders());a.done(function(a){data=ProcessBinaryData(a,c);l.url_cache[d]=data})}else console.log(d),$.ajax({url:d,dataType:"json",async:!1}).done(function(a){l.url_cache[d]=a})};
PlotContainer.prototype.getData=function(d,h){var l={};switch(h){case "raw":var l=getRawUri(this.data_ids[d].uri,this.svg.attr("width")),a=l.renderUri();this.loadURL(a,l.isBinary());l=this.url_cache[a];break;case "spectrogram":l=getSpectrogramUri(this.data_ids[d].uri);a=l.renderUri();this.loadURL(a,l.isBinary());l=this.url_cache[a];break;case "powerspectrum":l=getPowerspectrumUri(this.data_ids[d].uri,this.svg.attr("width"));a=l.renderUri();this.loadURL(a,l.isBinary());l=this.url_cache[a];break;default:this.loadURL(this.data_ids[d].uri,
!1),l=this.url_cache[this.data_ids[d].uri]}return l};
PlotContainer.prototype.updateDisplay=function(){for(var d=this,h=0;h<this.plotGrid.length;h++){for(var l=0;l<this.plotGrid[h].data_ids.length;l++)this.plotGrid[h].data[l]=this.getData(this.plotGrid[h].data_ids[l],this.plotGrid[h].plotType),this.plotGrid[h].data[l].colour=d.data_ids[this.plotGrid[h].data_ids[l]].colour;0<this.plotGrid[h].data_ids.length&&this.updatePlot(h)}for(h=0;h<this.plotGrid.length;h++)0<this.plotGrid[h].data_ids.length&&this.linkAxes(h);h=this.svg.selectAll("g.plot").data(this.plotGrid);
h.enter().append("g").attr("class","plot").attr("transform",function(a){return"translate("+a.translate[0]+","+a.translate[1]+")"}).append("clipPath").attr("id",function(a,c){return"plot-"+c+"-clippath"}).append("svg:rect").attr("width",function(a,c){return a.width}).attr("height",function(a,c){return a.height});h.exit().remove();h.append("g").attr("class","axis x").attr("id",function(a,c){return"plot-"+c+"-axis-x"}).attr("transform",function(a){return"translate(0,"+(a.height-d.xAxisPadding)+")"}).each(function(a){"undefined"!==
typeof a.xAxis?d3.select(this).call(a.xAxis):function(){}}).append("text").attr("text-anchor","middle").attr("x",function(a){return d.yAxisPadding+0.5*(a.width-d.yAxisPadding)}).attr("y",function(a){return 0.8*d.xAxisPadding}).text(function(a){return"["+a.data.dimension_units+"]"});h.append("g").attr("class","axis y").attr("id",function(a,c){return"plot-"+c+"-axis-y"}).attr("transform",function(a){return"translate("+d.yAxisPadding+",0)"}).each(function(a){"undefined"!==typeof a.yAxis?d3.select(this).call(a.yAxis):
function(){}}).append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",function(a){return-0.5*(a.height-d.xAxisPadding)}).attr("y",function(a){return-0.8*d.yAxisPadding}).text(function(a){return"["+a.data.value_units+"]"});h.append("svg:rect").attr("class","selectrect").attr("x",d.yAxisPadding).attr("y",function(a){return-d.xAxisPadding}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).style("fill","#fff").style("fill-opacity",0).on("mousedown",
mousedown);h=h.selectAll("g.data").data(function(a,c){for(var d=[],h=0;h<a.data.length;h++)d[h]={data:a.data[h],plot:a,plotid:c};return d});h.enter().insert("g",".selectrect").attr("class","data").attr("clip-path",function(a,c){return"url(#plot-"+c+"-clippath)"}).each(function(a,c){d3.select(this).call(d.plotTypes[a.plot.plotType])});h.exit().remove()};
PlotContainer.prototype.linkAxes=function(d){var h=0<=this.plotGrid[d].bindAxis[0]&&this.plotGrid[d].bindAxis[0]!==d?this.plotGrid[d].bindAxis[0]:d,l=0<=this.plotGrid[d].bindAxis[1]&&this.plotGrid[d].bindAxis[1]!==d?this.plotGrid[d].bindAxis[1]:d;h!==d&&this.plotGrid[d].x.domain(this.plotGrid[h].x.domain());l!==d&&this.plotGrid[d].y.domain(this.plotGrid[l].y.domain())};
PlotContainer.prototype.updatePlot=function(d){var h=this.plotGrid[d].flip,l=[this.yAxisPadding,this.plotGrid[d].width],a=[this.plotGrid[d].height-this.xAxisPadding,0],c=[d3.min(this.plotGrid[d].data,function(a,c){return d3.min(a.data.dimension[0])}),d3.max(this.plotGrid[d].data,function(a,c){return d3.max(a.data.dimension[0])})],c=d3.scale.linear().range(h?a:l).domain(c);this.plotGrid[d].flip?this.plotGrid[d].y=c:this.plotGrid[d].x=c;var c=[d3.min(this.plotGrid[d].data,function(a,c){return 1===a.n_dim?
a.is_minmax?d3.min(a.data.value[a.data.metadata.minmax_min_channel]):d3.min(a.data.value[0]):d3.min(a.data.value[0])}),d3.max(this.plotGrid[d].data,function(a,c){return 1===a.n_dim?a.is_minmax?d3.max(a.data.value[a.data.metadata.minmax_min_channel]):d3.max(a.data.value[0]):d3.max(a.data.value[0])})],g=c[1]-c[0],h=d3.scale.linear().range(h?l:a).domain([c[0]-this.dataPadding*g,c[1]+this.dataPadding*g]);this.plotGrid[d].flip?this.plotGrid[d].x=h:this.plotGrid[d].y=h;this.plotGrid[d].xAxis=d3.svg.axis().scale(this.plotGrid[d].x).orient("bottom").tickSize(1===
this.plotGrid[d].data[0].n_dim?this.plotGrid[d].y.range()[1]-this.plotGrid[d].y.range()[0]:5);this.plotGrid[d].yAxis=d3.svg.axis().scale(this.plotGrid[d].y).orient("left").tickSize(1===this.plotGrid[d].data[0].n_dim?this.plotGrid[d].x.range()[0]-this.plotGrid[d].x.range()[1]:5)};
function fillPlot(d){var h=Array(2*d.data.dimension[0].length);for(i=0;i<d.data.dimension[0].length;i++)h[i]=[d.data.dimension[0][i],d.data.value[d.data.metadata.minmax_min_channel][i]],h[d.data.dimension[0].length+i]=[d.data.dimension[0][d.data.dimension[0].length-(i+1)],d.data.value[d.data.metadata.minmax_max_channel][d.data.dimension[0].length-(i+1)]];return h}function isMinMaxPlot(d){return-1<$.inArray("min",d.labels)&&-1<$.inArray("max",d.labels)&&2==d.labels.length?!0:!1}
function getSpectrogramUri(d){d=new H1DSUri(d);d.addExtraFilter("slanted_baseline",{window:10});d.addExtraFilter("spectrogram",{bin_size:-1});d.addExtraFilter("norm_dim_range_2d",{x_min:0,x_max:1,y_min:0,y_max:0.5});d.addExtraFilter("y_axis_energy_limit",{threshold:0.995});d.extra_non_h1ds_query.format="bin";d.extra_non_h1ds_query.bin_assert_dtype="uint8";return d}
function getPowerspectrumUri(d,h){var l=new H1DSUri(d);l.addExtraFilter("slanted_baseline",{window:10});l.addExtraFilter("power_spectrum",{});l.addExtraFilter("norm_dim_range",{min:0,max:0.5});l.addExtraFilter("resample_minmax",{n_bins:h});l.extra_non_h1ds_query.format="json";return l}function getRawUri(d,h){var l=new H1DSUri(d);l.addExtraFilter("resample_minmax",{n_bins:h});l.extra_non_h1ds_query.format="json";return l}
ProcessH1DSHeaders=function(d){d=d.split("\n");for(var h={},l=0;l<d.length;l++){var a=d[l].split(":");2===a.length&&a[0].match("^X-H1DS")&&(h[a[0]]=$.trim(a[1]))}return h};
ProcessBinaryData=function(d,h){for(var l=new Uint8Array(str2ab(d)),a=parseInt(h["X-H1DS-ndim"]),c=0,g={data:[],dim:[],n_dim:a},m=0;m<a;m++){g.dim[m]=[];for(var f=parseInt(h["X-H1DS-dim-"+m+"-length"]),s=parseFloat(h["X-H1DS-dim-"+m+"-delta"]),v=parseFloat(h["X-H1DS-dim-"+m+"-first"]),z=0;z<f;z++)g.dim[m][z]=s*z+v}m=parseFloat(h["X-H1DS-data-delta"]);f=parseFloat(h["X-H1DS-data-min"]);if(0<a)for(s=parseInt(h["X-H1DS-dim-0-length"]),parseFloat(h["X-H1DS-dim-0-delta"]),parseFloat(h["X-H1DS-dim-0-first"]),
v=0;v<s;v++)if(1<a){g.data[v]=[];z=parseInt(h["X-H1DS-dim-1-length"]);parseFloat(h["X-H1DS-dim-1-delta"]);parseFloat(h["X-H1DS-dim-1-first"]);for(var t=0;t<z;t++)if(2<a){g.data[v][t]=[];var w=parseInt(h["X-H2DS-dim-2-length"]);parseFloat(h["X-H1DS-dim-2-delta"]);parseFloat(h["X-H1DS-dim-2-first"]);for(var Q=0;Q<w;Q++)g.data[v][t][Q]=m*l[c]+f,c++}else g.data[v][t]=l[c],c++}else g.data[v]=m*l[c]+f,c++;return g};function ab2str(d){return String.fromCharCode.apply(null,new Uint8Array(d))}
function str2ab(d){for(var h=new ArrayBuffer(d.length),l=new Uint8Array(h),a=0,c=d.length;a<c;a++)l[a]=d.charCodeAt(a);return h}function populatePagelet(d,h){var l=new H1DSUri(h);l.non_h1ds_query.format="json";var l=l.renderUri(),a=d.attr("data-dtype"),c=d.attr("data-ndim");getPlotFunction(a,c)(d.attr("id"),l)}function getPlotFunction(d,h){switch(h){case "1":return plot1DimArray;case "2":return plot2DimArray}}
function plot1DimArray(d,h){var l=new PlotContainer("#"+d,[500],[1]);l.addData("default",h);l.setPlot(0,{plotType:"raw"});l.addDataToPlot("default",0,!0)}function plot2DimArray(d,h){var l=new PlotContainer("#"+d,[500],[1]);l.addData("default",h);l.setPlot(0,{plotType:"raw2d"});l.addDataToPlot("default",0,!0)}function loadPlotState(){plotState.settings={edit_mode:!1,worksheet_mode:!1};plotState.url_cache={};plotState.pagelets=[];$(".h1ds-pagelet").each(function(d,h){loadPageletPlotState(d,h)})}
function loadPageletPlotStateFromURL(d,h){plotState.pagelets[d]=null}
function loadDefaultPageletPlotState(d,h){var l={},a=window.location.toString(),c=$(h);l.margin={top:1,right:1,bottom:1,left:1};l.n_rows=10;l.n_columns=10;l.width=c.width()-l.margin.left-l.margin.right;l.height=Math.round(d3.min([l.width/golden_ratio,0.9*$(window).height()]));l.dtype=c.attr("data-dtype");l.ndim=c.attr("data-ndim");chart_state={x0:0,y0:0,x1:10,y1:10,chart_type:"raw"};chart_state.chart_width=(chart_state.x1-chart_state.x0)/l.n_columns*l.width;chart_state.stateIndex=[0,0];chart_state.data=
[{}];chart_state.data[0].uri=getRawUri(a,chart_state.chart_width);chart_state.data[0].data=null;l.charts=[chart_state];plotState.pagelets[d]=l;$.ajax({url:plotState.pagelets[d].charts[0].data[0].uri.renderExtraUri(),dataType:"json",async:!0}).done(function(a){plotState.pagelets[d].charts[0].data[0].data=a;updateCharts()})}function loadPageletPlotState(d,h){$(h);loadPageletPlotStateFromURL(d,h);null===plotState.pagelets[d]&&loadDefaultPageletPlotState(d,h)}
d3.chart("H1DSBaseChart",{initialize:function(){var d=this,h=this.base.append("g").classed("graph-background",!0);d.main=d.base.append("g").attr("class","chart-main");d.brush=d3.svg.brush();d.margin={top:10,right:10,bottom:10,left:10};d._width=100;d._height=100;this.set_margin=function(h){var a=d._width+d.margin.left+d.margin.right,c=d._height+d.margin.bottom+d.margin.top;d.margin=h;d.base.select("g.chart-main").attr("transform","translate("+d.margin.left+","+d.margin.top+")");d._width=a-d.margin.left-
d.margin.right;d._height=c-d.margin.top-d.margin.bottom};this.set_margin({top:10,right:10,bottom:10,left:10});this.layer("background",h,{dataBind:function(d){return this.selectAll("rect.background").data([d])},insert:function(){return this.insert("rect").attr("class","background").attr("x",0).attr("y",0).attr("width",d._width+d.margin.left+d.margin.right).attr("height",d._height+d.margin.top+d.margin.bottom)}})},width:function(d){if(!arguments.length)return this._width+this.margin.left+this.margin.right;
this._width=d-this.margin.left-this.margin.right;this.base.select("g rect.background").attr("width",d);return this},height:function(d){if(!arguments.length)return this._height+this.margin.top+this.margin.bottom;this._height=d-this.margin.top-this.margin.bottom;this.base.select("g rect.background").attr("y",d).attr("height",d);return this}});
d3.chart("H1DSBaseChart").extend("H1DSTestChart",{initialize:function(){var d=this;this.set_margin({top:50,right:50,bottom:50,left:50});this.xScale=d3.scale.linear().range([0,d._width]);this.yScale=d3.scale.linear().range([d._height,0]);this.xAxis=d3.svg.axis().scale(this.xScale).orient("bottom");this.yAxis=d3.svg.axis().scale(this.yScale).orient("left");this.colors=d3.scale.category20();this.layer("xAxis",d.main.append("g"),{dataBind:function(a){d.data=a[0];return this.selectAll("g.x.axis").data([a])},
insert:function(){return this.insert("g").attr("class","x axis").attr("transform",function(a){return"translate(0,"+d._height+")"})},events:{merge:function(){d.xScale.range([0,d._width]).domain([d3.min(d.data.dimension,function(a){return d3.min(a)}),d3.max(d.data.dimension,function(a){return d3.max(a)})]);return this.call(d.xAxis)},enter:function(){d.xScale.range([0,d._width]).domain([d3.min(d.data.dimension,function(a){return d3.min(a)}),d3.max(d.data.dimension,function(a){return d3.max(a)})]);return this.call(d.xAxis)},
exit:function(){return this.remove()}}});this.layer("yAxis",d.main.append("g"),{dataBind:function(a){d.data=a[0];return this.selectAll("g.y.axis").data([a])},insert:function(){return this.append("g").attr("class","y axis").attr("transform",function(a){return"translate(0,0)"})},events:{merge:function(){var a=d3.min(d.data.value,function(a){return d3.min(a)}),g=d3.max(d.data.value,function(a){return d3.max(a)}),h=0.05*(g-a);d.yScale.range([d._height,0]).domain([a-h,g+h]);return this.call(d.yAxis)},
enter:function(){var a=d3.min(d.data.value,function(a){return d3.min(a)}),g=d3.max(d.data.value,function(a){return d3.max(a)}),h=0.05*(g-a);d.yScale.range([d._height,0]).domain([a-h,g+h]);return this.call(d.yAxis)},exit:function(){return this.remove()}}});var h=d3.svg.line().x(function(a){return d.xScale(a[0])}).y(function(a){return d.yScale(a[1])}),l=function(a){var d=[],h=0;"undefined"!==typeof a.metadata.minmax_pairs&&(h=a.metadata.minmax_pairs.length);var f=d3.range(a.value.length);if(0<h)for(var l=
0;l<h;l++){f.splice(f.indexOf(a.metadata.minmax_pairs[l][0]),1);f.splice(f.indexOf(a.metadata.minmax_pairs[l][1]),1);for(var v=[],z=0;z<a.value[a.metadata.minmax_pairs[l][0]].length;z++)v.push([a.dimension[0][z],a.value[a.metadata.minmax_pairs[l][0]][z]]);for(z=a.value[a.metadata.minmax_pairs[l][1]].length-1;0<=z;z--)v.push([a.dimension[0][z],a.value[a.metadata.minmax_pairs[l][1]][z]]);v.closeLine=!0;v.fillLine=!0;d.push(v)}for(l=0;l<f.length;l++){h=f[l];v=[];for(z=0;z<a.value[h].length;z++)v.push([a.dimension[0][z],
a.value[h][z]]);v.closeLine=!1;v.fillLine=!1;d.push(v)}return d};this.layer("data",d.main.append("g"),{dataBind:function(a){d.data=a[0];return this.selectAll("path.signal").data(l(d.data))},insert:function(){return this.append("path")},events:{merge:function(){return this.attr("class","signal").style("stroke",function(a,g){return d.colors(2*g)}).style("fill",function(a,g){return a.fillLine?d.colors(2*g+1):"none"}).attr("d",function(a,d){return h(a)+(a.closeLine?"Z":"")})},enter:function(){return this.attr("class",
"signal").style("stroke",function(a,g){return d.colors(2*g)}).style("fill",function(a,g){return a.fillLine?d.colors(2*g+1):"none"}).attr("d",function(a,d){return h(a)+(a.closeLine?"Z":"")})},exit:function(){return this.remove()}}});var a=function(){var a=plotState.pagelets[0].charts[0].data[0].uri,g={min:d.brush.extent()[0],max:d.brush.extent()[1]},a=new H1DSUri(a.base_uri);a.updateOrAddBaseFilter("dim_range",g);a=getRawUri(a.renderBaseUri(),d._width+d.margin.left+d.margin.right);plotState.pagelets[0].charts[0].data[0].uri=
a;$.ajax({url:a.renderExtraUri(),dataType:"json",async:!1}).done(function(a){plotState.pagelets[0].charts[0].data[0].data=a;d.draw([a.data])})};this.layer("interactive",d.main,{dataBind:function(a){d.data=a[0];return this.selectAll("g.brush").data([d.data])},insert:function(){d.brush.clear();return this.append("g").attr("class","brush")},events:{merge:function(){d.brush=d3.svg.brush().x(d.xScale).on("brushend",a);return this.call(d.brush).selectAll("rect").attr("y",0).attr("height",d._height)}}})}});
d3.chart("H1DSEditModeChart",{initialize:function(){var d=function(d){};this.layer("background",this.base.append("g"),{dataBind:function(d){return this.selectAll("rect.background").data([d])},insert:function(){return this.insert("rect").attr("class","background-edit").attr("x",function(d){return d.x0px}).attr("y",function(d){return d.y1px}).attr("width",function(d){return d.x1px-d.x0px}).attr("height",function(d){return d.y0px-d.y1px})}});d=function(d){var l=d.x1px-d.x0px-30,a=d.y0px-d.y1px-30;return[{x:d.x0px,
y:d.y1px+15,width:15,height:a,"class":"resizebar edge rb_x"},{x:d.x1px-15,y:d.y1px+15,width:15,height:a,"class":"resizebar edge rb_x"},{x:d.x0px+15,y:d.y1px,width:l,height:15,"class":"resizebar edge rb_y"},{x:d.x0px+15,y:d.y0px-15,width:l,height:15,"class":"resizebar edge rb_y"},{x:d.x0px,y:d.y1px,width:15,height:15,"class":"resizebar corner rb_x rb_y"},{x:d.x1px-15,y:d.y1px,width:15,height:15,"class":"resizebar corner rb_x rb_y"},{x:d.x0px,y:d.y0px-15,width:15,height:15,"class":"resizebar corner rb_x rb_y"},
{x:d.x1px-15,y:d.y0px-15,width:15,height:15,"class":"resizebar corner rb_x rb_y"}]};this.layer("resizeedges",this.base.append("g"),{dataBind:function(h){return this.selectAll("rect.resizebar ").data(d(h))},events:{enter:function(){this.on("click",function(){console.log("xx events")})}},insert:function(){return this.insert("rect").attr("class",function(d){return d["class"]}).attr("x",function(d){return d.x}).attr("y",function(d){return d.y}).attr("width",function(d){return d.width}).attr("height",
function(d){return d.height})}})}});
function updateCharts(){d3.selectAll("#h1ds-portlet-data div.portlet-content").data(plotState.pagelets).append("svg").attr("width",function(d){return d.width+d.margin.left+d.margin.right}).attr("height",function(d){return d.height+d.margin.top+d.margin.bottom}).append("g").attr("transform",function(d){return"translate("+d.margin.left+","+d.margin.top+")"}).each(function(d,h){d.column_width=d.width/d.n_columns;d.row_height=d.height/d.n_rows;d.xScale=d3.scale.linear().domain([0,d.n_columns]).range([0,
d.width]);d.yScale=d3.scale.linear().domain([0,d.n_rows]).range([d.height,0]);for(var l=d3.select(this).append("g").attr("class","pagelet-grid"),a=0;a<=d.n_columns;a++)l.append("line").attr("x1",function(){return Math.round(a*d.column_width)}).attr("x2",function(){return Math.round(a*d.column_width)}).attr("y1",0).attr("y2",d.height);for(a=0;a<=d.n_rows;a++)l.append("line").attr("x1",0).attr("x2",d.width).attr("y1",function(){return Math.round(a*d.row_height)}).attr("y2",function(){return Math.round(a*
d.row_height)});for(a=0;a<d.charts.length;a++)d.charts[a].x0px=d.xScale(d.charts[a].x0),d.charts[a].x1px=d.xScale(d.charts[a].x1),d.charts[a].y0px=d.yScale(d.charts[a].y0),d.charts[a].y1px=d.yScale(d.charts[a].y1),!0==plotState.settings.edit_mode?(l=d3.select(this).append("g").attr("transform","translate("+d.charts[a].x0px+","+d.charts[a].y1px+")").chart("H1DSEditModeChart"),console.log(d.charts[a].x1px-d.charts[a].x0px),l.width(d.charts[a].x1px-d.charts[a].x0px),l.height(d.charts[a].y1px-d.charts[a].y0px),
l.draw(d.charts[a])):(l=d3.select(this).append("g").attr("class","chart").attr("transform","translate("+d.charts[a].x0px+","+d.charts[a].y1px+")").chart("H1DSTestChart"),l.width(d.charts[a].x1px-d.charts[a].x0px),l.height(d.charts[a].y0px-d.charts[a].y1px),l.draw([d.charts[a].data[0].data.data]))})}var plotState={};$(document).ready(function(){$("#main").scrollView();autoPollSummaryDB();loadCookie();loadPlotState()});
