window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var f=[].slice.call(arguments);"object"===typeof console.log?log.apply.call(console.log,console,f):console.log.apply(console,f)}};
(function(f){function l(){}for(var n="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log timeStamp profile profileEnd time timeEnd trace warn".split(" "),a;a=n.pop();)f[a]=f[a]||l})(function(){try{return console.log(),window.console}catch(f){return window.console={}}}());
function parseUri(f){var l=parseUri.options;f=l.parser[l.strictMode?"strict":"loose"].exec(f);for(var n={},a=14;a--;)n[l.key[a]]=f[a]||"";n[l.q.name]={};n[l.key[12]].replace(l.q.parser,function(a,e,g){e&&(n[l.q.name][e]=g)});return n}
parseUri.options={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
function makeUri(f){var l="";f.protocol&&(l+=f.protocol+"://");f.user&&(l+=f.user);f.password&&(l+=":"+f.password);if(f.user||f.password)l+="@";f.host&&(l+=f.host);f.port&&(l+=":"+f.port);f.path&&(l+=f.path);var n=f.queryKey,a=[];for(k in n)if(n.hasOwnProperty(k)){var c=encodeURIComponent(n[k]);k=encodeURIComponent(k);c?a.push(k+"="+c):a.push(k)}0<a.length&&(l+="?"+a.join("&"));f.anchor&&(l+="#"+f.anchor);return l}
(function(f){function l(l){if("string"===typeof l.data){var a=l.handler,c=l.data.toLowerCase().split(" ");l.handler=function(e){if(!(this!==e.target&&(/textarea|select/i.test(e.target.nodeName)||"text"===e.target.type))){var g="keypress"!==e.type&&f.hotkeys.specialKeys[e.which],q=String.fromCharCode(e.which).toLowerCase(),v="",R={};e.altKey&&"alt"!==g&&(v+="alt+");e.ctrlKey&&"ctrl"!==g&&(v+="ctrl+");e.metaKey&&(!e.ctrlKey&&"meta"!==g)&&(v+="meta+");e.shiftKey&&"shift"!==g&&(v+="shift+");g?R[v+g]=
!0:(R[v+q]=!0,R[v+f.hotkeys.shiftNums[q]]=!0,"shift+"===v&&(R[f.hotkeys.shiftNums[q]]=!0));g=0;for(q=c.length;g<q;g++)if(R[c[g]])return a.apply(this,arguments)}}}}f.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",
109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};f.each(["keydown","keyup","keypress"],function(){f.event.special[this]={add:l}})})(jQuery);"use strict";
(function(){if(!jQuery||!jQuery.jstree){var f=!1,l=!1,n=!1;(function(a){a.vakata={};a.vakata.css={get_css:function(a,c,e){a=a.toLowerCase();var q=e.cssRules||e.rules,g=0;do{if(q.length&&g>q.length+5)break;if(q[g].selectorText&&q[g].selectorText.toLowerCase()==a)return!0===c?(e.removeRule&&e.removeRule(g),e.deleteRule&&e.deleteRule(g),!0):q[g]}while(q[++g]);return!1},add_css:function(c,e){if(a.jstree.css.get_css(c,!1,e))return!1;e.insertRule?e.insertRule(c+" { }",0):e.addRule(c,null,0);return a.vakata.css.get_css(c)},
remove_css:function(c,e){return a.vakata.css.get_css(c,!0,e)},add_sheet:function(c){var e=!1,q=!0;if(c.str)return c.title&&(e=a("style[id='"+c.title+"-stylesheet']")[0]),e?q=!1:(e=document.createElement("style"),e.setAttribute("type","text/css"),c.title&&e.setAttribute("id",c.title+"-stylesheet")),e.styleSheet?q?(document.getElementsByTagName("head")[0].appendChild(e),e.styleSheet.cssText=c.str):e.styleSheet.cssText=e.styleSheet.cssText+" "+c.str:(e.appendChild(document.createTextNode(c.str)),document.getElementsByTagName("head")[0].appendChild(e)),
e.sheet||e.styleSheet;if(c.url)if(document.createStyleSheet)try{document.createStyleSheet(c.url)}catch(g){}else return e=document.createElement("link"),e.rel="stylesheet",e.type="text/css",e.media="all",e.href=c.url,document.getElementsByTagName("head")[0].appendChild(e),e.styleSheet}};var c=[],e=-1,g={},q={};a.fn.jstree=function(v){var e="string"==typeof v,q=Array.prototype.slice.call(arguments,1),f=this;if(e){if("_"==v.substring(0,1))return f;this.each(function(){var e=c[a.data(this,"jstree_instance_id")],
e=e&&a.isFunction(e[v])?e[v].apply(e,q):e;if("undefined"!==typeof e&&(0===v.indexOf("is_")||!0!==e&&!1!==e))return f=e,!1})}else this.each(function(){var e=a.data(this,"jstree_instance_id"),R=[],f=v?a.extend({},!0,v):{},l=a(this),y=!1,n=[],R=R.concat(q);l.data("jstree")&&R.push(l.data("jstree"));f=R.length?a.extend.apply(null,[!0,f].concat(R)):f;"undefined"!==typeof e&&c[e]&&c[e].destroy();e=parseInt(c.push({}),10)-1;a.data(this,"jstree_instance_id",e);f.plugins=a.isArray(f.plugins)?f.plugins:a.jstree.defaults.plugins.slice();
f.plugins.unshift("core");f.plugins=f.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");y=a.extend(!0,{},a.jstree.defaults,f);y.plugins=f.plugins;a.each(g,function(c,v){-1===a.inArray(c,y.plugins)?(y[c]=null,delete y[c]):n.push(c)});y.plugins=n;c[e]=new a.jstree._instance(e,a(this).addClass("jstree jstree-"+e),y);a.each(c[e]._get_settings().plugins,function(a,v){c[e].data[v]={}});a.each(c[e]._get_settings().plugins,function(a,v){g[v]&&
g[v].__init.apply(c[e])});setTimeout(function(){c[e]&&c[e].init()},0)});return f};a.jstree={defaults:{plugins:[]},_focused:function(){return c[e]||null},_reference:function(v){if(c[v])return c[v];var e=a(v);!e.length&&"string"===typeof v&&(e=a("#"+v));return!e.length?null:c[e.closest(".jstree").data("jstree_instance_id")]||null},_instance:function(c,e,q){this.data={core:{}};this.get_settings=function(){return a.extend(!0,{},q)};this._get_settings=function(){return q};this.get_index=function(){return c};
this.get_container=function(){return e};this.get_container_ul=function(){return e.children("ul:eq(0)")};this._set_settings=function(c){q=a.extend(!0,{},q,c)}},_fn:{},plugin:function(c,e){e=a.extend({},{__init:a.noop,__destroy:a.noop,_fn:{},defaults:!1},e);g[c]=e;a.jstree.defaults[c]=e.defaults;a.each(e._fn,function(e,q){q.plugin=c;q.old=a.jstree._fn[e];a.jstree._fn[e]=function(){var c,v=q,g=Array.prototype.slice.call(arguments);c=new a.Event("before.jstree");var R=!1;if(!(!0===this.data.core.locked&&
"unlock"!==e&&"is_locked"!==e)){do{if(v&&v.plugin&&-1!==a.inArray(v.plugin,this._get_settings().plugins))break;v=v.old}while(v);if(v){if(0===e.indexOf("_"))c=v.apply(this,g);else{c=this.get_container().triggerHandler(c,{func:e,inst:this,args:g,plugin:v.plugin});if(!1===c)return;"undefined"!==typeof c&&(g=c);c=v.apply(a.extend({},this,{__callback:function(a){this.get_container().triggerHandler(e+".jstree",{inst:this,args:g,rslt:a,rlbk:R})},__rollback:function(){return R=this.get_rollback()},__call_old:function(a){return v.old.apply(this,
a?Array.prototype.slice.call(arguments,1):g)}}),g)}return c}}};a.jstree._fn[e].old=q.old;a.jstree._fn[e].plugin=c})},rollback:function(v){v&&(a.isArray(v)||(v=[v]),a.each(v,function(a,v){c[v.i].set_rollback(v.h,v.d)}))}};a.jstree._fn=a.jstree._instance.prototype={};a(function(){var c=navigator.userAgent.toLowerCase(),e=(c.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],q=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(c)&&6==parseInt(e,10)){f=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(g){}q+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(c)&&
7==parseInt(e,10)&&(l=!0,q+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(c)&&(/mozilla/.test(c)&&1.9>parseFloat(e,10))&&(n=!0,q+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");a.vakata.css.add_sheet({str:q,title:"jstree"})});a.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=
this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+
this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",a.proxy(function(c){c=a(c.target);this.toggle_node(c)},this)).bind("mousedown.jstree",a.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){a=window.getSelection();
try{a.removeAllRanges(),a.collapse()}catch(c){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",a.proxy(function(c,e){var q=this._get_node(e.rslt.obj),g=this;-1===q&&(q=this.get_container_ul());q.length&&q.find("li").each(function(){var c=a(this);c.data("jstree")&&a.each(c.data("jstree"),function(v,e){g.data[v]&&a.isFunction(g["_"+v+"_notify"])&&g["_"+v+"_notify"].call(g,c,e)})})},this));this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",
a.proxy(function(c,e){var q=this._get_node(e.rslt.obj),g=this;-1===q&&(q=this.get_container_ul());q.length&&q.find("li.jstree-open:not(:has(ul))").each(function(){g.load_node(this,a.noop,a.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var v,q=this.get_index(),f=this._get_settings(),l=this;a.each(f.plugins,function(a,c){try{g[c].__destroy.apply(l)}catch(v){}});this.__callback();if(this.is_focused())for(v in c)if(c.hasOwnProperty(v)&&
v!=q){c[v].set_focus();break}q===e&&(e=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});a(document).unbind(".jstree-"+q).undelegate(".jstree-"+q);c[q]=null;delete c[q]},_core_notify:function(a,c){c.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity",
"0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:"))});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(c){var e=this,q=!0,g=[],f=[];c||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=a.map(a.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=a.map(a.makeArray(this.data.core.to_load),function(a){return"#"+
a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(a.each(this.data.core.to_load,function(c,v){if("#"==v)return!0;a(v).length?g.push(v):f.push(v)}),g.length&&(this.data.core.to_load=f,a.each(g,function(a,c){e._is_loaded(c)||(e.load_node(c,function(){e.reload_nodes(!0)},function(){e.reload_nodes(!0)}),
q=!1)})));this.data.core.to_open.length&&a.each(this.data.core.to_open,function(a,c){e.open_node(c,!1,!0)});q&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){e.__callback({},e)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var c=this;this.data.core.to_open.length&&a.each(this.data.core.to_open,function(a,e){c.open_node(e,!1,!0)});this.__callback({})},refresh:function(a){var c=this;this.save_opened();a||(a=-1);(a=this._get_node(a))||
(a=-1);-1!==a?a.children("UL").remove():this.get_container_ul().empty();this.load_node(a,function(){c.__callback({obj:a});c.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var c=a.jstree._focused();c&&c.unset_focus();this.get_container().addClass("jstree-focused");e=this.get_index();this.__callback()}},is_focused:function(){return e==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),e=
-1);this.__callback()},_get_node:function(c){var e=a(c,this.get_container());if(e.is(".jstree")||-1==c)return-1;e=e.closest("li",this.get_container());return e.length?e:!1},_get_next:function(a,c){a=this._get_node(a);return-1===a?this.get_container().find("> ul > li:first-child"):!a.length?!1:c?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0)},_get_prev:function(a,
c){a=this._get_node(a);if(-1===a)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(c)return 0<a.prevAll("li").length?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){for(a=a.prev("li").eq(0);a.hasClass("jstree-open");)a=a.children("ul:eq(0)").children("li:last");return a}var e=a.parentsUntil(".jstree","li:eq(0)");return e.length?e:!1},_get_parent:function(a){a=this._get_node(a);if(-1==a||!a.length)return!1;a=a.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},
_get_children:function(a){a=this._get_node(a);return-1===a?this.get_container().children("ul:eq(0)").children("li"):!a.length?!1:a.children("ul:eq(0)").children("li")},get_path:function(a,c){var e=[],q=this;a=this._get_node(a);if(-1===a||!a||!a.length)return!1;a.parentsUntil(".jstree","li").each(function(){e.push(c?this.id:q.get_text(this))});e.reverse();e.push(c?a.attr("id"):this.get_text(a));return e},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return(a=
this._get_node(a))&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||-1===a)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(a,c,e){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return c&&
c.call(),!1;var q=e||f?0:this._get_settings().core.animation,g=this;this._is_loaded(a)?(this._get_settings().core.open_parents&&a.parentsUntil(".jstree",".jstree-closed").each(function(){g.open_node(this,!1,!0)}),q&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),q?a.children("ul").stop(!0,!0).slideDown(q,function(){this.style.display="";g.after_open(a)}):g.after_open(a),this.__callback({obj:a}),c&&c.call()):
(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){g.open_node(a,c,e)},c))},after_open:function(a){this.__callback({obj:a})},close_node:function(a,c){a=this._get_node(a);var e=c||f?0:this._get_settings().core.animation,q=this;if(!a.length||!a.hasClass("jstree-open"))return!1;e&&a.children("ul").attr("style","display:block !important");a.removeClass("jstree-open").addClass("jstree-closed");e?a.children("ul").stop(!0,!0).slideUp(e,function(){this.style.display="";q.after_close(a)}):
q.after_close(a);this.__callback({obj:a})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,c,e){a=a?this._get_node(a):-1;if(!a||-1===a)a=this.get_container_ul();e?a=a.find("li.jstree-closed"):(e=a,a=a.is(".jstree-closed")?a.find("li.jstree-closed").addBack():a.find("li.jstree-closed"));var q=this;a.each(function(){var a=this;
q._is_loaded(this)?q.open_node(this,!1,!c):q.open_node(this,function(){q.open_all(a,c,e)},!c)});0===e.find("li.jstree-closed").length&&this.__callback({obj:e})},close_all:function(a,c){var e=this;a=a?this._get_node(a):this.get_container();if(!a||-1===a)a=this.get_container_ul();a.find("li.jstree-open").addBack().each(function(){e.close_node(this,!c)});this.__callback({obj:a})},clean_node:function(c){c=c&&-1!=c?a(c):this.get_container_ul();c=c.is("li")?c.find("li").addBack():c.find("li");c.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");
c.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:c})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,c){this.get_container().empty().append(a);this.data=c;this.__callback()},load_node:function(a,c,e){this.__callback({obj:a})},_is_loaded:function(a){return!0},create_node:function(c,e,q,g,f){c=this._get_node(c);e="undefined"===typeof e?
"last":e;var x=a("<li />"),l=this._get_settings().core,n;if(-1!==c&&!c.length)return!1;if(!f&&!this._is_loaded(c))return this.load_node(c,function(){this.create_node(c,e,q,g,!0)}),!1;this.__rollback();"string"===typeof q&&(q={data:q});q||(q={});q.attr&&x.attr(q.attr);q.metadata&&x.data(q.metadata);q.state&&x.addClass("jstree-"+q.state);q.data||(q.data=this._get_string("new_node"));a.isArray(q.data)||(n=q.data,q.data=[],q.data.push(n));a.each(q.data,function(c,e){n=a("<a />");a.isFunction(e)&&(e=e.call(this,
q));if("string"==typeof e)n.attr("href","#")[l.html_titles?"html":"text"](e);else e.attr||(e.attr={}),e.attr.href||(e.attr.href="#"),n.attr(e.attr)[l.html_titles?"html":"text"](e.title),e.language&&n.addClass(e.language);n.prepend("<ins class='jstree-icon'>&#160;</ins>");!e.icon&&q.icon&&(e.icon=q.icon);e.icon&&(-1===e.icon.indexOf("/")?n.children("ins").addClass(e.icon):n.children("ins").css("background","url('"+e.icon+"') center center no-repeat"));x.append(n)});x.prepend("<ins class='jstree-icon'>&#160;</ins>");
-1===c&&(c=this.get_container(),"before"===e&&(e="first"),"after"===e&&(e="last"));switch(e){case "before":c.before(x);n=this._get_parent(c);break;case "after":c.after(x);n=this._get_parent(c);break;case "inside":case "first":c.children("ul").length||c.append("<ul />");c.children("ul").prepend(x);n=c;break;case "last":c.children("ul").length||c.append("<ul />");c.children("ul").append(x);n=c;break;default:c.children("ul").length||c.append("<ul />"),e||(e=0),n=c.children("ul").children("li").eq(e),
n.length?n.before(x):c.children("ul").append(x),n=c}if(-1===n||n.get(0)===this.get_container().get(0))n=-1;this.clean_node(n);this.__callback({obj:x,parent:n});g&&g.call(this,x);return x},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var c=this._get_settings().core.html_titles;a=a.children("a:eq(0)");if(c)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];return a.nodeValue},set_text:function(a,c){a=this._get_node(a);
if(!a.length)return!1;a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var e=a.children("INS").clone();a.html(c).prepend(e);this.__callback({obj:a,name:c});return!0}a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,name:c});return a.nodeValue=c},rename_node:function(a,c){a=this._get_node(a);this.__rollback();a&&(a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments)))&&this.__callback({obj:a,name:c})},delete_node:function(c){c=
this._get_node(c);if(!c.length)return!1;this.__rollback();var e=this._get_parent(c),q=a([]),g=this;c.each(function(){q=q.add(g._get_prev(this))});c=c.detach();-1!==e&&0===e.find("> ul > li").length&&e.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(e);this.__callback({obj:c,prev:q,parent:e});return c},prepare_move:function(c,e,g,f,l){var x={};x.ot=a.jstree._reference(c)||this;x.o=x.ot._get_node(c);x.r=-1===e?-1:this._get_node(e);x.p="undefined"===typeof g||!1===g?
"last":g;if(l||!q.o||!(q.o[0]===x.o[0]&&q.r[0]===x.r[0]&&q.p===x.p)){x.ot=a.jstree._reference(x.o)||this;x.rt=a.jstree._reference(x.r)||this;if(-1===x.r||!x.r)switch(x.cr=-1,x.p){case "first":case "before":case "inside":x.cp=0;break;case "after":case "last":x.cp=x.rt.get_container().find(" > ul > li").length;break;default:x.cp=x.p}else{if(!/^(before|after)$/.test(x.p)&&!this._is_loaded(x.r))return this.load_node(x.r,function(){this.prepare_move(c,e,g,f,!0)});switch(x.p){case "before":x.cp=x.r.index();
x.cr=x.rt._get_parent(x.r);break;case "after":x.cp=x.r.index()+1;x.cr=x.rt._get_parent(x.r);break;case "inside":case "first":x.cp=0;x.cr=x.r;break;case "last":x.cp=x.r.find(" > ul > li").length;x.cr=x.r;break;default:x.cp=x.p,x.cr=x.r}}x.np=-1==x.cr?x.rt.get_container():x.cr;x.op=x.ot._get_parent(x.o);x.cop=x.o.index();-1===x.op&&(x.op=x.ot?x.ot.get_container():this.get_container());!/^(before|after)$/.test(x.p)&&(x.op&&x.np&&x.op[0]===x.np[0]&&x.o.index()<x.cp)&&x.cp++;x.or=x.np.find(" > ul > li:nth-child("+
(x.cp+1)+")");q=x}this.__callback(q);f&&f.call(this,q)},check_move:function(){var a=q,c=!0,e=-1===a.r?this.get_container():a.r;if(!a||!a.o||a.or[0]===a.o[0])return!1;if(!a.cy){if(a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(-1!==e.parentsUntil(".jstree","li").addBack().index(this))return c=!1})}return c},move_node:function(c,e,g,f,l,x){if(!l)return this.prepare_move(c,e,g,function(a){this.move_node(a,!1,!1,f,!0,x)});f&&(q.cy=!0);if(!x&&!this.check_move())return!1;
this.__rollback();e=!1;f?(e=c.o.clone(!0),e.find("*[id]").addBack().each(function(){this.id&&(this.id="copy_"+this.id)})):e=c.o;c.or.length?c.or.before(e):(c.np.children("ul").length||a("<ul />").appendTo(c.np),c.np.children("ul:eq(0)").append(e));try{c.ot.clean_node(c.op),c.rt.clean_node(c.np),c.op.find("> ul > li").length||c.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(n){}f&&(q.cy=!0,q.oc=e);this.__callback(q);return q},_get_move:function(){return q}}})})(jQuery);
(function(a){var c,e,g;a(function(){/msie/.test(navigator.userAgent.toLowerCase())?(e=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),g=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),c=e.width()-g.width(),e.add(g).remove()):(e=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200}),c=100-e.width(),e.parent().remove())});a.jstree.plugin("ui",{__init:function(){this.data.ui.selected=a();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",a.proxy(function(c){c.preventDefault();c.currentTarget.blur();a(c.currentTarget).hasClass("jstree-loading")||this.select_node(c.currentTarget,!0,c)},this)).delegate("a","mouseenter.jstree",a.proxy(function(c){a(c.currentTarget).hasClass("jstree-loading")||
this.hover_node(c.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(c){a(c.currentTarget).hasClass("jstree-loading")||this.dehover_node(c.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(c,e){var g=this._get_settings().ui,f=this._get_node(e.rslt.obj),
l=f&&f.length?f.children("ul").find("a.jstree-clicked"):a(),n=this;!1!==g.selected_parent_close&&l.length&&l.each(function(){n.deselect_node(this);"select_parent"===g.selected_parent_close&&n.select_node(f)})},this)).bind("delete_node.jstree",a.proxy(function(a,c){var e=this._get_settings().ui.select_prev_on_delete,g=this._get_node(c.rslt.obj),g=g&&g.length?g.find("a.jstree-clicked"):[],f=this;g.each(function(){f.deselect_node(this)});e&&g.length&&c.rslt.prev.each(function(){if(this.parentNode)return f.select_node(this),
!1})},this)).bind("move_node.jstree",a.proxy(function(a,c){c.rslt.cy&&c.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(c,e){if("undefined"===typeof c||null===c)return e?this.data.ui.selected:this.data.ui.last_selected;var g=a(c,
this.get_container());if(g.is(".jstree")||-1==c)return-1;g=g.closest("li",this.get_container());return g.length?g:!1},_ui_notify:function(a,c){c.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},
reselect:function(){var c=this,e=this.data.ui.to_select,e=a.map(a.makeArray(e),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});a.each(e,function(a,e){e&&"#"!==e&&c.select_node(e)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(a){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);
if(!a.length)return!1;a.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,c;if(!a||!a.length)return!1;c=a.children("a").removeClass("jstree-hovered").parent();this.data.ui.hovered[0]===c[0]&&(this.data.ui.hovered=null);this.__callback({obj:a})},select_node:function(a,c,e){a=this._get_node(a);if(-1==a||!a||!a.length)return!1;var g=this._get_settings().ui,
f="on"==g.select_multiple_modifier||!1!==g.select_multiple_modifier&&e&&e[g.select_multiple_modifier+"Key"],l=!1!==g.select_range_modifier&&e&&e[g.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],x=this.is_selected(a),n=!0,O=this;if(c){if(g.disable_selecting_children&&f&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;
n=!1;switch(!0){case l:this.data.ui.last_selected.addClass("jstree-last-selected");a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").addBack();-1==g.select_limit||a.length<g.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==O.data.ui.last_selected[0]&&O.deselect_node(this)}),x=!1,n=!0):n=!1;break;case x&&!f:this.deselect_all();x=!1;n=!0;break;case !x&&!f:if(-1==g.select_limit||
0<g.select_limit)this.deselect_all(),n=!0;break;case x&&f:this.deselect_node(a);break;case !x&&f:if(-1==g.select_limit||this.data.ui.selected.length+1<=g.select_limit)n=!0}}n&&!x&&(l||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),g.selected_parent_open&&a.parents(".jstree-closed").each(function(){O.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:e}))},_fix_scroll:function(a){var e=this.get_container()[0];
if(e.scrollHeight>e.offsetHeight&&(a=this._get_node(a))&&!(-1===a||!a.length||!a.is(":visible")))if(a=a.offset().top-this.get_container().offset().top,0>a&&(e.scrollTop=e.scrollTop+a-1),a+this.data.core.li_height+(e.scrollWidth>e.offsetWidth?c:0)>e.offsetHeight)e.scrollTop+=a-e.offsetHeight+this.data.core.li_height+1+(e.scrollWidth>e.offsetWidth?c:0)},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=
this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return 0<=this.data.ui.selected.index(this._get_node(a))},get_selected:function(c){return c?a(c).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(c){c=c?a(c).find("a.jstree-clicked").parent():
this.get_container().find("a.jstree-clicked").parent();c.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a([]);this.data.ui.last_selected=!1;this.__callback({obj:c})}}});a.jstree.defaults.plugins.push("ui")})(jQuery);(function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,e){if(this._get_settings().crrm.move.open_onmove){var g=this;e.rslt.np.parentsUntil(".jstree").addBack().filter(".jstree-closed").each(function(){g.open_node(this,
!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(a){return!0}}},_fn:{_show_input:function(c,e){c=this._get_node(c);var g=this._get_settings().core.rtl,q=this._get_settings().crrm.input_width_limit,v=c.children("ins").width(),f=c.find("> a:visible > ins").width()*c.find("> a:visible > ins").length,l=this.get_text(c),n=a("<div />",{css:{position:"absolute",top:"-200px",left:g?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),
H=c.css("position","relative").append(a("<input />",{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:g?"auto":v+f+4+"px",right:g?v+f+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=c.children(".jstree-rename-input"),g=a.val();""===g&&(g=l);n.remove();a.remove();this.set_text(c,l);this.rename_node(c,g);e.call(this,c,g,l);c.css("position","")},
this),keyup:function(a){a=a.keyCode||a.which;27==a?(this.value=l,this.blur()):13==a?this.blur():H.width(Math.min(n.text("pW"+this.value).width(),q))},keypress:function(a){if(13==(a.keyCode||a.which))return!1}})).children(".jstree-rename-input");this.set_text(c,"");n.css({fontFamily:H.css("fontFamily")||"",fontSize:H.css("fontSize")||"",fontWeight:H.css("fontWeight")||"",fontStyle:H.css("fontStyle")||"",fontStretch:H.css("fontStretch")||"",fontVariant:H.css("fontVariant")||"",letterSpacing:H.css("letterSpacing")||
"",wordSpacing:H.css("wordSpacing")||""});H.width(Math.min(n.text("pW"+H[0].value).width(),q))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var e=this.__callback;this._show_input(a,function(a,c,v){e.call(this,{obj:a,new_name:c,old_name:v})})},create:function(c,e,g,q,v){var f=this;(c=this._get_node(c))||(c=-1);this.__rollback();return this.create_node(c,e,g,function(c){var e=this._get_parent(c),g=a(c).index();q&&q.call(this,c);e.length&&e.hasClass("jstree-closed")&&this.open_node(e,
!1,!0);v?f.__callback({obj:c,name:this.get_text(c),parent:e,position:g}):this._show_input(c,function(a,c,q){f.__callback({obj:a,name:c,parent:e,position:g})})})},remove:function(a){a=this._get_node(a,!0);var e=this._get_parent(a),g=this._get_prev(a);this.__rollback();a=this.delete_node(a);!1!==a&&this.__callback({obj:a,prev:g,parent:e})},check_move:function(){return!this.__call_old()||!this._get_settings().crrm.move.check_move.call(this,this._get_move())?!1:!0},move_node:function(a,e,g,q,v,f){var l=
this._get_settings().crrm.move;if(!v)return"undefined"===typeof g&&(g=l.default_position),"inside"===g&&!l.default_position.match(/^(before|after)$/)&&(g=l.default_position),this.__call_old(!0,a,e,g,q,!1,f);if(!0===l.always_copy||"multitree"===l.always_copy&&a.rt.get_index()!==a.ot.get_index())q=!0;this.__call_old(!0,a,e,g,q,!0,f)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,
!0);if(!a||!a.length)return!1;this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var e=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0);this.__callback({obj:a,
nodes:e})}}})})(jQuery);(function(a){var c=[];a.jstree._themes=!1;a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,
icons:!0},_fn:{set_theme:function(e,g){if(!e)return!1;g||(g=a.jstree._themes+e+"/style.css");-1==a.inArray(g,c)&&(a.vakata.css.add_sheet({url:g}),c.push(g));this.data.themes.theme!=e&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=e);this.get_container().addClass("jstree-"+e);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},
show_dots:function(){this.data.themes.dots=!0;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},
toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});a(function(){!1===a.jstree._themes&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===a.jstree._themes&&(a.jstree._themes="themes/")});a.jstree.defaults.plugins.push("themes")})(jQuery);(function(a){var c=[];a.jstree.plugin("hotkeys",{__init:function(){if("undefined"===
typeof a.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";a.each(this._get_settings().hotkeys,function(e,g){!1!==g&&-1==a.inArray(e,c)&&(a(document).bind("keydown",e,function(c){a:{var g=a.jstree._focused(),f;if(g&&(g.data&&g.data.hotkeys&&g.data.hotkeys.enabled)&&(f=g._get_settings().hotkeys[e])){c=f.call(g,c);break a}c=void 0}return c}),c.push(e))});this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&
(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||
this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):
this.hover_node(this._get_prev(a)));return!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?
this.open_node(a):this.hover_node(this._get_next(a)));return!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();
return!1},"ctrl+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},"shift+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=
!1}}})})(jQuery);(function(a){a.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&this.get_container().bind("after_close.jstree",function(a,e){e.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,e,g){var q=this;this.load_node_json(a,function(){q.__callback({obj:q._get_node(a)});e.call(this)},g)},_is_loaded:function(c){var e=this._get_settings().json_data;
c=this._get_node(c);return-1==c||!c||!e.ajax&&!e.progressive_render&&!a.isFunction(e.data)||c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").length},refresh:function(c){c=this._get_node(c);var e=this._get_settings().json_data;c&&(-1!==c&&e.progressive_unload&&(a.isFunction(e.data)||e.ajax))&&c.removeData("jstree_children");return this.__call_old()},load_node_json:function(c,e,g){var q=this.get_settings().json_data,f,l=function(){};f=function(){};if((c=this._get_node(c))&&-1!==
c&&(q.progressive_render||q.progressive_unload)&&!c.is(".jstree-open, .jstree-leaf")&&0===c.children("ul").children("li").length&&c.data("jstree_children")){if(f=this._parse_json(c.data("jstree_children"),c))c.append(f),q.progressive_unload||c.removeData("jstree_children");this.clean_node(c);e&&e.call(this)}else{if(c&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case !q.data&&!q.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(q.data):q.data.call(this,
c,a.proxy(function(a){(a=this._parse_json(a,c))?(-1===c||!c?this.get_container().children("ul").empty().append(a.children()):(c.append(a).children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading")),this.clean_node(c),e&&e.call(this)):(-1===c||!c?q.correct_state&&this.get_container().children("ul").empty():(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),q.correct_state&&this.correct_state(c)),g&&g.call(this))},this));
break;case !!q.data&&!q.ajax||!!q.data&&!!q.ajax&&(!c||-1===c):if(!c||-1==c)(f=this._parse_json(q.data,c))?(this.get_container().children("ul").empty().append(f.children()),this.clean_node()):q.correct_state&&this.get_container().children("ul").empty();e&&e.call(this);break;case !q.data&&!!q.ajax||!!q.data&&!!q.ajax&&c&&-1!==c:l=function(a,e,f){var v=this.get_settings().json_data.ajax.error;v&&v.call(this,a,e,f);-1!=c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),
"success"===e&&q.correct_state&&this.correct_state(c)):"success"===e&&q.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},f=function(g,f,v){var x=this.get_settings().json_data.ajax.success;x&&(g=x.call(this,g,f,v)||g);if(""===g||g&&g.toString&&""===g.toString().replace(/^[\s\n]+$/,"")||!a.isArray(g)&&!a.isPlainObject(g))return l.call(this,v,f,"");(g=this._parse_json(g,c))?(-1===c||!c?this.get_container().children("ul").empty().append(g.children()):(c.append(g).children("a.jstree-loading").removeClass("jstree-loading"),
c.removeData("jstree_is_loading")),this.clean_node(c),e&&e.call(this)):-1===c||!c?q.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this)):(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),q.correct_state&&(this.correct_state(c),e&&e.call(this)))},q.ajax.context=this,q.ajax.error=l,q.ajax.success=f,q.ajax.dataType||(q.ajax.dataType="json"),a.isFunction(q.ajax.url)&&(q.ajax.url=q.ajax.url.call(this,c)),a.isFunction(q.ajax.data)&&(q.ajax.data=
q.ajax.data.call(this,c)),a.ajax(q.ajax)}}},_parse_json:function(c,e,g){var q=!1,f=this._get_settings(),l=f.json_data,n=f.core.html_titles,y;if(!c)return q;l.progressive_unload&&(e&&-1!==e)&&e.data("jstree_children",q);if(a.isArray(c)){q=a("<ul>");if(!c.length)return!1;f=0;for(l=c.length;f<l;f++)y=this._parse_json(c[f],e,!0),y.length&&(q=q.append(y));q=q.children()}else{"string"==typeof c&&(c={data:c});if(!c.data&&""!==c.data)return q;q=a("<li />");c.attr&&q.attr(c.attr);c.metadata&&q.data(c.metadata);
c.state&&q.addClass("jstree-"+c.state);a.isArray(c.data)||(y=c.data,c.data=[],c.data.push(y));a.each(c.data,function(e,g){y=a("<a />");a.isFunction(g)&&(g=g.call(this,c));if("string"==typeof g)y.attr("href","#")[n?"html":"text"](g);else g.attr||(g.attr={}),g.attr.href||(g.attr.href="#"),y.attr(g.attr)[n?"html":"text"](g.title),g.language&&y.addClass(g.language);y.prepend("<ins class='jstree-icon'>&#160;</ins>");!g.icon&&c.icon&&(g.icon=c.icon);g.icon&&(-1===g.icon.indexOf("/")?y.children("ins").addClass(g.icon):
y.children("ins").css("background","url('"+g.icon+"') center center no-repeat"));q.append(y)});q.prepend("<ins class='jstree-icon'>&#160;</ins>");c.children&&(l.progressive_render&&"open"!==c.state?q.addClass("jstree-closed").data("jstree_children",c.children):(l.progressive_unload&&q.data("jstree_children",c.children),a.isArray(c.children)&&c.children.length&&(y=this._parse_json(c.children,e,!0),y.length&&(e=a("<ul />"),e.append(y),q.append(e)))))}g||(g=a("<ul />"),g.append(q),q=g);return q},get_json:function(c,
e,g,q){var f=[],l=this._get_settings(),n=this,y,H,x,K,O,X;c=this._get_node(c);if(!c||-1===c)c=this.get_container().find("> ul > li");e=a.isArray(e)?e:["id","class"];!q&&this.data.types&&e.push(l.types.type_attr);g=a.isArray(g)?g:[];c.each(function(){x=a(this);y={data:[]};e.length&&(y.attr={});a.each(e,function(a,c){(H=x.attr(c))&&(H.length&&H.replace(/jstree[^ ]*/ig,"").length)&&(y.attr[c]=(" "+H).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))});x.hasClass("jstree-open")&&
(y.state="open");x.hasClass("jstree-closed")&&(y.state="closed");x.data()&&(y.metadata=x.data());K=x.children("a");K.each(function(){O=a(this);g.length||-1!==a.inArray("languages",l.plugins)||O.children("ins").get(0).style.backgroundImage.length||O.children("ins").get(0).className&&O.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(X=!1,-1!==a.inArray("languages",l.plugins)&&(a.isArray(l.languages)&&l.languages.length)&&a.each(l.languages,function(a,c){if(O.hasClass(c))return X=
c,!1}),H={attr:{},title:n.get_text(O,X)},a.each(g,function(a,c){H.attr[c]=(" "+(O.attr(c)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),-1!==a.inArray("languages",l.plugins)&&(a.isArray(l.languages)&&l.languages.length)&&a.each(l.languages,function(a,c){if(O.hasClass(c))return H.language=c,!0}),O.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(H.icon=O.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,
"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),O.children("ins").get(0).style.backgroundImage.length&&(H.icon=O.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):H=n.get_text(O);1<K.length?y.data.push(H):y.data=H});x=x.find("> ul > li");x.length&&(y.children=n.get_json(x,e,g,!0));f.push(y)});return f}}})})(jQuery);(function(a){var c=!1;a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(e){var g=this._get_settings().languages,
q=!1,f=".jstree-"+this.get_index()+" a";if(!a.isArray(g)||0===g.length)return!1;if(-1==a.inArray(e,g))if(g[e])e=g[e];else return!1;if(e==this.data.languages.current_language)return!0;q=a.vakata.css.get_css(f+"."+this.data.languages.current_language,!1,c);!1!==q&&(q.style.display="none");q=a.vakata.css.get_css(f+"."+e,!1,c);!1!==q&&(q.style.display="");this.data.languages.current_language=e;this.__callback(e);return!0},get_lang:function(){return this.data.languages.current_language},_get_string:function(c,
g){var q=this._get_settings().languages,f=this._get_settings().core.strings;a.isArray(q)&&q.length&&(g=g&&-1!=a.inArray(g,q)?g:this.data.languages.current_language);return f[g]&&f[g][c]?f[g][c]:f[c]?f[c]:c},get_text:function(c,g){c=this._get_node(c)||this.data.ui.last_selected;if(!c.size())return!1;var q=this._get_settings().languages,f=this._get_settings().core.html_titles;a.isArray(q)&&q.length?(g=g&&-1!=a.inArray(g,q)?g:this.data.languages.current_language,c=c.children("a."+g)):c=c.children("a:eq(0)");
if(f)return c=c.clone(),c.children("INS").remove(),c.html();c=c.contents().filter(function(){return 3==this.nodeType})[0];return c.nodeValue},set_text:function(c,g,q){c=this._get_node(c)||this.data.ui.last_selected;if(!c.size())return!1;var f=this._get_settings().languages,l=this._get_settings().core.html_titles;a.isArray(f)&&f.length?(q=q&&-1!=a.inArray(q,f)?q:this.data.languages.current_language,c=c.children("a."+q)):c=c.children("a:eq(0)");if(l)return f=c.children("INS").clone(),c.html(g).prepend(f),
this.__callback({obj:c,name:g,lang:q}),!0;c=c.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:c,name:g,lang:q});return c.nodeValue=g},_load_css:function(){var e=this._get_settings().languages,g="/* languages css */",q=".jstree-"+this.get_index()+" a",f;if(a.isArray(e)&&e.length){this.data.languages.current_language=e[0];for(f=0;f<e.length;f++)g+=q+"."+e[f]+" {",e[f]!=this.data.languages.current_language&&(g+=" display:none; "),g+=" } ";c=a.vakata.css.add_sheet({str:g,
title:"jstree-languages"})}},create_node:function(c,g,q,f){return this.__call_old(!0,c,g,q,function(c){var e=this._get_settings().languages,g=c.children("a"),q;if(a.isArray(e)&&e.length){for(q=0;q<e.length;q++)g.is("."+e[q])||c.append(g.eq(0).clone().removeClass(e.join(" ")).addClass(e[q]));g.not("."+e.join(", .")).remove()}f&&f.call(this,c)})}}})})(jQuery);(function(a){a.jstree.plugin("cookies",{__init:function(){if("undefined"===typeof a.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";
var c=this._get_settings().cookies,e;if(c.save_loaded&&(e=a.cookie(c.save_loaded))&&e.length)this.data.core.to_load=e.split(",");if(c.save_opened&&(e=a.cookie(c.save_opened))&&e.length)this.data.core.to_open=e.split(",");if(c.save_selected&&(e=a.cookie(c.save_selected))&&e.length&&this.data.ui)this.data.ui.to_select=e.split(",");this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",
a.proxy(function(a){this._get_settings().cookies.auto_save&&this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(c){if(!this.data.core.refreshing){var e=this._get_settings().cookies;if(c)switch(c){case "open_node":case "close_node":e.save_opened&&(this.save_opened(),a.cookie(e.save_opened,this.data.core.to_open.join(","),
e.cookie_options));e.save_loaded&&(this.save_loaded(),a.cookie(e.save_loaded,this.data.core.to_load.join(","),e.cookie_options));break;case "select_node":case "deselect_node":e.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(e.save_selected,this.data.ui.to_select.join(","),e.cookie_options))}else e.save_loaded&&(this.save_loaded(),a.cookie(e.save_loaded,this.data.core.to_load.join(","),e.cookie_options)),e.save_opened&&(this.save_opened(),a.cookie(e.save_opened,this.data.core.to_open.join(","),
e.cookie_options)),e.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(e.save_selected,this.data.ui.to_select.join(","),e.cookie_options))}}}})})(jQuery);(function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,e){var g=this._get_node(e.rslt.obj),g=-1===g?this.get_container().children("ul"):g.children("ul");this.sort(g)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,e){this.sort(e.rslt.obj.parent())},
this)).bind("move_node.jstree",a.proxy(function(a,e){var g=-1==e.rslt.np?this.get_container():e.rslt.np;this.sort(g.children("ul"))},this))},defaults:function(a,e){return this.get_text(a)>this.get_text(e)?1:-1},_fn:{sort:function(c){var e=this._get_settings().sort,g=this;c.append(a.makeArray(c.children("li")).sort(a.proxy(e,g)));c.find("> li > ul").each(function(){g.sort(a(this))});this.clean_node(c)}}})})(jQuery);(function(a){var c=!1,e=!1,g=!1,q=!1,f=!1,l=!1,n=!1,y=!1,H=!1;a.vakata.dnd={is_down:!1,
is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(c,e,g){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{c.currentTarget.unselectable="on",c.currentTarget.onselectstart=function(){return!1},c.currentTarget.style&&(c.currentTarget.style.MozUserSelect="none")}catch(q){}a.vakata.dnd.init_x=c.pageX;a.vakata.dnd.init_y=c.pageY;a.vakata.dnd.user_data=e;a.vakata.dnd.is_down=!0;a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(g);
a(document).bind("mousemove",a.vakata.dnd.drag);a(document).bind("mouseup",a.vakata.dnd.drag_stop);return!1},drag:function(c){if(a.vakata.dnd.is_down){if(!a.vakata.dnd.is_drag)if(5<Math.abs(c.pageX-a.vakata.dnd.init_x)||5<Math.abs(c.pageY-a.vakata.dnd.init_y))a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:c,data:a.vakata.dnd.user_data});else return;if("mousemove"===c.type){var e=a(document),g=e.scrollTop(),e=e.scrollLeft();20>c.pageY-
g?(l&&"down"===n&&(clearInterval(l),l=!1),l||(n="up",l=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-a.vakata.dnd.scroll_spd)},150))):l&&"up"===n&&(clearInterval(l),l=!1);20>a(window).height()-(c.pageY-g)?(l&&"up"===n&&(clearInterval(l),l=!1),l||(n="down",l=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150))):l&&"down"===n&&(clearInterval(l),l=!1);20>c.pageX-e?(f&&"right"===y&&(clearInterval(f),f=!1),f||(y="left",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-
a.vakata.dnd.scroll_spd)},150))):f&&"left"===y&&(clearInterval(f),f=!1);20>a(window).width()-(c.pageX-e)?(f&&"left"===y&&(clearInterval(f),f=!1),f||(y="right",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150))):f&&"right"===y&&(clearInterval(f),f=!1)}a.vakata.dnd.helper.css({left:c.pageX+a.vakata.dnd.helper_left+"px",top:c.pageY+a.vakata.dnd.helper_top+"px"});a(document).triggerHandler("drag.vakata",{event:c,data:a.vakata.dnd.user_data})}},drag_stop:function(c){f&&
clearInterval(f);l&&clearInterval(l);a(document).unbind("mousemove",a.vakata.dnd.drag);a(document).unbind("mouseup",a.vakata.dnd.drag_stop);a(document).triggerHandler("drag_stop.vakata",{event:c,data:a.vakata.dnd.user_data});a.vakata.dnd.helper.remove();a.vakata.dnd.init_x=0;a.vakata.dnd.init_y=0;a.vakata.dnd.user_data={};a.vakata.dnd.is_down=!1;a.vakata.dnd.is_drag=!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",
title:"vakata"})});a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",a.proxy(function(e){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.themes&&(g.attr("class","jstree-"+this.data.themes.theme),q&&q.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),
e.currentTarget===e.target&&(a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target)&&(e=a.jstree._reference(e.target),e.data.dnd.foreign?(e=e._get_settings().dnd.drag_check.call(this,{o:c,r:e.get_container(),is_root:!0}),(!0===e||!0===e.inside||!0===e.before||!0===e.after)&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(e.prepare_move(c,e.get_container(),"last"),e.check_move()&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok"))))},this)).bind("mouseup.jstree",a.proxy(function(e){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var g=a.jstree._reference(e.currentTarget);g.data.dnd.foreign?(e=g._get_settings().dnd.drag_check.call(this,{o:c,r:g.get_container(),is_root:!0}),(!0===e||!0===e.inside||!0===e.before||!0===e.after)&&g._get_settings().dnd.drag_finish.call(this,
{o:c,r:g.get_container(),is_root:!0})):g.move_node(c,g.get_container(),"last",e[g._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",a.proxy(function(c){if(c.relatedTarget&&c.relatedTarget.id&&"jstree-marker-line"===c.relatedTarget.id)return!1;a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),
a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var e=this.get_container()[0];c.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},e),100)):c.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&
clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},e),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);c.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop+=a.vakata.dnd.scroll_spd},e),100)):c.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop-=
a.vakata.dnd.scroll_spd},e),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&(a.vakata.dnd.user_data.jstree&&g&&q)&&(g.hide(),q.hide())},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(1===a.which)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(c.currentTarget)},this)).delegate("a",
"mousemove.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&((!e||!e.length||e.children("a")[0]!==c.currentTarget)&&this.dnd_enter(c.currentTarget),"undefined"===typeof this.data.dnd.off.top&&(this.data.dnd.off=a(c.target).offset()),this.data.dnd.w=(c.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&
a.vakata.dnd.user_data.jstree){if(c.relatedTarget&&c.relatedTarget.id&&"jstree-marker-line"===c.relatedTarget.id)return!1;g&&g.hide();q&&q.hide();this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(c)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(c){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(c)},this));a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);
this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;g&&g.css({top:"-2000px"});q&&q.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(c,e){if(e.data.jstree){var g=a(e.event.target);
g.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(g)}},this));var f=this._get_settings().dnd;f.drag_target&&a(document).delegate(f.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(e){c=e.target;a.vakata.dnd.drag_start(e,{jstree:!0,obj:e.target},"<ins class='jstree-icon'></ins>"+a(e.target).text());this.data.themes&&(g&&g.attr("class","jstree-"+this.data.themes.theme),q&&q.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+
this.data.themes.theme));a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var f=this.get_container();this.data.dnd.cof=f.offset();this.data.dnd.cw=parseInt(f.width(),10);this.data.dnd.ch=parseInt(f.height(),10);this.data.dnd.foreign=!0;e.preventDefault()},this));f.drop_target&&a(document).delegate(f.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(e){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:c,r:a(e.target),e:e})&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok")},this)).delegate(f.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(c){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(f.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(e){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:c,r:a(e.target),e:e})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,
drop_target:".jstree-drop",drop_check:function(a){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(a){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(e&&e.length){this.data.dnd.off=e.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+e.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:c,r:e});this.data.dnd.after=a.after;this.data.dnd.before=a.before;
this.data.dnd.inside=a.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(c,e,"before");this.data.dnd.before=this.check_move();this.prepare_move(c,e,"after");this.data.dnd.after=this.check_move();this._is_loaded(e)?(this.prepare_move(c,e,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var c=["before","inside","after"],e=!1,f=this._get_settings().core.rtl,
c=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];a.each(c,a.proxy(function(c,g){if(this.data.dnd[g])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),e=g,!1},this));!1===e&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");c=f?this.data.dnd.off.right-18:this.data.dnd.off.left+
10;switch(e){case "before":g.css({left:c+"px",top:this.data.dnd.off.top-6+"px"}).show();q&&q.css({left:c+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case "after":g.css({left:c+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();q&&q.css({left:c+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case "inside":g.css({left:c+(f?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();q&&q.hide();break;default:g.hide(),
q&&q.hide()}return H=e}},dnd_open:function(){this.data.dnd.to2=!1;this.open_node(e,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:c,r:e,p:H}):(this.dnd_prepare(),this.move_node(c,e,H,a[this._get_settings().dnd.copy_modifier+"Key"]));e=c=!1;g.hide();q&&q.hide()},dnd_enter:function(c){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=
!1);var g=this._get_settings().dnd;this.data.dnd.prepared=!1;e=this._get_node(c);g.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),g.check_timeout)):this.dnd_prepare();g.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e&&(e.length&&e.hasClass("jstree-closed"))&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),g.open_timeout))):e&&(e.length&&e.hasClass("jstree-closed"))&&this.dnd_open()},dnd_leave:function(c){this.data.dnd.after=
!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");g.hide();q&&q.hide();e&&e[0]===c.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(e,f){c=this._get_node(e);this.data.ui&&this.is_selected(c)&&(c=this._get_node(null,!0));var l=1<c.length?this._get_string("multiple_selection"):this.get_text(c),
v=this.get_container();this._get_settings().core.html_titles||(l=l.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"));a.vakata.dnd.drag_start(f,{jstree:!0,obj:c},"<ins class='jstree-icon'></ins>"+l);this.data.themes&&(g&&g.attr("class","jstree-"+this.data.themes.theme),q&&q.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=v.offset();this.data.dnd.cw=parseInt(v.width(),10);this.data.dnd.ch=parseInt(v.height(),
10);this.data.dnd.active=!0}}});a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",
title:"jstree"});g=a("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){g.hide();q.hide();a.preventDefault();a.stopImmediatePropagation();return!1}).appendTo("body");q=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(e&&e.length)return e.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(c){var f=a(c.relatedTarget);if((f.is(".jstree")||0===f.closest(".jstree").length)&&
e&&e.length)return e.children("a").trigger(c),g.hide(),q.hide(),c.preventDefault(),c.stopImmediatePropagation(),!1}).appendTo("body");a(document).bind("drag_start.vakata",function(a,c){c.data.jstree&&(g.show(),q&&q.show())});a(document).bind("drag_stop.vakata",function(a,c){c.data.jstree&&(g.hide(),q&&q.hide())})})})(jQuery);(function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=
this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,e){this._prepare_checkboxes(e.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(a){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault();this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):
this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui)this.save_selected(),this.data.cookies&&this.save_cookie("select_node");else return a.stopImmediatePropagation(),!1},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(1E4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},
_fn:{_checkbox_notify:function(a,e){e.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(c){c=!c||-1==c?this.get_container().find("> ul > li"):this._get_node(c);if(!1!==c){var e,g=this,q,f=this._get_settings().checkbox.two_state,l=this._get_settings().checkbox.real_checkboxes,n=this._get_settings().checkbox.real_checkboxes_names;c.each(function(){q=a(this);e=q.is("li")&&(q.hasClass("jstree-checked")||l&&q.children(":checked").length)?"jstree-checked":"jstree-unchecked";q.find("li").addBack().each(function(){var c=
a(this),q;c.children("a"+(g.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(f?"jstree-unchecked":e);l&&(c.children(":checkbox").length?c.children(":checkbox").addClass("jstree-real-checkbox"):(q=n.call(g,c),c.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+q[0]+"' name='"+q[0]+"' value='"+q[1]+"' />")));f?(c.hasClass("jstree-checked")||c.children(":checked").length)&&
c.addClass("jstree-checked").children(":checkbox").prop("checked",!0):("jstree-checked"===e||c.hasClass("jstree-checked")||c.children(":checked").length)&&c.find("li").addBack().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})});f||c.find(".jstree-checked").parent().parent().each(function(){g._repair_state(this)})}},change_state:function(c,e){c=this._get_node(c);var g=!1,q=this._get_settings().checkbox.real_checkboxes;if(!c||-1===c)return!1;e=!1===e||!0===e?e:c.hasClass("jstree-checked");
if(this._get_settings().checkbox.two_state)e?(c.removeClass("jstree-checked").addClass("jstree-unchecked"),q&&c.children(":checkbox").prop("checked",!1)):(c.removeClass("jstree-unchecked").addClass("jstree-checked"),q&&c.children(":checkbox").prop("checked",!0));else{if(e){g=c.find("li").addBack();if(!g.filter(".jstree-checked, .jstree-undetermined").length)return!1;g.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");q&&g.children(":checkbox").prop("checked",!1)}else{g=
c.find("li").addBack();if(!g.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;g.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");q&&g.children(":checkbox").prop("checked",!0);this.data.ui&&(this.data.ui.last_selected=c);this.data.checkbox.last_selected=c}c.parentsUntil(".jstree","li").each(function(){var c=a(this);if(e){if(c.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return c.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),
q&&c.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",!1),!1;c.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");q&&c.children(":checkbox").prop("checked",!1)}else{if(c.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return c.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),q&&c.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",
!1),!1;c.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");q&&c.children(":checkbox").prop("checked",!0)}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(c);return!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var e=this;a.parents(".jstree-closed").each(function(){e.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,
!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!1)});this.__callback()},uncheck_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!0)});this.__callback()},is_checked:function(a){a=this._get_node(a);
return a.length?a.is(".jstree-checked"):!1},get_checked:function(a,e){a=!a||-1===a?this.get_container():this._get_node(a);return e||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,e){a=!a||-1===a?this.get_container():this._get_node(a);return e||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},
show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length)if(this._get_settings().checkbox.two_state)a.find("li").addBack().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);else{var e=this._get_settings().checkbox.real_checkboxes,
g=a.find("> ul > .jstree-checked").length,q=a.find("> ul > .jstree-undetermined").length,f=a.find("> ul > li").length;0===f?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):0===g&&0===q?this.change_state(a,!0):g===f?this.change_state(a,!1):(a.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),e&&a.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",!1))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var c=
this,e=this.data.ui.to_select,e=a.map(a.makeArray(e),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();a.each(e,function(a,e){c.check_node(e)});this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}});
a(function(){a.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})})})(jQuery);(function(a){a.vakata.xslt=function(c,e,f){var l=!1,n,y,H;if(!1===l&&window.ActiveXObject)try{l=new ActiveXObject("Msxml2.XSLTemplate"),y=new ActiveXObject("Msxml2.DOMDocument"),y.loadXML(c),H=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),H.loadXML(e),l.stylesheet=H,n=l.createProcessor(),n.input=y,n.transform(),l=n.output}catch(x){}c=a.parseXML(c);e=a.parseXML(e);!1===l&&
"undefined"!==typeof XSLTProcessor&&(n=new XSLTProcessor,n.importStylesheet(e),l=n.transformToFragment(c,document),l=a("<div />").append(l).html());!1===l&&"undefined"!==typeof c.transformNode&&(l=c.transformNode(e));f.call(null,l)};var c={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',
flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},
e=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,c,e){var f=this;this.load_node_xml(a,function(){f.__callback({obj:f._get_node(a)});c.call(this)},e)},_is_loaded:function(c){var e=this._get_settings().xml_data;c=this._get_node(c);return-1==c||
!c||!e.ajax&&!a.isFunction(e.data)||c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").size()},load_node_xml:function(c,e,f){var l=this.get_settings().xml_data,n=function(){},y=function(){};if((c=this._get_node(c))&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case !l.data&&!l.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(l.data):l.data.call(this,c,a.proxy(function(f){this.parse_xml(f,a.proxy(function(f){f&&(f=
f.replace(/ ?xmlns="[^"]*"/ig,""),10<f.length?(f=a(f),-1===c||!c?this.get_container().children("ul").empty().append(f.children()):(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(f),c.removeData("jstree_is_loading")),l.clean_node&&this.clean_node(c),e&&e.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),l.correct_state&&(this.correct_state(c),e&&e.call(this))):l.correct_state&&(this.get_container().children("ul").empty(),
e&&e.call(this)))},this))},this));break;case !!l.data&&!l.ajax||!!l.data&&!!l.ajax&&(!c||-1===c):(!c||-1==c)&&this.parse_xml(l.data,a.proxy(function(f){f?(f=f.replace(/ ?xmlns="[^"]*"/ig,""),10<f.length&&(f=a(f),this.get_container().children("ul").empty().append(f.children()),l.clean_node&&this.clean_node(c),e&&e.call(this))):l.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this))},this));break;case !l.data&&!!l.ajax||!!l.data&&!!l.ajax&&c&&-1!==c:n=function(a,e,q){var n=this.get_settings().xml_data.ajax.error;
n&&n.call(this,a,e,q);-1!==c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),"success"===e&&l.correct_state&&this.correct_state(c)):"success"===e&&l.correct_state&&this.get_container().children("ul").empty();f&&f.call(this)},y=function(f,v,y){f=y.responseText;var O=this.get_settings().xml_data.ajax.success;O&&(f=O.call(this,f,v,y)||f);if(""===f||f&&f.toString&&""===f.toString().replace(/^[\s\n]+$/,""))return n.call(this,y,v,"");this.parse_xml(f,
a.proxy(function(f){f&&(f=f.replace(/ ?xmlns="[^"]*"/ig,""),10<f.length?(f=a(f),-1===c||!c?this.get_container().children("ul").empty().append(f.children()):(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(f),c.removeData("jstree_is_loading")),l.clean_node&&this.clean_node(c),e&&e.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),l.correct_state&&(this.correct_state(c),e&&e.call(this))):l.correct_state&&(this.get_container().children("ul").empty(),
e&&e.call(this)))},this))},l.ajax.context=this,l.ajax.error=n,l.ajax.success=y,l.ajax.dataType||(l.ajax.dataType="xml"),a.isFunction(l.ajax.url)&&(l.ajax.url=l.ajax.url.call(this,c)),a.isFunction(l.ajax.data)&&(l.ajax.data=l.ajax.data.call(this,c)),a.ajax(l.ajax)}},parse_xml:function(e,q){var f=this._get_settings().xml_data;a.vakata.xslt(e,c[f.xsl],q)},get_xml:function(c,q,f,l,n){var y="",H=this._get_settings(),x=this,K,O,X,Wa,La;c||(c="flat");n||(n=0);q=this._get_node(q);if(!q||-1===q)q=this.get_container().find("> ul > li");
f=a.isArray(f)?f:["id","class"];!n&&(this.data.types&&-1===a.inArray(H.types.type_attr,f))&&f.push(H.types.type_attr);l=a.isArray(l)?l:[];n||(H.xml_data.get_include_preamble&&(y+='<?xml version="1.0" encoding="UTF-8"?>'),y+="<root>");q.each(function(){y+="<item";X=a(this);a.each(f,function(a,c){var g=X.attr(c);if(!H.xml_data.get_skip_empty||"undefined"!==typeof g)y+=" "+c+'="'+e((" "+(g||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'});X.hasClass("jstree-open")&&
(y+=' state="open"');X.hasClass("jstree-closed")&&(y+=' state="closed"');"flat"===c&&(y+=' parent_id="'+e(n)+'"');y+=">";y+="<content>";Wa=X.children("a");Wa.each(function(){K=a(this);La=!1;y+="<name";-1!==a.inArray("languages",H.plugins)&&a.each(H.languages,function(a,c){if(K.hasClass(c))return y+=' lang="'+e(c)+'"',La=c,!1});l.length&&a.each(l,function(a,c){var g=K.attr(c);if(!H.xml_data.get_skip_empty||"undefined"!==typeof g)y+=" "+c+'="'+e((" "+g||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig,
" ").replace(/^ /,"").replace(/ $/,""))+'"'});K.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(y+=' icon="'+e(K.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"');K.children("ins").get(0).style.backgroundImage.length&&(y+=' icon="'+e(K.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"');y+=">";y+="<![CDATA["+
x.get_text(K,La)+"]]\x3e";y+="</name>"});y+="</content>";O=X[0].id||!0;X=X.find("> ul > li");O=X.length?x.get_xml(c,X,f,l,O):"";"nest"==c&&(y+=O);y+="</item>";"flat"==c&&(y+=O)});n||(y+="</root>");return y}}})})(jQuery);(function(a){8<=a().jquery.split(".")[1]?(a.expr[":"].jstree_contains=a.expr.createPseudo(function(a){return function(e){return 0<=(e.textContent||e.innerText||"").toLowerCase().indexOf(a.toLowerCase())}}),a.expr[":"].jstree_title_contains=a.expr.createPseudo(function(a){return function(e){return 0<=
(e.getAttribute("title")||"").toLowerCase().indexOf(a.toLowerCase())}})):(a.expr[":"].jstree_contains=function(a,e,g){return 0<=(a.textContent||a.innerText||"").toLowerCase().indexOf(g[3].toLowerCase())},a.expr[":"].jstree_title_contains=function(a,e,g){return 0<=(a.getAttribute("title")||"").toLowerCase().indexOf(g[3].toLowerCase())});a.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=a();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",
function(c,e){a(this).children("ul").find("li").hide().removeClass("jstree-last");e.rslt.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(c,e){if(""===a.trim(c))this.clear_search();else{var g=
this.get_settings().search,f=this,l=function(){};this.data.search.str=c;if(!e&&!1!==g.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;l=function(a,c,e){var g=this.get_settings().search.ajax.success;g&&(a=g.call(this,a,c,e)||a);this.data.search.to_open=a;this._search_open()};g.ajax.context=this;g.ajax.error=function(){};g.ajax.success=l;a.isFunction(g.ajax.url)&&(g.ajax.url=g.ajax.url.call(this,c));a.isFunction(g.ajax.data)&&(g.ajax.data=
g.ajax.data.call(this,c));g.ajax.data||(g.ajax.data={search_string:c});if(!g.ajax.dataType||/^json/.exec(g.ajax.dataType))g.ajax.dataType="json";a.ajax(g.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+g.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){f.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,
str:c})}},clear_search:function(c){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=a()},_search_open:function(c){var e=this;c=!0;var g=[],f=[];this.data.search.to_open.length&&(a.each(this.data.search.to_open,function(c,e){if("#"==e)return!0;a(e).length&&a(e).is(".jstree-closed")?g.push(e):f.push(e)}),g.length&&(this.data.search.to_open=f,a.each(g,function(a,c){e.open_node(c,function(){e._search_open(!0)})}),c=!1));c&&this.search(this.data.search.str,
!0)}}})})(jQuery);(function(a){a.vakata.context={hide_on_mouseleave:!1,cnt:a("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(c,e,g,f,l,n,V){a.vakata.context.rtl=!!V;if(c=a.vakata.context.parse(c)){a.vakata.context.vis=!0;a.vakata.context.tgt=e;a.vakata.context.par=n||e||null;a.vakata.context.data=l||null;a.vakata.context.cnt.html(c).css({visibility:"hidden",display:"block",left:0,top:0});if(a.vakata.context.hide_on_mouseleave)a.vakata.context.cnt.one("mouseleave",
function(c){a.vakata.context.hide()});l=a.vakata.context.cnt.height();n=a.vakata.context.cnt.width();g+n>a(document).width()&&(g=a(document).width()-(n+5),a.vakata.context.cnt.find("li > ul").addClass("right"));f+l>a(document).height()&&(f-=l+e[0].offsetHeight,a.vakata.context.cnt.find("li > ul").addClass("bottom"));a.vakata.context.cnt.css({left:g,top:f}).find("li:has(ul)").bind("mouseenter",function(c){c=a(document).width();var e=a(document).height(),g=a(this).children("ul").show();c!==a(document).width()&&
g.toggleClass("right");e!==a(document).height()&&g.toggleClass("bottom")}).bind("mouseleave",function(c){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show();a(document).triggerHandler("context_show.vakata")}},hide:function(){a.vakata.context.vis=!1;a.vakata.context.cnt.attr("class","").css({visibility:"hidden"});a(document).triggerHandler("context_hide.vakata")},parse:function(c,e){if(!c)return!1;var g="",f=!1,l=!0;e||(a.vakata.context.func={});g+="<ul>";a.each(c,function(c,e){if(!e)return!0;
a.vakata.context.func[c]=e.action;!l&&e.separator_before&&(g+="<li class='vakata-separator vakata-separator-before'></li>");l=!1;g+="<li class='"+(e._class||"")+(e._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";e.icon&&-1===e.icon.indexOf("/")&&(g+=" class='"+e.icon+"' ");e.icon&&-1!==e.icon.indexOf("/")&&(g+=" style='background:url("+e.icon+") center center no-repeat;' ");g+=">&#160;</ins><a href='#' rel='"+c+"'>";e.submenu&&(g+="<span style='float:"+(a.vakata.context.rtl?"left":"right")+
";'>&raquo;</span>");g+=e.label+"</a>";e.submenu&&(f=a.vakata.context.parse(e.submenu,!0))&&(g+=f);g+="</li>";e.separator_after&&(g+="<li class='vakata-separator vakata-separator-after'></li>",l=!0)});g=g.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");g+="</ul>";a(document).triggerHandler("context_parse.vakata");return 10<g.length?g:!1},exec:function(c){return a.isFunction(a.vakata.context.func[c])?(a.vakata.context.func[c].call(a.vakata.context.data,a.vakata.context.par),
!0):!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",
title:"vakata"});a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(c){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");a(document).bind("mousedown",function(c){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],c.target)&&
a.vakata.context.hide()});"undefined"!==typeof a.hotkeys&&a(document).bind("keydown","up",function(c){if(a.vakata.context.vis){var e=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();e.length||(e=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());e.addClass("vakata-hover");c.stopImmediatePropagation();c.preventDefault()}}).bind("keydown","down",function(c){if(a.vakata.context.vis){var e=
a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();e.length||(e=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());e.addClass("vakata-hover");c.stopImmediatePropagation();c.preventDefault()}}).bind("keydown","right",function(c){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),
c.stopImmediatePropagation(),c.preventDefault())}).bind("keydown","left",function(c){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),c.stopImmediatePropagation(),c.preventDefault())}).bind("keydown","esc",function(c){a.vakata.context.hide();c.preventDefault()}).bind("keydown","space",function(c){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click();c.preventDefault()})});a.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(c){c.preventDefault();a(c.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(c.currentTarget,c.pageX,c.pageY)},this)).delegate("a","click.jstree",a.proxy(function(c){this.data.contextmenu&&a.vakata.context.hide()},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=
!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,
separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(c,e,g){c=this._get_node(c);var f=this.get_settings().contextmenu,l=c.children("a:visible:eq(0)"),n=!1,n=!1;f.select_node&&(this.data.ui&&!this.is_selected(c))&&(this.deselect_all(),this.select_node(c,
!0));if(f.show_at_node||"undefined"===typeof e||"undefined"===typeof g)n=l.offset(),e=n.left,g=n.top+this.data.core.li_height;n=c.data("jstree")&&c.data("jstree").contextmenu?c.data("jstree").contextmenu:f.items;a.isFunction(n)&&(n=n.call(this,c));this.data.contextmenu=!0;a.vakata.context.show(n,l,e,g,this,c,this._get_settings().core.rtl);this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(jQuery);(function(a){a.jstree.plugin("types",{__init:function(){var c=
this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",a.proxy(function(){var e=c.type_attr,g="",f=this;a.each(c.types,function(c,l){a.each(l,function(a,c){/^(max_depth|max_children|icon|valid_children)$/.test(a)||f.data.types.attach_to.push(a)});if(!l.icon)return!0;if(l.icon.image||l.icon.position)g="default"==c?g+(".jstree-"+f.get_index()+" a > .jstree-icon { "):g+(".jstree-"+f.get_index()+" li["+e+'="'+c+'"] > a > .jstree-icon { '),l.icon.image&&(g+=" background-image:url("+
l.icon.image+"); "),g=l.icon.position?g+(" background-position:"+l.icon.position+"; "):g+" background-position:0 0; ",g+="} "});""!==g&&a.vakata.css.add_sheet({str:g,title:"jstree-types"})},this)).bind("before.jstree",a.proxy(function(c,g){var f,l;if((f=(f=this._get_settings().types.use_data?this._get_node(g.args[0]):!1)&&-1!==f&&f.length?f.data("jstree"):!1)&&f.types&&!1===f.types[g.func])return c.stopImmediatePropagation(),!1;if(-1!==a.inArray(g.func,this.data.types.attach_to)&&g.args[0]&&(g.args[0].tagName||
g.args[0].jquery))if(f=this._get_settings().types.types,l=this._get_type(g.args[0]),(f[l]&&"undefined"!==typeof f[l][g.func]||f["default"]&&"undefined"!==typeof f["default"][g.func])&&!1===this._check(g.func,g.args[0]))return c.stopImmediatePropagation(),!1},this));f&&this.get_container().bind("load_node.jstree set_type.jstree",a.proxy(function(c,g){var f=g&&g.rslt&&g.rslt.obj&&-1!==g.rslt.obj?this._get_node(g.rslt.obj).parent():this.get_container_ul(),l=!1,n=this._get_settings().types;a.each(n.types,
function(a,c){if(c.icon&&(c.icon.image||c.icon.position))l="default"===a?f.find("li > a > .jstree-icon"):f.find("li["+n.type_attr+"='"+a+"'] > a > .jstree-icon"),c.icon.image&&l.css("backgroundImage","url("+c.icon.image+")"),l.css("backgroundPosition",c.icon.position||"0 0")})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,e){e.type&&this._get_settings().types.use_data&&
this.set_type(e.type,a)},_get_type:function(a){a=this._get_node(a);return!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,e){e=this._get_node(e);var g=!e.length||!a?!1:e.attr(this._get_settings().types.type_attr,a);g&&this.__callback({obj:e,type:a});return g},_check:function(c,e,g){e=this._get_node(e);var f=!1,l=this._get_type(e),n=0,V=this,y=this._get_settings().types,H=!1;if(-1===e)if(y[c])f=y[c];else return;else{if(!1===l)return;(H=y.use_data?e.data("jstree"):
!1)&&H.types&&"undefined"!==typeof H.types[c]?f=H.types[c]:y.types[l]&&"undefined"!==typeof y.types[l][c]?f=y.types[l][c]:y.types["default"]&&"undefined"!==typeof y.types["default"][c]&&(f=y.types["default"][c])}a.isFunction(f)&&(f=f.call(this,e));"max_depth"===c&&(-1!==e&&!1!==g&&-2!==y.max_depth&&0!==f)&&e.children("a:eq(0)").parentsUntil(".jstree","li").each(function(a){if(-1!==y.max_depth&&0>=y.max_depth-(a+1))return f=0,!1;n=0===a?f:V._check(c,this,!1);if(-1!==n&&0>=n-(a+1))return f=0,!1;if(0<=
n&&(n-(a+1)<f||0>f))f=n-(a+1);if(0<=y.max_depth&&(y.max_depth-(a+1)<f||0>f))f=y.max_depth-(a+1)});return f},check_move:function(){if(!this.__call_old())return!1;var c=this._get_move(),e=c.rt._get_settings().types,g=c.rt._check("max_children",c.cr),f=c.rt._check("max_depth",c.cr),l=c.rt._check("valid_children",c.cr),n=0,V=1;if("none"===l||a.isArray(l)&&(c.ot&&c.ot._get_type)&&(c.o.each(function(){if(-1===a.inArray(c.ot._get_type(this),l))return V=!1}),!1===V)||-2!==e.max_children&&-1!==g&&(n=-1===
c.cr?this.get_container().find("> ul > li").not(c.o).length:c.cr.find("> ul > li").not(c.o).length,n+c.o.length>g))return!1;if(-2!==e.max_depth&&-1!==f){V=0;if(0===f)return!1;if("undefined"===typeof c.o.d){for(e=c.o;0<e.length;)e=e.find("> ul > li"),V++;c.o.d=V}if(0>f-c.o.d)return!1}return!0},create_node:function(c,e,g,f,l,n){if(!n&&(l||this._is_loaded(c))){var V="string"==typeof e&&e.match(/^before|after$/i)&&-1!==c?this._get_parent(c):this._get_node(c),y=this._get_settings().types,H=this._check("max_children",
V),x=this._check("max_depth",V),K=this._check("valid_children",V);"string"===typeof g&&(g={data:g});g||(g={});if("none"===K)return!1;if(a.isArray(K))if(!g.attr||!g.attr[y.type_attr])g.attr||(g.attr={}),g.attr[y.type_attr]=K[0];else if(-1===a.inArray(g.attr[y.type_attr],K))return!1;if(-2!==y.max_children&&-1!==H&&(V=-1===V?this.get_container().find("> ul > li").length:V.find("> ul > li").length,V+1>H)||-2!==y.max_depth&&-1!==x&&0>x-1)return!1}return this.__call_old(!0,c,e,g,f,l,n)}}})})(jQuery);(function(a){a.jstree.plugin("html_data",
{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").addBack().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,e,g){var f=this;this.load_node_html(a,function(){f.__callback({obj:f._get_node(a)});e.call(this)},g)},_is_loaded:function(c){c=this._get_node(c);return-1==c||!c||!this._get_settings().html_data.ajax&&
!a.isFunction(this._get_settings().html_data.data)||c.is(".jstree-open, .jstree-leaf")||0<c.children("ul").children("li").size()},load_node_html:function(c,e,g){var f,l=this.get_settings().html_data,n=function(){};f=function(){};if((c=this._get_node(c))&&-1!==c){if(c.data("jstree_is_loading"))return;c.data("jstree_is_loading",!0)}switch(!0){case a.isFunction(l.data):l.data.call(this,c,a.proxy(function(f){f&&""!==f&&f.toString&&""!==f.toString().replace(/^[\s\n]+$/,"")?(f=a(f),f.is("ul")||(f=a("<ul />").append(f)),
-1==c||!c?this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(f).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||
"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),c.removeData("jstree_is_loading")),this.clean_node(c),e&&e.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),l.correct_state&&(this.correct_state(c),e&&e.call(this))):l.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this))},this));break;
case !l.data&&!l.ajax:if(!c||-1==c)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();e&&e.call(this);break;case !!l.data&&!l.ajax||!!l.data&&!!l.ajax&&(!c||-1===c):if(!c||-1==c)f=a(l.data),
f.is("ul")||(f=a("<ul />").append(f)),this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();e&&e.call(this);break;case !l.data&&!!l.ajax||!!l.data&&!!l.ajax&&c&&-1!==c:c=this._get_node(c),n=function(a,e,f){var q=this.get_settings().html_data.ajax.error;
q&&q.call(this,a,e,f);-1!=c&&c.length?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),"success"===e&&l.correct_state&&this.correct_state(c)):"success"===e&&l.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},f=function(f,g,q){var x=this.get_settings().html_data.ajax.success;x&&(f=x.call(this,f,g,q)||f);if(""===f||f&&f.toString&&""===f.toString().replace(/^[\s\n]+$/,""))return n.call(this,q,g,"");f?(f=a(f),f.is("ul")||(f=a("<ul />").append(f)),
-1==c||!c?this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(c.children("a.jstree-loading").removeClass("jstree-loading"),c.append(f).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||
"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),c.removeData("jstree_is_loading")),this.clean_node(c),e&&e.call(this)):c&&-1!==c?(c.children("a.jstree-loading").removeClass("jstree-loading"),c.removeData("jstree_is_loading"),l.correct_state&&(this.correct_state(c),e&&e.call(this))):l.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this))},l.ajax.context=
this,l.ajax.error=n,l.ajax.success=f,l.ajax.dataType||(l.ajax.dataType="html"),a.isFunction(l.ajax.url)&&(l.ajax.url=l.ajax.url.call(this,c)),a.isFunction(l.ajax.data)&&(l.ajax.data=l.ajax.data.call(this,c)),a.ajax(l.ajax)}}}});a.jstree.defaults.plugins.push("html_data")})(jQuery);(function(a){a.jstree.plugin("themeroller",{__init:function(){var c=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(e){a(e.currentTarget).hasClass("jstree-loading")||
a(this).addClass(c.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(c.item_h)}).bind("init.jstree",a.proxy(function(a,c){c.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(c.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",a.proxy(function(a){this._themeroller()},this)).bind("close_node.jstree",
a.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,f){f.rslt.obj.children("ins.jstree-icon").removeClass(c.opened+" "+c.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_open+" "+c.item_clsd).addClass(c.item_leaf||
"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,f){f.rslt.obj.children("a").addClass(c.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(a,f){this.get_container().find("a."+c.item_a).removeClass(c.item_a).end().find("a.jstree-clicked").addClass(c.item_a)},this)).bind("dehover_node.jstree",a.proxy(function(a,f){f.rslt.obj.children("a").removeClass(c.item_h)},this)).bind("hover_node.jstree",a.proxy(function(a,f){this.get_container().find("a."+c.item_h).not(f.rslt.obj).removeClass(c.item_h);
f.rslt.obj.children("a").addClass(c.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,c){this._themeroller(c.rslt.o);this._themeroller(c.rslt.op)},this))},__destroy:function(){var c=this._get_settings().themeroller,e=["ui-icon"];a.each(c,function(a,c){c=c.split(" ");c.length&&(e=e.concat(c))});this.get_container().removeClass("ui-widget-content").find("."+e.join(", .")).removeClass(e.join(" "))},_fn:{_themeroller:function(a){var e=this._get_settings().themeroller;a=!a||-1==a?this.get_container_ul():
this._get_node(a);a=!a||-1==a?this.get_container_ul():a.parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(e.opened).addClass("ui-icon "+e.closed).end().children("a").addClass(e.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(e.item_clsd,"").replace(e.item_open,"").replace(e.item_leaf,"").indexOf("ui-icon-")}).removeClass(e.item_leaf+" "+e.item_open).addClass(e.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(e.closed).addClass("ui-icon "+
e.opened).end().children("a").addClass(e.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(e.item_clsd,"").replace(e.item_open,"").replace(e.item_leaf,"").indexOf("ui-icon-")}).removeClass(e.item_leaf+" "+e.item_clsd).addClass(e.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(e.closed+" ui-icon "+e.opened).end().children("a").addClass(e.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===
this.className.toString().replace(e.item_clsd,"").replace(e.item_open,"").replace(e.item_leaf,"").indexOf("ui-icon-")}).removeClass(e.item_clsd+" "+e.item_open).addClass(e.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});a(function(){a.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",
title:"jstree"})})})(jQuery);(function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(c,e){var f=[],l=!0,n;"move_node"==e.func&&(!0===e.args[4]&&e.args[0].o&&e.args[0].o.length)&&(e.args[0].o.children("a").each(function(){f.push(a(this).text().replace(/^\s+/g,""))}),l=this._check_unique(f,e.args[0].np.find("> ul > li").not(e.args[0].o),"move_node"));if("create_node"==e.func&&(e.args[4]||this._is_loaded(e.args[0]))){l=this._get_node(e.args[0]);
if(e.args[1]&&("before"===e.args[1]||"after"===e.args[1]))if(l=this._get_parent(e.args[0]),!l||-1===l)l=this.get_container();"string"===typeof e.args[2]?f.push(e.args[2]):!e.args[2]||!e.args[2].data?f.push(this._get_string("new_node")):f.push(e.args[2].data);l=this._check_unique(f,l.find("> ul > li"),"create_node")}if("rename_node"==e.func){f.push(e.args[1]);n=this._get_node(e.args[0]);l=this._get_parent(n);if(!l||-1===l)l=this.get_container();l=this._check_unique(f,l.find("> ul > li").not(n),"rename_node")}if(!l)return c.stopPropagation(),
!1},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(c,e,f){var l=[],n=!0;e.children("a").each(function(){l.push(a(this).text().replace(/^\s+/g,""))});if(!l.length||!c.length)return!0;a.each(c,function(c,e){if(-1!==a.inArray(e,l))return n=!1});n||this._get_settings().unique.error_callback.call(null,c,e,f);return n},check_move:function(){if(!this.__call_old())return!1;var c=this._get_move(),e=[];return c.o&&c.o.length?(c.o.children("a").each(function(){e.push(a(this).text().replace(/^\s+/g,
""))}),this._check_unique(e,c.np.find("> ul > li").not(c.o),"check_move")):!0}}})})(jQuery);(function(a){a.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",a.proxy(function(a,e){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",a.proxy(function(a,e){this._prepare_wholerow_span(e&&
e.rslt&&e.rslt.obj?e.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",a.proxy(function(a,e){this.data.to&&clearTimeout(this.data.to);this.data.to=setTimeout(function(a,c){return function(){a._prepare_wholerow_ul(c)}}(this,e&&e.rslt&&e.rslt.obj?e.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",a.proxy(function(a,e){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+
(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",a.proxy(function(c,e){e.rslt.obj.each(function(){e.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((a(this).offset().top-e.inst.get_container().offset().top+e.inst.get_container()[0].scrollTop)/e.inst.data.core.li_height,10)+")").children("a").attr("class",e.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",a.proxy(function(a,
e){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===a.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((e.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",e.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li",
"click.jstree",function(c){var e=a(c.currentTarget);"A"===c.target.tagName||"INS"===c.target.tagName&&e.closest("li").is(".jstree-open, .jstree-closed")||(e.closest("li").children("a:visible:eq(0)").click(),c.stopImmediatePropagation())}).delegate("li","mouseover.jstree",a.proxy(function(c){c.stopImmediatePropagation();if(a(c.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(c.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",a.proxy(function(c){a(c.currentTarget).children("a").hasClass("jstree-hovered").length||
this.dehover_node(c.currentTarget)},this));(l||f)&&a.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(c){c=!c||-1==c?this.get_container().find("> ul > li"):this._get_node(c);!1!==c&&c.each(function(){a(this).find("li").addBack().each(function(){var c=a(this);if(c.children(".jstree-wholerow-span").length)return!0;
c.prepend("<span class='jstree-wholerow-span' style='width:"+18*c.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var a=this.get_container().children("ul").eq(0),e=a.html();a.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==e&&(this.data.wholerow.last_html=e,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(a.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(a.parent()[0].scrollWidth).css("top",
-1*(a.height()+(l?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});a(function(){var c=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
n&&(c+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(l||f)c+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";a.vakata.css.add_sheet({str:c,title:"jstree"})})})(jQuery);(function(a){var c=
["getChildren","getChildrenCount","getAttr","getName","getProps"],e=function(c,e){var f=!0;c=c||{};e=[].concat(e);a.each(e,function(e,l){if(!a.isFunction(c[l]))return f=!1});return f};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(f,l){var n=-1==f?this._get_settings().model.object:f.data("jstree_model");if(!e(n,c))return l.call(null,!1);this._get_settings().model.async?n.getChildren(a.proxy(function(a){this.model_done(a,
l)},this)):this.model_done(n.getChildren(),l)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(c,e){var f=[],l=this._get_settings(),n=this;a.isArray(c)||(c=[c]);a.each(c,function(c,e){var g=e.getProps()||{};g.attr=e.getAttr()||{};e.getChildrenCount()&&(g.state="closed");g.data=e.getName();a.isArray(g.data)||(g.data=[g.data]);n.data.types&&a.isFunction(e.getType)&&(g.attr[l.types.type_attr]=e.getType());g.attr.id&&l.model.id_prefix&&(g.attr.id=l.model.id_prefix+g.attr.id);g.metadata||
(g.metadata={});g.metadata.jstree_model=e;f.push(g)});e.call(null,f)}}})})(jQuery)}})();
(function(f){f.color={};f.color.make=function(l,a,c,e){var g={};g.r=l||0;g.g=a||0;g.b=c||0;g.a=null!=e?e:1;g.add=function(a,c){for(var e=0;e<a.length;++e)g[a.charAt(e)]+=c;return g.normalize()};g.scale=function(a,c){for(var e=0;e<a.length;++e)g[a.charAt(e)]*=c;return g.normalize()};g.toString=function(){return 1<=g.a?"rgb("+[g.r,g.g,g.b].join()+")":"rgba("+[g.r,g.g,g.b,g.a].join()+")"};g.normalize=function(){function a(c,e,f){return e<c?c:e>f?f:e}g.r=a(0,parseInt(g.r),255);g.g=a(0,parseInt(g.g),255);
g.b=a(0,parseInt(g.b),255);g.a=a(0,g.a,1);return g};g.clone=function(){return f.color.make(g.r,g.b,g.g,g.a)};return g.normalize()};f.color.extract=function(l,a){var c;do{c=l.css(a).toLowerCase();if(""!=c&&"transparent"!=c)break;l=l.parent()}while(!f.nodeName(l.get(0),"body"));"rgba(0, 0, 0, 0)"==c&&(c="transparent");return f.color.parse(c)};f.color.parse=function(n){var a,c=f.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return c(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return c(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return c(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return c(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return c(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return c(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));n=f.trim(n).toLowerCase();if("transparent"==n)return c(255,255,255,0);a=l[n]||[0,0,0];return c(a[0],a[1],a[2])};var l={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(f,l,n){var a=l.event,c;a.special.smartresize={setup:function(){l(this).bind("resize",a.special.smartresize.handler)},teardown:function(){l(this).unbind("resize",a.special.smartresize.handler)},handler:function(a,e){var f=this,g=arguments;a.type="smartresize";c&&clearTimeout(c);c=setTimeout(function(){jQuery.event.handle.apply(f,g)},"execAsap"===e?0:100)}};l.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])};l.Mason=function(a,c){this.element=
l(c);this._create(a);this._init()};var e=["position","height"];l.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1};l.Mason.prototype={_filterFindBricks:function(a){var c=this.options.itemSelector;return c?a.filter(c).add(a.find(c)):a},_getBricks:function(a){return this._filterFindBricks(a).css({position:"absolute"}).addClass("masonry-brick")},_create:function(a){this.options=l.extend(!0,{},l.Mason.settings,a);this.styleQueue=
[];this.reloadItems();a=this.element[0].style;this.originalStyle={};for(var c=0,g=e.length;c<g;c++){var n=e[c];this.originalStyle[n]=a[n]||""}this.element.css({position:"relative"});this.horizontalDirection=this.options.isRTL?"right":"left";this.offset={};a=l(document.createElement("div"));this.element.prepend(a);this.offset.y=Math.round(a.position().top);this.options.isRTL?(a.css({"float":"right",display:"inline-block"}),this.offset.x=Math.round(this.element.outerWidth()-a.position().left)):this.offset.x=
Math.round(a.position().left);a.remove();var y=this;setTimeout(function(){y.element.addClass("masonry")},0);this.options.isResizable&&l(f).bind("smartresize.masonry",function(){y.resize()})},_init:function(a){this._getColumns("masonry");this._reLayout(a)},option:function(a,c){l.isPlainObject(a)&&(this.options=l.extend(!0,this.options,a))},layout:function(a,c){for(var e,f,g,n,x,K,O=0,X=a.length;O<X;O++)if(e=l(a[O]),f=Math.ceil(e.outerWidth(!0)/this.columnWidth),f=Math.min(f,this.cols),1===f)this._placeBrick(e,
this.colYs);else{g=this.cols+1-f;n=[];for(K=0;K<g;K++)x=this.colYs.slice(K,K+f),n[K]=Math.max.apply(Math,x);this._placeBrick(e,n)}X={};X.height=Math.max.apply(Math,this.colYs)-this.offset.y;if(this.options.isFitWidth){e=0;for(O=this.cols;--O&&this.colYs[O]===this.offset.y;)e++;X.width=(this.cols-e)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:X});e=this.isLaidOut?this.options.isAnimated?"animate":"css":"css";f=this.options.animationOptions;O=0;for(X=this.styleQueue.length;O<
X;O++)g=this.styleQueue[O],g.$el[e](g.style,f);this.styleQueue=[];c&&c.call(a);this.isLaidOut=!0},_getColumns:function(){var a=(this.options.isFitWidth?this.element.parent():this.element).width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(!0)||a;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((a+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(a,c){for(var e=Math.min.apply(Math,c),f=0,g=0,l=c.length;g<l;g++)if(c[g]===
e){f=g;break}g={top:e};g[this.horizontalDirection]=this.columnWidth*f+this.offset.x;this.styleQueue.push({$el:a,style:g});e+=a.outerHeight(!0);l=this.cols+1-l;for(g=0;g<l;g++)this.colYs[f+g]=e},resize:function(){var a=this.cols;this._getColumns("masonry");this.cols!==a&&this._reLayout()},_reLayout:function(a){var c=this.cols;for(this.colYs=[];c--;)this.colYs.push(this.offset.y);this.layout(this.$bricks,a)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(a){this.reloadItems();
this._init(a)},appended:function(a,c,e){if(c){this._filterFindBricks(a).css({top:this.element.height()});var f=this;setTimeout(function(){f._appended(a,e)},1)}else this._appended(a,e)},_appended:function(a,c){var e=this._getBricks(a);this.$bricks=this.$bricks.add(e);this.layout(e,c)},remove:function(a){this.$bricks=this.$bricks.not(a);a.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});for(var a=this.element[0].style,
c=0,g=e.length;c<g;c++){var n=e[c];a[n]=this.originalStyle[n]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry");l(f).unbind(".masonry")}};l.fn.imagesLoaded=function(a){function c(){0>=--l&&this.src!==x&&(setTimeout(e),g.unbind("load error",c))}function e(){a.call(f,g)}var f=this,g=f.find("img").add(f.filter("img")),l=g.length,x="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";l||e();g.bind("load error",c).each(function(){if(this.complete||this.complete===
n){var a=this.src;this.src=x;this.src=a}});return f};var g=function(a){this.console&&console.error(a)};l.fn.masonry=function(a){if("string"==typeof a){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var e=l.data(this,"masonry");e?!l.isFunction(e[a])||"_"===a.charAt(0)?g("no such method '"+a+"' for masonry instance"):e[a].apply(e,c):g("cannot call methods on masonry prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){var c=l.data(this,"masonry");
c?(c.option(a||{}),c._init()):l.data(this,"masonry",new l.Mason(a,this))});return this}})(window,jQuery);
jQuery.cookie=function(f,l,n){if(1<arguments.length&&"[object Object]"!==String(l)){n=jQuery.extend({},n);if(null===l||void 0===l)n.expires=-1;if("number"===typeof n.expires){var a=n.expires,c=n.expires=new Date;c.setDate(c.getDate()+a)}l=String(l);return document.cookie=[encodeURIComponent(f),"=",n.raw?l:encodeURIComponent(l),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=l||{};c=n.raw?function(a){return a}:
decodeURIComponent;return(a=RegExp("(?:^|; )"+encodeURIComponent(f)+"=([^;]*)").exec(document.cookie))?c(a[1]):null};
d3=function(){function f(d){return null!=d&&!isNaN(d)}function l(d){return d.length}function n(d,s){try{for(var a in s)Object.defineProperty(d.prototype,a,{value:s[a],enumerable:!1})}catch(c){d.prototype=s}}function a(){}function c(){}function e(d,s,a){return function(){var c=a.apply(s,arguments);return c===s?d:c}}function g(){}function q(d){function s(){for(var s,a=r,c=-1,J=a.length;++c<J;)(s=a[c].on)&&s.apply(this,arguments);return d}var r=[],c=new a;return s.on=function(s,a){var e,t=c.get(s);return 2>
arguments.length?t&&t.on:(t&&(t.on=null,r=r.slice(0,e=r.indexOf(t)).concat(r.slice(e+1)),c.remove(s)),a&&r.push(c.set(s,{on:a})),d)},s}function v(){m.event.stopPropagation();m.event.preventDefault()}function R(){for(var d,s=m.event;d=s.sourceEvent;)s=d;return s}function V(d,s){function a(){d.on(s,null)}d.on(s,function(){v();a()},!0);setTimeout(a,0)}function y(d){for(var s=new g,a=0,c=arguments.length;++a<c;)s[arguments[a]]=q(s);return s.of=function(a,r){return function(c){try{var J=c.sourceEvent=
m.event;c.target=d;m.event=c;s[c.type].apply(a,r)}finally{m.event=J}}},s}function H(d,s){var a=d.ownerSVGElement||d;if(a.createSVGPoint){var c=a.createSVGPoint();if(0>Sb&&(ha.scrollX||ha.scrollY)){var a=m.select(ka.body).append("svg").style("position","absolute").style("top",0).style("left",0),p=a[0][0].getScreenCTM();Sb=!(p.f||p.e);a.remove()}return Sb?(c.x=s.pageX,c.y=s.pageY):(c.x=s.clientX,c.y=s.clientY),c=c.matrixTransform(d.getScreenCTM().inverse()),[c.x,c.y]}a=d.getBoundingClientRect();return[s.clientX-
a.left-d.clientLeft,s.clientY-a.top-d.clientTop]}function x(d){for(var s=-1,a=d.length,c=[];++s<a;)c.push(d[s]);return c}function K(d){return Tb(d,W),d}function O(d){return function(){return cd(d,this)}}function X(d){return function(){return dd(d,this)}}function Wa(d,s){function a(){this.removeAttribute(d)}function c(){this.removeAttributeNS(d.space,d.local)}function p(){this.setAttribute(d,s)}function u(){this.setAttributeNS(d.space,d.local,s)}function e(){var a=s.apply(this,arguments);null==a?this.removeAttribute(d):
this.setAttribute(d,a)}function t(){var a=s.apply(this,arguments);null==a?this.removeAttributeNS(d.space,d.local):this.setAttributeNS(d.space,d.local,a)}return d=m.ns.qualify(d),null==s?d.local?c:a:"function"==typeof s?d.local?t:e:d.local?u:p}function La(d){return d.trim().replace(/\s+/g," ")}function ad(d){return RegExp("(?:^|\\s+)"+m.requote(d)+"(?:\\s+|$)","g")}function bd(d,s){function a(){for(var r=-1;++r<p;)d[r](this,s)}function c(){for(var a=-1,r=s.apply(this,arguments);++a<p;)d[a](this,r)}
d=d.trim().split(/\s+/).map(tf);var p=d.length;return"function"==typeof s?c:a}function tf(d){var s=ad(d);return function(a,c){if(p=a.classList)return c?p.add(d):p.remove(d);var p=a.getAttribute("class")||"";c?(s.lastIndex=0,s.test(p)||a.setAttribute("class",La(p+" "+d))):a.setAttribute("class",La(p.replace(s," ")))}}function ed(d,s,a){function c(){this.style.removeProperty(d)}function p(){this.style.setProperty(d,s,a)}function u(){var c=s.apply(this,arguments);null==c?this.style.removeProperty(d):
this.style.setProperty(d,c,a)}return null==s?c:"function"==typeof s?u:p}function fd(d,s){function a(){delete this[d]}function c(){this[d]=s}function p(){var a=s.apply(this,arguments);null==a?delete this[d]:this[d]=a}return null==s?a:"function"==typeof s?p:c}function gd(d){return function(){return hd(this,d)}}function uf(d){return arguments.length||(d=m.ascending),function(s,a){return!s-!a||d(s.__data__,a.__data__)}}function ea(){}function id(d,s,a){function c(){var s=this[e];s&&(this.removeEventListener(d,
s,s.$),delete this[e])}function p(){var p=P(s,Aa(arguments));c.call(this);this.addEventListener(d,this[e]=p,p.$=a);p._=s}function u(){var s,a=RegExp("^__on([^.]+)"+m.requote(d)+"$"),r;for(r in this)if(s=r.match(a)){var c=this[r];this.removeEventListener(s[1],c,c.$);delete this[r]}}var e="__on"+d,t=d.indexOf("."),P=jd;0<t&&(d=d.substring(0,t));var f=Ub.get(d);return f&&(d=f,P=vf),t?s?p:c:s?ea:u}function jd(d,s){return function(a){var c=m.event;m.event=a;s[0]=this.__data__;try{d.apply(this,s)}finally{m.event=
c}}}function vf(d,s){var a=jd(d,s);return function(d){var s=d.relatedTarget;s&&(s===this||s.compareDocumentPosition(this)&8)||a.call(this,d)}}function Ba(d,s){for(var a=0,c=d.length;c>a;a++)for(var p,u=d[a],e=0,t=u.length;t>e;e++)(p=u[e])&&s(p,e,a);return d}function kd(d){return Tb(d,Ga),d}function Ma(){}function Na(d,s,a){return new Vb(d,s,a)}function Vb(d,s,a){this.h=d;this.s=s;this.l=a}function gb(d,s,a){function c(d){return 360<d?d-=360:0>d&&(d+=360),60>d?p+(u-p)*d/60:180>d?u:240>d?p+(u-p)*(240-
d)/60:p}var p,u;return d%=360,0>d&&(d+=360),s=0>s?0:1<s?1:s,a=0>a?0:1<a?1:a,u=0.5>=a?a*(1+s):a+s-a*s,p=2*a-u,va(Math.round(255*c(d+120)),Math.round(255*c(d)),Math.round(255*c(d-120)))}function ld(d){return(d=Math.sin(d/2))*d}function Oa(d,s,a){return new hb(d,s,a)}function hb(d,s,a){this.h=d;this.c=s;this.l=a}function Wb(d,s,a){return Pa(a,Math.cos(d*=L)*s,Math.sin(d)*s)}function Pa(d,s,a){return new ib(d,s,a)}function ib(d,s,a){this.l=d;this.a=s;this.b=a}function md(d,s,a){d=(d+16)/116;s=d+s/500;
a=d-a/200;return s=Xb(s)*nd,d=Xb(d)*od,a=Xb(a)*pd,va(Yb(3.2404542*s-1.5371385*d-0.4985314*a),Yb(-0.969266*s+1.8760108*d+0.041556*a),Yb(0.0556434*s-0.2040259*d+1.0572252*a))}function Xb(d){return 0.206893034<d?d*d*d:(d-4/29)/7.787037}function Zb(d){return 0.008856<d?Math.pow(d,1/3):7.787037*d+4/29}function Yb(d){return Math.round(255*(0.00304>=d?12.92*d:1.055*Math.pow(d,1/2.4)-0.055))}function va(d,s,a){return new $b(d,s,a)}function $b(d,s,a){this.r=d;this.g=s;this.b=a}function Qa(d){return 16>d?"0"+
Math.max(0,d).toString(16):Math.min(255,d).toString(16)}function ac(d,s,a){var c,p,u,e=0,t=0,P=0;if(c=/([a-z]+)\((.*)\)/i.exec(d))switch(p=c[2].split(","),c[1]){case "hsl":return a(parseFloat(p[0]),parseFloat(p[1])/100,parseFloat(p[2])/100);case "rgb":return s(bc(p[0]),bc(p[1]),bc(p[2]))}return(u=jb.get(d))?s(u.r,u.g,u.b):(null!=d&&"#"===d.charAt(0)&&(4===d.length?(e=d.charAt(1),e+=e,t=d.charAt(2),t+=t,P=d.charAt(3),P+=P):7===d.length&&(e=d.substring(1,3),t=d.substring(3,5),P=d.substring(5,7)),e=
parseInt(e,16),t=parseInt(t,16),P=parseInt(P,16)),s(e,t,P))}function qd(d,s,a){var c,p,u=Math.min(d/=255,s/=255,a/=255),e=Math.max(d,s,a),t=e-u,P=(e+u)/2;return t?(p=0.5>P?t/(e+u):t/(2-e-u),c=d==e?(s-a)/t+(a>s?6:0):s==e?(a-d)/t+2:(d-s)/t+4,c*=60):p=c=0,Na(c,p,P)}function rd(d,s,a){d=cc(d);s=cc(s);a=cc(a);var c=Zb((0.4124564*d+0.3575761*s+0.1804375*a)/nd),p=Zb((0.2126729*d+0.7151522*s+0.072175*a)/od);d=Zb((0.0193339*d+0.119192*s+0.9503041*a)/pd);return Pa(116*p-16,500*(c-p),200*(p-d))}function cc(d){return 0.04045>=
(d/=255)?d/12.92:Math.pow((d+0.055)/1.055,2.4)}function bc(d){var s=parseFloat(d);return"%"===d.charAt(d.length-1)?Math.round(2.55*s):s}function T(d){return"function"==typeof d?d:function(){return d}}function ma(d){return d}function wf(d){return 1===d.length?function(s,a){d(null==s?a:null)}:d}function sd(d,a){function r(d,r,c){3>arguments.length&&(c=r,r=null);var u=m.xhr(d,a,c);return u.row=function(d){return arguments.length?u.response(null==(r=d)?J:p(d)):r},u.row(r)}function J(d){return r.parse(d.responseText)}
function p(d){return function(a){return r.parse(a.responseText,d)}}function u(a){return a.map(e).join(d)}function e(d){return t.test(d)?'"'+d.replace(/\"/g,'""')+'"':d}var t=RegExp('["'+d+"\n]"),P=d.charCodeAt(0);return r.parse=function(d,a){var s;return r.parseRows(d,function(d,r){if(s)return s(d,r-1);var c=Function("d","return {"+d.map(function(d,a){return JSON.stringify(d)+": d["+a+"]"}).join(",")+"}");s=a?function(d,s){return a(c(d),s)}:c})},r.parseRows=function(d,a){function s(){if(t>=e)return J;
if(c)return c=!1,p;var a=t;if(34===d.charCodeAt(a)){for(var r=a;r++<e;)if(34===d.charCodeAt(r)){if(34!==d.charCodeAt(r+1))break;++r}t=r+2;var u=d.charCodeAt(r+1);return 13===u?(c=!0,10===d.charCodeAt(r+2)&&++t):10===u&&(c=!0),d.substring(a+1,r).replace(/""/g,'"')}for(;e>t;){u=d.charCodeAt(t++);r=1;if(10===u)c=!0;else if(13===u)c=!0,10===d.charCodeAt(t)&&(++t,++r);else if(u!==P)continue;return d.substring(a,t-r)}return d.substring(a)}for(var r,c,p={},J={},u=[],e=d.length,t=0,U=0;(r=s())!==J;){for(var f=
[];r!==p&&r!==J;)f.push(r),r=s();(!a||(f=a(f,U++)))&&u.push(f)}return u},r.format=function(a){if(Array.isArray(a[0]))return r.formatRows(a);var s=new c,p=[];return a.forEach(function(d){for(var a in d)s.has(a)||p.push(s.add(a))}),[p.map(e).join(d)].concat(a.map(function(a){return p.map(function(d){return e(a[d])}).join(d)})).join("\n")},r.formatRows=function(d){return d.map(u).join("\n")},r}function dc(){for(var d,a=Date.now(),r=Ra;r;)d=a-r.then,d>=r.delay&&(r.flush=r.callback(d)),r=r.next;d=td()-
a;24<d?(isFinite(d)&&(clearTimeout(kb),kb=setTimeout(dc,d)),lb=0):(lb=1,ud(dc))}function td(){for(var d=null,a=Ra,r=1/0;a;)a.flush?(delete ec[a.callback.id],a=d?d.next=a.next:Ra=a.next):(r=Math.min(r,a.then+a.delay),a=(d=a).next);return r}function fc(d,a){return a-(d?Math.ceil(Math.log(d)/Math.LN10):1)}function xf(d){return d+""}function mb(d,a){d&&vd.hasOwnProperty(d.type)&&vd[d.type](d,a)}function gc(d,a,r){var c=-1,p=d.length-r;for(a.lineStart();++c<p;)r=d[c],a.point(r[0],r[1]);a.lineEnd()}function wd(d,
a){var r=-1,c=d.length;for(a.polygonStart();++r<c;)gc(d[r],a,1);a.polygonEnd()}function yf(){function d(d,a){d*=L;a=a*L/2+E/4;var s=d-c,r=Math.cos(a),e=Math.sin(a),f=u*e,g=nb,l=ob,m=p*r+f*Math.cos(s),s=f*Math.sin(s);nb=g*m-l*s;ob=l*m+g*s;c=d;p=r;u=e}var a,r,c,p,u;Ca.point=function(e,t){Ca.point=d;c=(a=e)*L;p=Math.cos(t=(r=t)*L/2+E/4);u=Math.sin(t)};Ca.lineEnd=function(){d(a,r)}}function xd(d){function a(d,s){c>d&&(c=d);d>u&&(u=d);p>s&&(p=s);s>e&&(e=s)}function r(){t.point=t.lineEnd=ea}var c,p,u,e,
t={point:a,lineStart:ea,lineEnd:ea,polygonStart:function(){t.lineEnd=r},polygonEnd:function(){t.point=a}};return function(a){return e=u=-(c=p=1/0),m.geo.stream(a,d(t)),[[c,p],[u,e]]}}function yd(d,a){if(!ga){++pa;d*=L;var r=Math.cos(a*=L);ca+=(r*Math.cos(d)-ca)/pa;da+=(r*Math.sin(d)-da)/pa;aa+=(Math.sin(a)-aa)/pa}}function zf(){var d,a;ga=1;hc();ga=2;var r=qa.point;qa.point=function(c,p){r(d=c,a=p)};qa.lineEnd=function(){qa.point(d,a);ic();qa.lineEnd=ic}}function hc(){function d(d,u){d*=L;var e=Math.cos(u*=
L),t=e*Math.cos(d),e=e*Math.sin(d),f=Math.sin(u),g=Math.atan2(Math.sqrt((g=r*f-c*e)*g+(g=c*t-a*f)*g+(g=a*e-r*t)*g),a*t+r*e+c*f);pa+=g;ca+=g*(a+(a=t));da+=g*(r+(r=e));aa+=g*(c+(c=f))}var a,r,c;1<ga||(1>ga&&(ga=1,pa=ca=da=aa=0),qa.point=function(p,u){p*=L;var e=Math.cos(u*=L);a=e*Math.cos(p);r=e*Math.sin(p);c=Math.sin(u);qa.point=d})}function ic(){qa.point=yd}function pb(d){var a=d[0];d=d[1];var r=Math.cos(d);return[r*Math.cos(a),r*Math.sin(a),Math.sin(d)]}function qb(d,a){return d[0]*a[0]+d[1]*a[1]+
d[2]*a[2]}function zd(d,a){return[d[1]*a[2]-d[2]*a[1],d[2]*a[0]-d[0]*a[2],d[0]*a[1]-d[1]*a[0]]}function jc(d,a){d[0]+=a[0];d[1]+=a[1];d[2]+=a[2]}function rb(d,a){return[d[0]*a,d[1]*a,d[2]*a]}function Xa(){return!0}function kc(d){return[Math.atan2(d[1],d[0]),Math.asin(Math.max(-1,Math.min(1,d[2])))]}function sb(d,a){return Math.abs(d[0]-a[0])<N&&Math.abs(d[1]-a[1])<N}function Ad(d,a,r,c,p){var u=[],e=[];if(d.forEach(function(d){if(!(0>=(a=d.length-1))){var a,s=d[0],r=d[a];if(sb(s,r)){p.lineStart();
for(r=0;a>r;++r)p.point((s=d[r])[0],s[1]);return p.lineEnd(),void 0}d={point:s,points:d,other:null,visited:!1,entry:!0,subject:!0};s={point:s,points:[s],other:d,visited:!1,entry:!1,subject:!1};d.other=s;u.push(d);e.push(s);d={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0};s={point:r,points:[r],other:d,visited:!1,entry:!0,subject:!1};d.other=s;u.push(d);e.push(s)}}),e.sort(a),Bd(u),Bd(e),u.length){if(r){d=1;r=!r(e[0].point);for(a=e.length;a>d;++d)e[d].entry=r=!r}for(var t,f=u[0];;){for(r=
f;r.visited;)if((r=r.next)===f)return;a=r.points;p.lineStart();do{if(r.visited=r.other.visited=!0,r.entry){if(r.subject)for(d=0;d<a.length;d++)p.point((t=a[d])[0],t[1]);else c(r.point,r.next.point,1,p);r=r.next}else{if(r.subject){a=r.prev.points;for(d=a.length;0<=--d;)p.point((t=a[d])[0],t[1])}else c(r.point,r.prev.point,-1,p);r=r.prev}r=r.other;a=r.points}while(!r.visited);p.lineEnd()}}}function Bd(d){if(a=d.length){for(var a,r,c=0,p=d[0];++c<a;)p.next=r=d[c],r.prev=p,p=r;p.next=r=d[0];r.prev=p}}
function Cd(d,a,r){return function(c){function p(a,s){d(a,s)&&c.point(a,s)}function e(d,a){B.point(d,a)}function f(){A.point=e;B.lineStart()}function t(){A.point=p;B.lineEnd()}function P(d,a){Q.point(d,a);z.push([d,a])}function g(){Q.lineStart();z=[]}function l(){P(z[0][0],z[0][1]);Q.lineEnd();var d;d=Q.clean();var a=G.buffer(),s=a.length;if(!s)return C=!0,q+=Dd(z,-1),z=null,void 0;if(z=null,1&d){d=a[0];D+=Dd(d,1);var r,s=d.length-1,a=-1;for(c.lineStart();++a<s;)c.point((r=d[a])[0],r[1]);return c.lineEnd(),
void 0}1<s&&2&d&&a.push(a.pop().concat(a.shift()));n.push(a.filter(Af))}var n,D,q,C,z,B=a(c),A={point:p,lineStart:f,lineEnd:t,polygonStart:function(){A.point=P;A.lineStart=g;A.lineEnd=l;C=!1;q=D=0;n=[];c.polygonStart()},polygonEnd:function(){A.point=p;A.lineStart=f;A.lineEnd=t;n=m.merge(n);n.length?Ad(n,Bf,null,r,c):(-N>D||C&&-N>q)&&(c.lineStart(),r(null,null,1,c),c.lineEnd());c.polygonEnd();n=null},sphere:function(){c.polygonStart();c.lineStart();r(null,null,1,c);c.lineEnd();c.polygonEnd()}},G=Ed(),
Q=a(G);return A}}function Af(d){return 1<d.length}function Ed(){var d,a=[];return{lineStart:function(){a.push(d=[])},point:function(a,s){d.push([a,s])},lineEnd:ea,buffer:function(){var r=a;return a=[],d=null,r},rejoin:function(){1<a.length&&a.push(a.pop().concat(a.shift()))}}}function Dd(d,a){if(!(r=d.length))return 0;var r,c,p,e=0,f=0;c=d[0];p=c[0];for(var t=c[1],P=Math.cos(t),g=Math.atan2(a*Math.sin(p)*P,Math.sin(t)),l=1-a*Math.cos(p)*P,m=g;++e<r;)c=d[e],P=Math.cos(t=c[1]),c=Math.atan2(a*Math.sin(p=
c[0])*P,Math.sin(t)),p=1-a*Math.cos(p)*P,Math.abs(l-2)<N&&Math.abs(p-2)<N||(Math.abs(p)<N||Math.abs(l)<N||(Math.abs(Math.abs(c-g)-E)<N?2<p+l&&(f+=4*(c-g)):f+=Math.abs(l-2)<N?4*(c-m):((3*E+c-g)%(2*E)-E)*(l+p)),m=g,g=c,l=p);return f}function Bf(d,a){return(0>(d=d.point)[0]?d[1]-E/2-N:E/2-d[1])-(0>(a=a.point)[0]?a[1]-E/2-N:E/2-a[1])}function Cf(d){function a(d,s){return Math.cos(d)*Math.cos(s)>p}function r(d,a,s){var r=pb(d),c=pb(a),e=[1,0,0],c=zd(r,c),J=qb(c,c),r=c[0],u=J-r*r;if(!u)return!s&&d;J=p*
J/u;u=-p*r/u;r=zd(e,c);e=rb(e,J);c=rb(c,u);jc(e,c);c=qb(e,r);J=qb(r,r);u=c*c-J*(qb(e,e)-1);if(!(0>u)){var t=Math.sqrt(u),u=rb(r,(-c-t)/J);if(jc(u,e),u=kc(u),!s)return u;var f;s=d[0];var U=a[0];d=d[1];a=a[1];s>U&&(f=s,s=U,U=f);var g=U-s,l=Math.abs(g-E)<N,m=l||N>g;if(!l&&d>a&&(f=d,d=a,a=f),m?l?0<d+a^u[1]<(Math.abs(u[0]-s)<N?d:a):d<=u[1]&&u[1]<=a:g>E^(s<=u[0]&&u[0]<=U))return f=rb(r,(-c+t)/J),jc(f,e),[u,kc(f)]}}function c(a,s){var r=e?d:E-d,p=0;return-r>a?p|=1:a>r&&(p|=2),-r>s?p|=4:s>r&&(p|=8),p}var p=
Math.cos(d),e=0<p,f=Math.abs(p)>N,t=lc(d,6*L);return Cd(a,function(d){var p,t,g,l,m;return{lineStart:function(){l=g=!1;m=1},point:function(n,q){var B,A=[n,q],G=a(n,q),Q=e?G?0:c(n,q):G?c(n+(0>n?E:-E),q):0;if(!p&&(l=g=G)&&d.lineStart(),G!==g&&(B=r(p,A),(sb(p,B)||sb(A,B))&&(A[0]+=N,A[1]+=N,G=a(A[0],A[1]))),G!==g)m=0,G?(d.lineStart(),B=r(A,p),d.point(B[0],B[1])):(B=r(p,A),d.point(B[0],B[1]),d.lineEnd()),p=B;else if(f&&p&&e^G){var M;Q&t||!(M=r(A,p,!0))||(m=0,e?(d.lineStart(),d.point(M[0][0],M[0][1]),d.point(M[1][0],
M[1][1]),d.lineEnd()):(d.point(M[1][0],M[1][1]),d.lineEnd(),d.lineStart(),d.point(M[0][0],M[0][1])))}!G||p&&sb(p,A)||d.point(A[0],A[1]);p=A;g=G;t=Q},lineEnd:function(){g&&d.lineEnd();p=null},clean:function(){return m|(l&&g)<<1}}},t)}function Df(d,a,r,c){function p(c,p){return Math.abs(c[0]-d)<N?0<p?0:3:Math.abs(c[0]-r)<N?0<p?2:1:Math.abs(c[1]-a)<N?0<p?1:0:0<p?3:2}function e(d,a){return f(d.point,a.point)}function f(d,a){var s=p(d,1),r=p(a,1);return s!==r?s-r:0===s?a[1]-d[1]:1===s?d[0]-a[0]:2===s?
d[1]-a[1]:a[0]-d[0]}return function(t){function P(e){e=p(e,-1);return g([0===e||3===e?d:r,1<e?c:a])}function g(d){for(var a=0,s=C.length,r=d[1],c=0;s>c;++c)for(var p=1,e=C[c],u=e.length,J=e[0];u>p;++p)b=e[p],J[1]<=r?b[1]>r&&0<(b[0]-J[0])*(d[1]-J[1])-(d[0]-J[0])*(b[1]-J[1])&&++a:b[1]<=r&&0>(b[0]-J[0])*(d[1]-J[1])-(d[0]-J[0])*(b[1]-J[1])&&--a,J=b;return 0!==a}function l(e,u,t,P){var g=0,m=0;if(null==e||(g=p(e,t))!==(m=p(u,t))||0>f(e,u)^0<t){do P.point(0===g||3===g?d:r,1<g?c:a);while((g=(g+t+4)%4)!==
m)}else P.point(u[0],u[1])}function n(p,e){p>=d&&(r>=p&&e>=a&&c>=e)&&t.point(p,e)}function D(p,e){p=Math.max(-tb,Math.min(tb,p));e=Math.max(-tb,Math.min(tb,e));var u=p>=d&&r>=p&&e>=a&&c>=e;if(C&&z.push([p,e]),Z)B=p,A=e,G=u,Z=!1,u&&(t.lineStart(),t.point(p,e));else if(u&&sa)t.point(p,e);else{var f=[Q,M],U=[p,e],g=U[0]-f[0],P=U[1]-f[1],l=[0,1];(Math.abs(g)<N&&Math.abs(P)<N?d<=f[0]&&f[0]<=r&&a<=f[1]&&f[1]<=c:ub(d-f[0],g,l)&&(ub(f[0]-r,-g,l)&&ub(a-f[1],P,l)&&ub(f[1]-c,-P,l))&&(1>l[1]&&(U[0]=f[0]+l[1]*
g,U[1]=f[1]+l[1]*P),0<l[0]&&(f[0]+=l[0]*g,f[1]+=l[0]*P),!0))?(sa||(t.lineStart(),t.point(f[0],f[1])),t.point(U[0],U[1]),u||t.lineEnd()):(t.lineStart(),t.point(p,e))}Q=p;M=e;sa=u}var q,C,z,B,A,G,Q,M,sa,Z,ba=t,v=Ed(),y={point:n,lineStart:function(){y.point=D;C&&C.push(z=[]);Z=!0;sa=!1;Q=M=0/0},lineEnd:function(){q&&(D(B,A),G&&sa&&v.rejoin(),q.push(v.buffer()));y.point=n;sa&&t.lineEnd()},polygonStart:function(){t=v;q=[];C=[]},polygonEnd:function(){t=ba;(q=m.merge(q)).length?(t.polygonStart(),Ad(q,e,
P,l,t),t.polygonEnd()):g([d,a])&&(t.polygonStart(),t.lineStart(),l(null,null,1,t),t.lineEnd(),t.polygonEnd());q=C=z=null}};return y}}function ub(d,a,r){if(Math.abs(a)<N)return 0>=d;d/=a;if(0<a){if(d>r[1])return!1;d>r[0]&&(r[0]=d)}else{if(d<r[0])return!1;d<r[1]&&(r[1]=d)}return!0}function Fd(d,a){function r(r,c){return r=d(r,c),a(r[0],r[1])}return d.invert&&a.invert&&(r.invert=function(r,c){return r=a.invert(r,c),r&&d.invert(r[0],r[1])}),r}function Gd(d){function a(s){function c(a,r){a=d(a,r);s.point(a[0],
a[1])}function e(){m=0/0;A.point=J;s.lineStart()}function J(a,c){var e=pb([a,c]),t=d(a,c);r(m,n,l,q,z,B,m=t[0],n=t[1],l=a,q=e[0],z=e[1],B=e[2],p,s);s.point(m,n)}function f(){A.point=c;s.lineEnd()}function g(){var d,a,c,U,F,ba;e();A.point=function(s,r){J(d=s,r);a=m;c=n;U=q;F=z;ba=B;A.point=J};A.lineEnd=function(){r(m,n,l,q,z,B,a,c,d,U,F,ba,p,s);A.lineEnd=f;f()}}var l,m,n,q,z,B,A={point:c,lineStart:e,lineEnd:f,polygonStart:function(){s.polygonStart();A.lineStart=g},polygonEnd:function(){s.polygonEnd();
A.lineStart=e}};return A}function r(a,s,p,e,f,g,l,m,n,q,z,B,A,G){var Q=l-a,M=m-s,sa=Q*Q+M*M;if(sa>4*c&&A--){var Z=e+q,ba=f+z,v=g+B,y=Math.sqrt(Z*Z+ba*ba+v*v),x=Math.asin(v/=y),E=Math.abs(Math.abs(v)-1)<N?(p+n)/2:Math.atan2(ba,Z),H=d(E,x),x=H[0],H=H[1],L=x-a,R=H-s,O=M*L-Q*R;(O*O/sa>c||0.3<Math.abs((Q*L+M*R)/sa-0.5))&&(r(a,s,p,e,f,g,x,H,E,Z/=y,ba/=y,v,A,G),G.point(x,H),r(x,H,E,Z,ba,v,l,m,n,q,z,B,A,G))}}var c=0.5,p=16;return a.precision=function(d){return arguments.length?(p=0<(c=d*d)&&16,a):Math.sqrt(c)},
a}function Da(d){return mc(function(){return d})()}function mc(d){function a(d){return d=f(d[0]*L,d[1]*L),[d[0]*n+t,g-d[1]*n]}function r(d){return d=f.invert((d[0]-t)/n,(g-d[1])/n),d&&[d[0]*Y,d[1]*Y]}function c(){f=Fd(e=nc(z,B,A),p);var d=p(I,C);return t=q-d[0]*n,g=D+d[1]*n,a}var p,e,f,t,g,l=Gd(function(d,a){return d=p(d,a),[d[0]*n+t,g-d[1]*n]}),n=150,q=480,D=250,I=0,C=0,z=0,B=0,A=0,G=Hd,Q=ma,M=null,v=null;return a.stream=function(d){return Gf(e,G(l(Q(d))))},a.clipAngle=function(d){return arguments.length?
(G=null==d?(M=d,Hd):Cf((M=+d)*L),a):M},a.clipExtent=function(d){return arguments.length?(v=d,Q=null==d?ma:Df(d[0][0],d[0][1],d[1][0],d[1][1]),a):v},a.scale=function(d){return arguments.length?(n=+d,c()):n},a.translate=function(d){return arguments.length?(q=+d[0],D=+d[1],c()):[q,D]},a.center=function(d){return arguments.length?(I=d[0]%360*L,C=d[1]%360*L,c()):[I*Y,C*Y]},a.rotate=function(d){return arguments.length?(z=d[0]%360*L,B=d[1]%360*L,A=2<d.length?d[2]%360*L:0,c()):[z*Y,B*Y,A*Y]},m.rebind(a,l,
"precision"),function(){return p=d.apply(this,arguments),a.invert=p.invert&&r,c()}}function Gf(d,a){return{point:function(r,c){c=d(r*L,c*L);r=c[0];a.point(r>E?r-2*E:-E>r?r+2*E:r,c[1])},sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function Ya(d,a){return[d,a]}function nc(d,a,r){return d?a||r?Fd(Id(d),Jd(a,r)):Id(d):a||r?Jd(a,r):Ya}function Kd(d){return function(a,r){return a+=
d,[a>E?a-2*E:-E>a?a+2*E:a,r]}}function Id(d){var a=Kd(d);return a.invert=Kd(-d),a}function Jd(d,a){function r(d,a){var s=Math.cos(a),r=Math.cos(d)*s,s=Math.sin(d)*s,g=Math.sin(a),l=g*c+r*p;return[Math.atan2(s*e-l*f,r*c-g*p),Math.asin(Math.max(-1,Math.min(1,l*e+s*f)))]}var c=Math.cos(d),p=Math.sin(d),e=Math.cos(a),f=Math.sin(a);return r.invert=function(d,a){var s=Math.cos(a),r=Math.cos(d)*s,s=Math.sin(d)*s,g=Math.sin(a),l=g*e-s*f;return[Math.atan2(s*e+g*f,r*c+l*p),Math.asin(Math.max(-1,Math.min(1,
l*c-r*p)))]},r}function lc(d,a){var r=Math.cos(d),c=Math.sin(d);return function(p,e,f,t){null!=p?(p=Ld(r,p),e=Ld(r,e),(0<f?e>p:p>e)&&(p+=2*f*E)):(p=d+2*f*E,e=d);for(var g,l=f*a;0<f?p>e:e>p;p-=l)t.point((g=kc([r,-c*Math.cos(p),-c*Math.sin(p)]))[0],g[1])}}function Ld(d,a){var r=pb(a);r[0]-=d;var c=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);r[0]/=c;r[1]/=c;r[2]/=c;c=Math.acos(Math.max(-1,Math.min(1,-r[1])));return((0>-r[2]?-c:c)+2*Math.PI-N)%(2*Math.PI)}function Md(d,a,r){var c=m.range(d,a-N,r).concat(a);
return function(d){return c.map(function(a){return[d,a]})}}function Nd(d,a,r){var c=m.range(d,a-N,r).concat(a);return function(d){return c.map(function(a){return[a,d]})}}function oc(d){return d.source}function pc(d){return d.target}function Hf(d,a,r,c){var p=Math.cos(a),e=Math.sin(a),f=Math.cos(c),t=Math.sin(c),g=p*Math.cos(d),l=p*Math.sin(d),m=f*Math.cos(r),n=f*Math.sin(r),q=2*Math.asin(Math.sqrt(ld(c-a)+p*f*ld(r-d))),I=1/Math.sin(q);r=q?function(d){var a=Math.sin(d*=q)*I,s=Math.sin(q-d)*I;d=s*g+
a*m;var r=s*l+a*n,a=s*e+a*t;return[Math.atan2(r,d)*Y,Math.atan2(a,Math.sqrt(d*d+r*r))*Y]}:function(){return[d*Y,a*Y]};return r.distance=q,r}function qc(d){var a=0,r=E/3,c=mc(d);d=c(a,r);return d.parallels=function(d){return arguments.length?c(a=d[0]*E/180,r=d[1]*E/180):[180*(a/E),180*(r/E)]},d}function Od(d,a){function r(d,a){var s=Math.sqrt(e-2*p*Math.sin(a))/p;return[s*Math.sin(d*=p),f-s*Math.cos(d)]}var c=Math.sin(d),p=(c+Math.sin(a))/2,e=1+c*(2*p-c),f=Math.sqrt(e)/p;return r.invert=function(d,
a){var s=f-a;return[Math.atan2(d,s)/p,Math.asin((e-(d*d+s*s)*p*p)/(2*p))]},r}function rc(d,a){var r=d(a[0]),c=d([0.5*(a[0][0]+a[1][0]),a[0][1]]),p=d([a[1][0],a[0][1]]),e=d(a[1]),f=(c[1]-r[1])/(c[0]-r[0]),t=(p[1]-c[1])/(p[0]-c[0]),g=0.5*(f*t*(r[1]-p[1])+t*(r[0]+c[0])-f*(c[0]+p[0]))/(t-f),l=(0.5*(r[0]+c[0])-g)/f+0.5*(r[1]+c[1]),c=e[0]-g,e=e[1]-l,p=r[0]-g,r=r[1]-l,m=c*c+e*e,n=p*p+r*r,q=Math.atan2(e,c),I=Math.atan2(r,p);return function(a){var s=a[0]-g,r=a[1]-l,c=s*s+r*r,s=Math.atan2(r,s);return c>m&&
n>c&&s>q&&I>s?d.invert(a):void 0}}function If(){function d(d,a){vb+=p*d-c*a;c=d;p=a}var a,r,c,p;Ea.point=function(e,f){Ea.point=d;a=c=e;r=p=f};Ea.lineEnd=function(){d(a,r)}}function Jf(){function d(d,a){f.push("M",d,",",a,e)}function a(d,s){f.push("M",d,",",s);t.point=r}function r(d,a){f.push("L",d,",",a)}function c(){t.point=d}function p(){f.push("Z")}var e=Pd(4.5),f=[],t={point:d,lineStart:function(){t.point=a},lineEnd:c,polygonStart:function(){t.lineEnd=p},polygonEnd:function(){t.lineEnd=c;t.point=
d},pointRadius:function(d){return e=Pd(d),t},result:function(){if(f.length){var d=f.join("");return f=[],d}}};return t}function sc(d,a){ga||(ca+=d,da+=a,++aa)}function Qd(){function d(d,c){var e=d-a,f=c-r,e=Math.sqrt(e*e+f*f);ca+=e*(a+d)/2;da+=e*(r+c)/2;aa+=e;a=d;r=c}var a,r;if(1!==ga){if(!(1>ga))return;ga=1;ca=da=aa=0}ra.point=function(c,e){ra.point=d;a=c;r=e}}function Rd(){ra.point=sc}function Kf(){function d(d,a){var s=e*d-c*a;ca+=s*(c+d);da+=s*(e+a);aa+=3*s;c=d;e=a}var a,r,c,e;2>ga&&(ga=2,ca=
da=aa=0);ra.point=function(u,f){ra.point=d;a=c=u;r=e=f};ra.lineEnd=function(){d(a,r)}}function Lf(d){function a(s,r){d.moveTo(s,r);d.arc(s,r,f,0,2*E)}function r(a,s){d.moveTo(a,s);t.point=c}function c(a,s){d.lineTo(a,s)}function e(){t.point=a}function u(){d.closePath()}var f=4.5,t={point:a,lineStart:function(){t.point=r},lineEnd:e,polygonStart:function(){t.lineEnd=u},polygonEnd:function(){t.lineEnd=e;t.point=a},pointRadius:function(d){return f=d,t},result:ea};return t}function Pd(d){return"m0,"+d+
"a"+d+","+d+" 0 1,1 0,"+-2*d+"a"+d+","+d+" 0 1,1 0,"+2*d+"z"}function Mf(d){var a=Gd(function(a,s){return d([a*Y,s*Y])});return function(d){return d=a(d),{point:function(a,s){d.point(a*L,s*L)},sphere:function(){d.sphere()},lineStart:function(){d.lineStart()},lineEnd:function(){d.lineEnd()},polygonStart:function(){d.polygonStart()},polygonEnd:function(){d.polygonEnd()}}}}function Za(d,a){function r(a,s){var r=Math.cos(a),c=Math.cos(s),r=d(r*c);return[r*c*Math.sin(a),r*Math.sin(s)]}return r.invert=
function(d,r){var c=Math.sqrt(d*d+r*r),e=a(c),f=Math.sin(e),e=Math.cos(e);return[Math.atan2(d*f,c*e),Math.asin(c&&r*f/c)]},r}function Sd(d,a){function r(d,a){var s=Math.abs(Math.abs(a)-E/2)<N?0:u/Math.pow(Math.tan(E/4+a/2),e);return[s*Math.sin(e*d),u-s*Math.cos(e*d)]}var c=Math.cos(d),e=d===a?Math.sin(d):Math.log(c/Math.cos(a))/Math.log(Math.tan(E/4+a/2)/Math.tan(E/4+d/2)),u=c*Math.pow(Math.tan(E/4+d/2),e)/e;return e?(r.invert=function(d,a){var s=u-a,r=(0<e?1:0>e?-1:0)*Math.sqrt(d*d+s*s);return[Math.atan2(d,
s)/e,2*Math.atan(Math.pow(u/r,1/e))-E/2]},r):wb}function Td(d,a){function r(d,a){var s=u-a;return[s*Math.sin(e*d),u-s*Math.cos(e*d)]}var c=Math.cos(d),e=d===a?Math.sin(d):(c-Math.cos(a))/(a-d),u=c/e+d;return Math.abs(e)<N?Ya:(r.invert=function(d,a){var s=u-a;return[Math.atan2(d,s)/e,u-(0<e?1:0>e?-1:0)*Math.sqrt(d*d+s*s)]},r)}function wb(d,a){return[d,Math.log(Math.tan(E/4+a/2))]}function Ud(d){var a,r=Da(d),c=r.scale,e=r.translate,u=r.clipExtent;return r.scale=function(){var d=c.apply(r,arguments);
return d===r?a?r.clipExtent(null):r:d},r.translate=function(){var d=e.apply(r,arguments);return d===r?a?r.clipExtent(null):r:d},r.clipExtent=function(d){var f=u.apply(r,arguments);if(f===r){if(a=null==d){var g=E*c(),l=e();u([[l[0]-g,l[1]-g],[l[0]+g,l[1]+g]])}}else a&&(f=null);return f},r.clipExtent(null)}function tc(d,a){var r=Math.cos(a)*Math.sin(d);return[Math.log((1+r)/(1-r))/2,Math.atan2(Math.tan(a),Math.cos(d))]}function Vd(d){function a(s){function f(){l.push("M",u(d(U),t))}for(var g,l=[],U=
[],m=-1,n=s.length,q=T(r),B=T(c);++m<n;)e.call(this,g=s[m],m)?U.push([+q.call(this,g,m),+B.call(this,g,m)]):U.length&&(f(),U=[]);return U.length&&f(),l.length?l.join(""):null}var r=ta,c=wa,e=Xa,u=na,f=u.key,t=0.7;return a.x=function(d){return arguments.length?(r=d,a):r},a.y=function(d){return arguments.length?(c=d,a):c},a.defined=function(d){return arguments.length?(e=d,a):e},a.interpolate=function(d){return arguments.length?(f="function"==typeof d?u=d:(u=uc.get(d)||na).key,a):f},a.tension=function(d){return arguments.length?
(t=d,a):t},a}function ta(d){return d[0]}function wa(d){return d[1]}function na(d){return d.join("L")}function vc(d){for(var a=0,r=d.length,c=d[0],e=[c[0],",",c[1]];++a<r;)e.push("V",(c=d[a])[1],"H",c[0]);return e.join("")}function wc(d){for(var a=0,r=d.length,c=d[0],e=[c[0],",",c[1]];++a<r;)e.push("H",(c=d[a])[0],"V",c[1]);return e.join("")}function xb(d,a){if(1>a.length||d.length!=a.length&&d.length!=a.length+2)return na(d);var c=d.length!=a.length,e="",p=d[0],u=d[1],f=a[0],t=f,g=1;if(c&&(e+="Q"+
(u[0]-2*f[0]/3)+","+(u[1]-2*f[1]/3)+","+u[0]+","+u[1],p=d[1],g=2),1<a.length){t=a[1];u=d[g];g++;e+="C"+(p[0]+f[0])+","+(p[1]+f[1])+","+(u[0]-t[0])+","+(u[1]-t[1])+","+u[0]+","+u[1];for(p=2;p<a.length;p++,g++)u=d[g],t=a[p],e+="S"+(u[0]-t[0])+","+(u[1]-t[1])+","+u[0]+","+u[1]}c&&(c=d[g],e+="Q"+(u[0]+2*t[0]/3)+","+(u[1]+2*t[1]/3)+","+c[0]+","+c[1]);return e}function xc(d,a){for(var c,e=[],p=(1-a)/2,u=d[0],f=d[1],t=1,g=d.length;++t<g;)c=u,u=f,f=d[t],e.push([p*(f[0]-c[0]),p*(f[1]-c[1])]);return e}function Wd(d){if(3>
d.length)return na(d);var a=1,c=d.length,e=d[0],p=e[0],u=e[1],f=[p,p,p,(e=d[1])[0]],t=[u,u,u,e[1]],p=[p,",",u];for($a(p,f,t);++a<c;)e=d[a],f.shift(),f.push(e[0]),t.shift(),t.push(e[1]),$a(p,f,t);for(a=-1;2>++a;)f.shift(),f.push(e[0]),t.shift(),t.push(e[1]),$a(p,f,t);return p.join("")}function ua(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]+d[3]*a[3]}function $a(d,a,c){d.push("C",ua(Xd,a),",",ua(Xd,c),",",ua(Yd,a),",",ua(Yd,c),",",ua(Sa,a),",",ua(Sa,c))}function yc(d,a){return(a[1]-d[1])/(a[0]-d[0])}
function Nf(d,a,c,e){var p,u,f,t,g,l,m;return p=e[d],u=p[0],f=p[1],p=e[a],t=p[0],g=p[1],p=e[c],l=p[0],m=p[1],0<(m-f)*(t-u)-(g-f)*(l-u)}function zc(d,a,c){return(c[0]-a[0])*(d[1]-a[1])<(c[1]-a[1])*(d[0]-a[0])}function Zd(d,a,c,e){var p=d[0],u=c[0],f=a[0]-p,t=e[0]-u;d=d[1];c=c[1];a=a[1]-d;e=e[1]-c;u=(t*(d-c)-e*(p-u))/(e*f-t*a);return[p+u*f,d+u*a]}function Ac(d,a){var c=d.map(function(d,a){return{index:a,x:d[0],y:d[1]}}).sort(function(d,a){return d.y<a.y?-1:d.y>a.y?1:d.x<a.x?-1:d.x>a.x?1:0}),e=null,
p={list:[],leftEnd:null,rightEnd:null,init:function(){p.leftEnd=p.createHalfEdge(null,"l");p.rightEnd=p.createHalfEdge(null,"l");p.leftEnd.r=p.rightEnd;p.rightEnd.l=p.leftEnd;p.list.unshift(p.leftEnd,p.rightEnd)},createHalfEdge:function(d,a){return{edge:d,side:a,vertex:null,l:null,r:null}},insert:function(d,a){a.l=d;a.r=d.r;d.r.l=a;d.r=a},leftBound:function(d){var a=p.leftEnd;do a=a.r;while(a!=p.rightEnd&&u.rightOf(a,d));return a.l},del:function(d){d.l.r=d.r;d.r.l=d.l;d.edge=null},right:function(d){return d.r},
left:function(d){return d.l},leftRegion:function(d){return null==d.edge?e:d.edge.region[d.side]},rightRegion:function(d){return null==d.edge?e:d.edge.region[Bc[d.side]]}},u={bisect:function(d,a){var c={region:{l:d,r:a},ep:{l:null,r:null}},s=a.x-d.x,r=a.y-d.y;return c.c=d.x*s+d.y*r+0.5*(s*s+r*r),(0<s?s:-s)>(0<r?r:-r)?(c.a=1,c.b=r/s,c.c/=s):(c.b=1,c.a=s/r,c.c/=r),c},intersect:function(d,a){var c=d.edge,s=a.edge;if(!c||!s||c.region.r==s.region.r)return null;var r=c.a*s.b-c.b*s.a;if(1E-10>Math.abs(r))return null;
var e,p,u=(c.c*s.b-s.c*c.b)/r,r=(s.c*c.a-c.c*s.a)/r,f=c.region.r,J=s.region.r;f.y<J.y||f.y==J.y&&f.x<J.x?(e=d,p=c):(e=a,p=s);return(c=u>=p.region.r.x)&&"l"===e.side||!c&&"r"===e.side?null:{x:u,y:r}},rightOf:function(d,a){var c=d.edge,s=c.region.r,r=a.x>s.x;if(r&&"l"===d.side)return 1;if(!r&&"r"===d.side)return 0;if(1===c.a){var e=a.y-s.y,p=a.x-s.x,u=0;!r&&0>c.b||r&&0<=c.b?u=e>=c.b*p:(u=a.x+a.y*c.b>c.c,0>c.b&&(u=!u));s=s.x-c.region.l.x;u=c.b*(p*p-e*e)<s*e*(1+2*p/s+c.b*c.b);0>c.b&&(u=!u)}else p=c.c-
c.a*a.x,c=a.y-p,e=a.x-s.x,s=p-s.y,u=c*c>e*e+s*s;return"l"===d.side?u:!u},endPoint:function(d,c,r){d.ep[c]=r;d.ep[Bc[c]]&&a(d)},distance:function(d,a){var c=d.x-a.x,s=d.y-a.y;return Math.sqrt(c*c+s*s)}},f={list:[],insert:function(d,a,c){d.vertex=a;d.ystar=a.y+c;c=0;for(var s=f.list,r=s.length;r>c;c++){var e=s[c];if(!(d.ystar>e.ystar||d.ystar==e.ystar&&a.x>e.vertex.x))break}s.splice(c,0,d)},del:function(d){for(var a=0,c=f.list,s=c.length;s>a&&c[a]!=d;++a);c.splice(a,1)},empty:function(){return 0===
f.list.length},nextEvent:function(d){for(var a=0,c=f.list,s=c.length;s>a;++a)if(c[a]==d)return c[a+1];return null},min:function(){var d=f.list[0];return{x:d.vertex.x,y:d.ystar}},extractMin:function(){return f.list.shift()}};p.init();for(var e=c.shift(),t,g,l,m,n,q,I,C,z,B,A=c.shift();;)if(f.empty()||(t=f.min()),A&&(f.empty()||A.y<t.y||A.y==t.y&&A.x<t.x))g=p.leftBound(A),l=p.right(g),I=p.rightRegion(g),B=u.bisect(I,A),q=p.createHalfEdge(B,"l"),p.insert(g,q),(z=u.intersect(g,q))&&(f.del(g),f.insert(g,
z,u.distance(z,A))),g=q,q=p.createHalfEdge(B,"r"),p.insert(g,q),(z=u.intersect(q,l))&&f.insert(q,z,u.distance(z,A)),A=c.shift();else{if(f.empty())break;g=f.extractMin();m=p.left(g);l=p.right(g);n=p.right(l);I=p.leftRegion(g);q=p.rightRegion(l);z=g.vertex;u.endPoint(g.edge,g.side,z);u.endPoint(l.edge,l.side,z);p.del(g);f.del(l);p.del(l);g="l";I.y>q.y&&(C=I,I=q,q=C,g="r");B=u.bisect(I,q);q=p.createHalfEdge(B,g);p.insert(m,q);u.endPoint(B,Bc[g],z);(z=u.intersect(m,q))&&(f.del(m),f.insert(m,z,u.distance(z,
I)));(z=u.intersect(q,n))&&f.insert(q,z,u.distance(z,I))}for(g=p.right(p.leftEnd);g!=p.rightEnd;g=p.right(g))a(g.edge)}function Of(d){return d.x}function Pf(d){return d.y}function $d(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ab(d,a,c,e,p,u){if(!d(a,c,e,p,u)){var f=0.5*(c+p),t=0.5*(e+u);a=a.nodes;a[0]&&ab(d,a[0],c,e,f,t);a[1]&&ab(d,a[1],f,e,p,t);a[2]&&ab(d,a[2],c,t,f,u);a[3]&&ab(d,a[3],f,t,p,u)}}function Cc(d,a){d=m.rgb(d);a=m.rgb(a);var c=d.r,e=d.g,p=d.b,u=a.r-c,f=a.g-e,t=a.b-p;
return function(d){return"#"+Qa(Math.round(c+u*d))+Qa(Math.round(e+f*d))+Qa(Math.round(p+t*d))}}function ae(d){var a=[d.a,d.b],c=[d.c,d.d],e=be(a),p=a[0]*c[0]+a[1]*c[1],u=be((c[0]+=-p*a[0],c[1]+=-p*a[1],c))||0;a[0]*c[1]<c[0]*a[1]&&(a[0]*=-1,a[1]*=-1,e*=-1,p*=-1);this.rotate=(e?Math.atan2(a[1],a[0]):Math.atan2(-c[0],c[1]))*Y;this.translate=[d.e,d.f];this.scale=[e,u];this.skew=u?Math.atan2(p,u)*Y:0}function be(d){var a=Math.sqrt(d[0]*d[0]+d[1]*d[1]);return a&&(d[0]/=a,d[1]/=a),a}function xa(d,a){return a-=
d=+d,function(c){return d+a*c}}function yb(d,a){var c,e=[],p=[],u=m.transform(d),f=m.transform(a),t=u.translate,g=f.translate,l=u.rotate,n=f.rotate,q=u.skew,D=f.skew,u=u.scale,f=f.scale;return t[0]!=g[0]||t[1]!=g[1]?(e.push("translate(",null,",",null,")"),p.push({i:1,x:xa(t[0],g[0])},{i:3,x:xa(t[1],g[1])})):g[0]||g[1]?e.push("translate("+g+")"):e.push(""),l!=n?(180<l-n?n+=360:180<n-l&&(l+=360),p.push({i:e.push(e.pop()+"rotate(",null,")")-2,x:xa(l,n)})):n&&e.push(e.pop()+"rotate("+n+")"),q!=D?p.push({i:e.push(e.pop()+
"skewX(",null,")")-2,x:xa(q,D)}):D&&e.push(e.pop()+"skewX("+D+")"),u[0]!=f[0]||u[1]!=f[1]?(c=e.push(e.pop()+"scale(",null,",",null,")"),p.push({i:c-4,x:xa(u[0],f[0])},{i:c-2,x:xa(u[1],f[1])})):(1!=f[0]||1!=f[1])&&e.push(e.pop()+"scale("+f+")"),c=p.length,function(d){for(var a,s=-1;++s<c;)e[(a=p[s]).i]=a.x(d);return e.join("")}}function ce(d,a){var c,e={},p={};for(c in d)c in a?e[c]=("transform"==c?yb:Ha)(d[c],a[c]):p[c]=d[c];for(c in a)c in d||(p[c]=a[c]);return function(d){for(c in e)p[c]=e[c](d);
return p}}function de(d,a){var c,e,p,u,f=0,t=[],g=[];d+="";a+="";for(e=zb.lastIndex=0;c=zb.exec(a);++e)c.index&&t.push(a.substring(f,c.index)),g.push({i:t.length,x:c[0]}),t.push(null),f=zb.lastIndex;f<a.length&&t.push(a.substring(f));e=0;for(p=g.length;(c=zb.exec(d))&&p>e;++e)if(u=g[e],u.x==c[0]){if(u.i)if(null==t[u.i+1]){t[u.i-1]+=u.x;t.splice(u.i,1);for(c=e+1;p>c;++c)g[c].i--}else{t[u.i-1]+=u.x+t[u.i+1];t.splice(u.i,2);for(c=e+1;p>c;++c)g[c].i-=2}else if(null==t[u.i+1])t[u.i]=u.x;else{t[u.i]=u.x+
t[u.i+1];t.splice(u.i+1,1);for(c=e+1;p>c;++c)g[c].i--}g.splice(e,1);p--;e--}else u.x=xa(parseFloat(c[0]),parseFloat(u.x));for(;p>e;)u=g.pop(),null==t[u.i+1]?t[u.i]=u.x:(t[u.i]=u.x+t[u.i+1],t.splice(u.i+1,1)),p--;return 1===t.length?null==t[0]?g[0].x:function(){return a}:function(d){for(e=0;p>e;++e)t[(u=g[e]).i]=u.x(d);return t.join("")}}function Ha(d,a){for(var c,e=m.interpolators.length;0<=--e&&!(c=m.interpolators[e](d,a)););return c}function ee(d,a){var c,e=[],p=[],u=d.length,f=a.length,t=Math.min(d.length,
a.length);for(c=0;t>c;++c)e.push(Ha(d[c],a[c]));for(;u>c;++c)p[c]=d[c];for(;f>c;++c)p[c]=a[c];return function(d){for(c=0;t>c;++c)p[c]=e[c](d);return p}}function Qf(d){return function(a){return 0>=a?0:1<=a?1:d(a)}}function fe(d){return function(a){return 1-d(1-a)}}function ge(d){return function(a){return 0.5*(0.5>a?d(2*a):2-d(2-2*a))}}function Rf(d){return d*d}function Sf(d){return d*d*d}function Tf(d){return 1-Math.cos(d*E/2)}function Uf(d){return Math.pow(2,10*(d-1))}function Vf(d){return 1-Math.sqrt(1-
d*d)}function Wf(d){return 1/2.75>d?7.5625*d*d:2/2.75>d?7.5625*(d-=1.5/2.75)*d+0.75:2.5/2.75>d?7.5625*(d-=2.25/2.75)*d+0.9375:7.5625*(d-=2.625/2.75)*d+0.984375}function he(d,a){return a-=d,function(c){return Math.round(d+a*c)}}function Xf(d,a){return a=a-(d=+d)?1/(a-d):0,function(c){return(c-d)*a}}function Yf(d,a){return a=a-(d=+d)?1/(a-d):0,function(c){return Math.max(0,Math.min(1,(c-d)*a))}}function Zf(d){var a=d.source;d=d.target;var c;var e=d;if(a===e)c=a;else{c=ie(a);for(var e=ie(e),p=c.pop(),
u=e.pop(),f=null;p===u;)f=p,p=c.pop(),u=e.pop();c=f}for(e=[a];a!==c;)a=a.parent,e.push(a);for(a=e.length;d!==c;)e.splice(a,0,d),d=d.parent;return e}function ie(d){for(var a=[],c=d.parent;null!=c;)a.push(d),d=c,c=c.parent;return a.push(d),a}function $f(d){d.fixed|=2}function ag(d){d.fixed&=-7}function bg(d){d.fixed|=4;d.px=d.x;d.py=d.y}function cg(d){d.fixed&=-5}function je(d,a,c){var e=0,p=0;if(d.charge=0,!d.leaf)for(var u,f=d.nodes,t=f.length,g=-1;++g<t;)u=f[g],null!=u&&(je(u,a,c),d.charge+=u.charge,
e+=u.charge*u.cx,p+=u.charge*u.cy);d.point&&(d.leaf||(d.point.x+=Math.random()-0.5,d.point.y+=Math.random()-0.5),a*=c[d.point.index],d.charge+=d.pointCharge=a,e+=a*d.point.x,p+=a*d.point.y);d.cx=e/d.charge;d.cy=p/d.charge}function bb(d,a){return m.rebind(d,a,"sort","children","value"),d.nodes=d,d.links=dg,d}function eg(d){return d.children}function fg(d){return d.value}function gg(d,a){return a.value-d.value}function dg(d){return m.merge(d.map(function(d){return(d.children||[]).map(function(a){return{source:d,
target:a}})}))}function hg(d){return d.x}function ig(d){return d.y}function jg(d,a,c){d.y0=a;d.y=c}function Dc(d){return m.range(d.length)}function Ec(d){var a=-1;d=d[0].length;for(var c=[];++a<d;)c[a]=0;return c}function kg(d){for(var a,c=1,e=0,p=d[0][1],u=d.length;u>c;++c)(a=d[c][1])>p&&(e=c,p=a);return e}function lg(d){return d.reduce(mg,0)}function mg(d,a){return d+a[1]}function ng(d,a){return ke(d,Math.ceil(Math.log(a.length)/Math.LN2+1))}function ke(d,a){for(var c=-1,e=+d[0],p=(d[1]-e)/a,u=
[];++c<=a;)u[c]=p*c+e;return u}function og(d){return[m.min(d),m.max(d)]}function le(d,a){return d.parent==a.parent?1:2}function Fc(d){var a=d.children;return a&&a.length?a[0]:d._tree.thread}function Gc(d){var a,c=d.children;return c&&(a=c.length)?c[a-1]:d._tree.thread}function Ab(d,a){var c=d.children;if(c&&(p=c.length))for(var e,p,u=-1;++u<p;)0<a(e=Ab(c[u],a),d)&&(d=e);return d}function pg(d,a){return d.x-a.x}function qg(d,a){return a.x-d.x}function rg(d,a){return d.depth-a.depth}function ya(d,a){function c(d,
e){var u=d.children;if(u&&(t=u.length))for(var f,t,g=null,l=-1;++l<t;)f=u[l],c(f,g),g=f;a(d,e)}c(d,null)}function sg(d,a){return d.value-a.value}function Hc(d,a){var c=d._pack_next;d._pack_next=a;a._pack_prev=d;a._pack_next=c;c._pack_prev=a}function me(d,a){d._pack_next=a;a._pack_prev=d}function ne(d,a){var c=a.x-d.x,e=a.y-d.y,p=d.r+a.r;return 0.001<p*p-c*c-e*e}function oe(d){function a(d){m=Math.min(d.x-d.r,m);n=Math.max(d.x+d.r,n);q=Math.min(d.y-d.r,q);I=Math.max(d.y+d.r,I)}if((c=d.children)&&(l=
c.length)){var c,e,p,u,f,t,g,l,m=1/0,n=-1/0,q=1/0,I=-1/0;if(c.forEach(tg),e=c[0],e.x=-e.r,e.y=0,a(e),1<l&&(p=c[1],p.x=p.r,p.y=0,a(p),2<l)){u=c[2];pe(e,p,u);a(u);Hc(e,u);e._pack_prev=u;Hc(u,p);p=e._pack_next;for(f=3;l>f;f++){pe(e,p,u=c[f]);var C=0,z=1,B=1;for(t=p._pack_next;t!==p;t=t._pack_next,z++)if(ne(t,u)){C=1;break}if(1==C)for(g=e._pack_prev;g!==t._pack_prev&&!ne(g,u);g=g._pack_prev,B++);C?(B>z||z==B&&p.r<e.r?me(e,p=t):me(e=g,p),f--):(Hc(e,u),p=u,a(u))}}e=(m+n)/2;p=(q+I)/2;for(f=t=0;l>f;f++)u=
c[f],u.x-=e,u.y-=p,t=Math.max(t,u.r+Math.sqrt(u.x*u.x+u.y*u.y));d.r=t;c.forEach(ug)}}function tg(d){d._pack_next=d._pack_prev=d}function ug(d){delete d._pack_next;delete d._pack_prev}function qe(d,a,c,e){var p=d.children;if(d.x=a+=e*d.x,d.y=c+=e*d.y,d.r*=e,p){d=-1;for(var u=p.length;++d<u;)qe(p[d],a,c,e)}}function pe(d,a,c){var e=d.r+c.r,p=a.x-d.x,u=a.y-d.y;if(e&&(p||u)){var f=a.r+c.r,t=p*p+u*u,f=f*f,e=e*e;a=0.5+(e-f)/(2*t);f=Math.sqrt(Math.max(0,2*f*(e+t)-(e-=t)*e-f*f))/(2*t);c.x=d.x+a*p+f*u;c.y=
d.y+a*u-f*p}else c.x=d.x+e,c.y=d.y}function vg(d){return 1+m.max(d,function(d){return d.y})}function wg(d){return d.reduce(function(d,a){return d+a.x},0)/d.length}function re(d){var a=d.children;return a&&a.length?re(a[0]):d}function se(d){var a,c=d.children;return c&&(a=c.length)?se(c[a-1]):d}function Ic(d){return{x:d.x,y:d.y,dx:d.dx,dy:d.dy}}function te(d,a){var c=d.x+a[3],e=d.y+a[0],p=d.dx-a[1]-a[3],f=d.dy-a[0]-a[2];return 0>p&&(c+=p/2,p=0),0>f&&(e+=f/2,f=0),{x:c,y:e,dx:p,dy:f}}function cb(d){var a=
d[0];d=d[d.length-1];return d>a?[a,d]:[d,a]}function Bb(d){return d.rangeExtent?d.rangeExtent():cb(d.range())}function xg(d,a,c,e){var p=c(d[0],d[1]),f=e(a[0],a[1]);return function(d){return f(p(d))}}function Cb(d,a){var c,e=0,p=d.length-1,f=d[e],g=d[p];return f>g&&(c=e,e=p,p=c,c=f,f=g,g=c),(a=a(g-f))&&(d[e]=a.floor(f),d[p]=a.ceil(g)),d}function yg(d,a,c,e){var p=[],f=[],g=0,t=Math.min(d.length,a.length)-1;for(d[t]<d[0]&&(d=d.slice().reverse(),a=a.slice().reverse());++g<=t;)p.push(c(d[g-1],d[g])),
f.push(e(a[g-1],a[g]));return function(a){var c=m.bisect(d,a,1,t)-1;return f[c](p[c](a))}}function ue(d,a,c,e){function p(){var p=2<Math.min(d.length,a.length)?yg:xg,l=e?Yf:Xf;return g=p(d,a,l,c),t=p(a,d,l,Ha),f}function f(d){return g(d)}var g,t;return f.invert=function(d){return t(d)},f.domain=function(a){return arguments.length?(d=a.map(Number),p()):d},f.range=function(d){return arguments.length?(a=d,p()):a},f.rangeRound=function(d){return f.range(d).interpolate(he)},f.clamp=function(d){return arguments.length?
(e=d,p()):e},f.interpolate=function(d){return arguments.length?(c=d,p()):c},f.ticks=function(a){return Jc(d,a)},f.tickFormat=function(a,c){return Kc(d,a,c)},f.nice=function(){return Cb(d,ve),p()},f.copy=function(){return ue(d,a,c,e)},p()}function we(d,a){return m.rebind(d,a,"range","rangeRound","interpolate","clamp")}function ve(d){return d=Math.pow(10,Math.round(Math.log(d)/Math.LN10)-1),d&&{floor:function(a){return Math.floor(a/d)*d},ceil:function(a){return Math.ceil(a/d)*d}}}function xe(d,a){var c=
cb(d),e=c[1]-c[0],p=Math.pow(10,Math.floor(Math.log(e/a)/Math.LN10)),e=a/e*p;return 0.15>=e?p*=10:0.35>=e?p*=5:0.75>=e&&(p*=2),c[0]=Math.ceil(c[0]/p)*p,c[1]=Math.floor(c[1]/p)*p+0.5*p,c[2]=p,c}function Jc(d,a){return m.range.apply(m,xe(d,a))}function Kc(d,a,c){var e=-Math.floor(Math.log(xe(d,a)[2])/Math.LN10+0.01);return m.format(c?c.replace(ye,function(d,a,c,s,r,f,g,l,m,n){return[a,c,s,r,f,g,l,m||"."+(e-2*("%"===n)),n].join("")}):",."+e+"f")}function ze(d,a,c,e){function p(a){return d(c(a))}return p.invert=
function(a){return e(d.invert(a))},p.domain=function(a){return arguments.length?(0>a[0]?(c=Lc,e=zg):(c=Ae,e=Be),d.domain(a.map(c)),p):d.domain().map(e)},p.base=function(d){return arguments.length?(a=+d,p):a},p.nice=function(){return d.domain(Cb(d.domain(),Ag(a))),p},p.ticks=function(){var p=cb(d.domain()),f=[];if(p.every(isFinite)){var g=Math.log(a),l=Math.floor(p[0]/g),g=Math.ceil(p[1]/g),m=e(p[0]),p=e(p[1]),n=a%1?2:a;if(c===Lc)for(f.push(-Math.pow(a,-l));l++<g;)for(var q=n-1;0<q;q--)f.push(-Math.pow(a,
-l)*q);else{for(;g>l;l++)for(q=1;n>q;q++)f.push(Math.pow(a,l)*q);f.push(Math.pow(a,l))}for(l=0;f[l]<m;l++);for(g=f.length;f[g-1]>p;g--);f=f.slice(l,g)}return f},p.tickFormat=function(d,f){if(2>arguments.length&&(f=Bg),!arguments.length)return f;var g,l=Math.log(a),m=Math.max(0.1,d/p.ticks().length),n=c===Lc?(g=-1E-12,Math.floor):(g=1E-12,Math.ceil);return function(d){return d/e(l*n(c(d)/l+g))<=m?f(d):""}},p.copy=function(){return ze(d.copy(),a,c,e)},we(p,d)}function Ae(d){return Math.log(0>d?0:d)}
function Be(d){return Math.exp(d)}function Lc(d){return-Math.log(0<d?0:-d)}function zg(d){return-Math.exp(-d)}function Ag(d){d=Math.log(d);var a={floor:function(a){return Math.floor(a/d)*d},ceil:function(a){return Math.ceil(a/d)*d}};return function(){return a}}function Ce(d,a){function c(a){return d(e(a))}var e=Db(a),p=Db(1/a);return c.invert=function(a){return p(d.invert(a))},c.domain=function(a){return arguments.length?(d.domain(a.map(e)),c):d.domain().map(p)},c.ticks=function(d){return Jc(c.domain(),
d)},c.tickFormat=function(d,a){return Kc(c.domain(),d,a)},c.nice=function(){return c.domain(Cb(c.domain(),ve))},c.exponent=function(d){if(!arguments.length)return a;var f=c.domain();return e=Db(a=d),p=Db(1/a),c.domain(f)},c.copy=function(){return Ce(d.copy(),a)},we(c,d)}function Db(d){return function(a){return 0>a?-Math.pow(-a,d):Math.pow(a,d)}}function De(d,c){function e(a){return u[((p.get(a)||p.set(a,d.push(a)))-1)%u.length]}function f(a,c){return m.range(d.length).map(function(d){return a+c*d})}
var p,u,g;return e.domain=function(f){if(!arguments.length)return d;d=[];p=new a;for(var u,g=-1,J=f.length;++g<J;)p.has(u=f[g])||p.set(u,d.push(u));return e[c.t].apply(e,c.a)},e.range=function(d){return arguments.length?(u=d,g=0,c={t:"range",a:arguments},e):u},e.rangePoints=function(a,p){2>arguments.length&&(p=0);var l=a[0],m=a[1],n=(m-l)/(Math.max(1,d.length-1)+p);return u=f(2>d.length?(l+m)/2:l+n*p/2,n),g=0,c={t:"rangePoints",a:arguments},e},e.rangeBands=function(a,p,l){2>arguments.length&&(p=0);
3>arguments.length&&(l=p);var m=a[1]<a[0],n=a[m-0],q=(a[1-m]-n)/(d.length-p+2*l);return u=f(n+q*l,q),m&&u.reverse(),g=q*(1-p),c={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(a,p,l){2>arguments.length&&(p=0);3>arguments.length&&(l=p);var m=a[1]<a[0],n=a[m-0],q=a[1-m],I=Math.floor((q-n)/(d.length-p+2*l));return u=f(n+Math.round((q-n-(d.length-p)*I)/2),I),m&&u.reverse(),g=Math.round(I*(1-p)),c={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return g},e.rangeExtent=function(){return cb(c.a[0])},
e.copy=function(){return De(d,c)},e.domain(d)}function Ee(d,a){function c(){var r=0,f=a.length;for(p=[];++r<f;)p[r-1]=m.quantile(d,r/f);return e}function e(d){return isNaN(d=+d)?0/0:a[m.bisect(p,d)]}var p;return e.domain=function(a){return arguments.length?(d=a.filter(function(d){return!isNaN(d)}).sort(m.ascending),c()):d},e.range=function(d){return arguments.length?(a=d,c()):a},e.quantiles=function(){return p},e.copy=function(){return Ee(d,a)},c()}function Fe(d,a,c){function e(a){return c[Math.max(0,
Math.min(g,Math.floor(f*(a-d))))]}function p(){return f=c.length/(a-d),g=c.length-1,e}var f,g;return e.domain=function(c){return arguments.length?(d=+c[0],a=+c[c.length-1],p()):[d,a]},e.range=function(d){return arguments.length?(c=d,p()):c},e.copy=function(){return Fe(d,a,c)},p()}function Ge(d,a){function c(e){return a[m.bisect(d,e)]}return c.domain=function(a){return arguments.length?(d=a,c):d},c.range=function(d){return arguments.length?(a=d,c):a},c.copy=function(){return Ge(d,a)},c}function He(d){function a(d){return+d}
return a.invert=a,a.domain=a.range=function(c){return arguments.length?(d=c.map(a),a):d},a.ticks=function(a){return Jc(d,a)},a.tickFormat=function(a,c){return Kc(d,a,c)},a.copy=function(){return He(d)},a}function Cg(d){return d.innerRadius}function Dg(d){return d.outerRadius}function Ie(d){return d.startAngle}function Je(d){return d.endAngle}function Ke(d){for(var a,c,e,p=-1,f=d.length;++p<f;)a=d[p],c=a[0],e=a[1]+Ia,a[0]=c*Math.cos(e),a[1]=c*Math.sin(e);return d}function Le(d){function a(s){function l(){A.push("M",
t(d(Q),q),n,m(d(G.reverse()),q),"Z")}for(var P,z,B,A=[],G=[],Q=[],M=-1,v=s.length,y=T(c),x=T(p),Ef=c===e?function(){return z}:T(e),Ff=p===f?function(){return B}:T(f);++M<v;)g.call(this,P=s[M],M)?(G.push([z=+y.call(this,P,M),B=+x.call(this,P,M)]),Q.push([+Ef.call(this,P,M),+Ff.call(this,P,M)])):G.length&&(l(),G=[],Q=[]);return G.length&&l(),A.length?A.join(""):null}var c=ta,e=ta,p=0,f=wa,g=Xa,t=na,l=t.key,m=t,n="L",q=0.7;return a.x=function(d){return arguments.length?(c=e=d,a):e},a.x0=function(d){return arguments.length?
(c=d,a):c},a.x1=function(d){return arguments.length?(e=d,a):e},a.y=function(d){return arguments.length?(p=f=d,a):f},a.y0=function(d){return arguments.length?(p=d,a):p},a.y1=function(d){return arguments.length?(f=d,a):f},a.defined=function(d){return arguments.length?(g=d,a):g},a.interpolate=function(d){return arguments.length?(l="function"==typeof d?t=d:(t=uc.get(d)||na).key,m=t.reverse||t,n=t.closed?"M":"L",a):l},a.tension=function(d){return arguments.length?(q=d,a):q},a}function Eg(d){return d.radius}
function Me(d){return[d.x,d.y]}function Fg(d){return function(){var a=d.apply(this,arguments),c=a[0],a=a[1]+Ia;return[c*Math.cos(a),c*Math.sin(a)]}}function Gg(){return 64}function Hg(){return"circle"}function Ne(d){d=Math.sqrt(d/E);return"M0,"+d+"A"+d+","+d+" 0 1,1 0,"+-d+"A"+d+","+d+" 0 1,1 0,"+d+"Z"}function db(d,a){return Tb(d,fa),d.id=a,d}function Mc(d,a,c,e){var p=d.id;return Ba(d,"function"==typeof c?function(d,f,g){d.__transition__[p].tween.set(a,e(c.call(d,d.__data__,f,g)))}:(c=e(c),function(d){d.__transition__[p].tween.set(a,
c)}))}function Ig(d){return null==d&&(d=""),function(){this.textContent=d}}function Eb(d,c,e,f){var p=d.__transition__||(d.__transition__={active:0,count:0}),u=p[e];if(!u){var g=f.time;return u=p[e]={tween:new a,event:m.dispatch("start","end"),time:g,ease:f.ease,delay:f.delay,duration:f.duration},++p.count,m.timer(function(a){function f(a){return p.active>e?J():(p.active=e,I.start.call(d,n,c),u.tween.forEach(function(a,e){(e=e.call(d,n,c))&&B.push(e)}),l(a)||m.timer(l,0,g),1)}function l(a){if(p.active!==
e)return J();a=(a-C)/z;for(var f=q(a),u=B.length;0<u;)B[--u].call(d,f);return 1<=a?(J(),I.end.call(d,n,c),1):void 0}function J(){return--p.count?delete p[e]:delete d.__transition__,1}var n=d.__data__,q=u.ease,I=u.event,C=u.delay,z=u.duration,B=[];return a>=C?f(a):m.timer(f,C,g),1},0,g),u}}function Oe(d,a){d.attr("transform",function(d){return"translate("+a(d)+",0)"})}function Pe(d,a){d.attr("transform",function(d){return"translate(0,"+a(d)+")"})}function Jg(d,a,c){if(e=[],c&&1<a.length){for(var e,
p,f=cb(d.domain()),g=-1,t=a.length,l=(a[1]-a[0])/++c;++g<t;)for(d=c;0<--d;)(p=+a[g]-d*l)>=f[0]&&e.push(p);--g;for(d=0;++d<c&&(p=+a[g]+d*l)<f[1];)e.push(p)}return e}function Ja(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ka(d,a,c){function e(a){var c=d(a),s=f(c,1);return s-a>a-c?c:s}function p(c){return a(c=d(new ia(c-1)),1),c}function f(d,c){return a(d=new ia(+d),c),d}function g(d,e,f){d=p(d);var u=[];if(1<f)for(;e>d;)c(d)%f||u.push(new Date(+d)),a(d,
1);else for(;e>d;)u.push(new Date(+d)),a(d,1);return u}d.floor=d;d.round=e;d.ceil=p;d.offset=f;d.range=g;var t=d.utc=Fb(d);return t.floor=t,t.round=Fb(e),t.ceil=Fb(p),t.offset=Fb(f),t.range=function(d,a,c){try{ia=Ja;var e=new Ja;return e._=d,g(e,a,c)}finally{ia=Date}},d}function Fb(d){return function(a,c){try{ia=Ja;var e=new Ja;return e._=a,d(e,c)._}finally{ia=Date}}}function Gb(d,a,c,e){for(var p,f,g=0,t=a.length,l=c.length;t>g;){if(e>=l)return-1;if(p=a.charCodeAt(g++),37===p){if(f=Kg[a.charAt(g++)],
!f||0>(e=f(d,c,e)))return-1}else if(p!=c.charCodeAt(e++))return-1}return e}function Hb(d){return RegExp("^(?:"+d.map(m.requote).join("|")+")","i")}function Qe(d){for(var c=new a,e=-1,f=d.length;++e<f;)c.set(d[e].toLowerCase(),e);return c}function la(d,a,c){d+="";var e=d.length;return c>e?Array(c-e+1).join(a)+d:d}function Re(d,a,c){ja.lastIndex=0;return(a=ja.exec(a.substring(c,c+2)))?(d.d=+a[0],c+a[0].length):-1}function Se(d,a,c){ja.lastIndex=0;return(a=ja.exec(a.substring(c,c+2)))?(d.H=+a[0],c+a[0].length):
-1}function Nc(d){return d.toISOString()}function Oc(d,a,c){function e(a){return d(a)}return e.invert=function(a){return Pc(d.invert(a))},e.domain=function(a){return arguments.length?(d.domain(a),e):d.domain().map(Pc)},e.nice=function(d){return e.domain(Cb(e.domain(),function(){return d}))},e.ticks=function(c,r){var f,g=e.domain();f=g[0];g=g[g.length-1];f=g>f?[f,g]:[g,f];if("function"!=typeof c){var g=(f[1]-f[0])/c,l=m.bisect(Ib,g);if(l==Ib.length)return a.year(f,c);if(!l)return d.ticks(c).map(Pc);
Math.log(g/Ib[l-1])<Math.log(Ib[l]/g)&&--l;c=a[l];r=c[1];c=c[0].range}return c(f[0],new Date(+f[1]+1),r)},e.tickFormat=function(){return c},e.copy=function(){return Oc(d.copy(),a,c)},m.rebind(e,d,"range","rangeRound","interpolate","clamp")}function Pc(d){return new Date(d)}function Te(d){return function(a){for(var c=d.length-1,e=d[c];!e[1](a);)e=d[--c];return e[0](a)}}function Qc(d){var a=new Date(d,0,1);return a.setFullYear(d),a}function Lg(d){var a=d.getFullYear(),c=Qc(a),e=Qc(a+1);return a+(d-
c)/(e-c)}function Rc(d){var a=new Date(Date.UTC(d,0,1));return a.setUTCFullYear(d),a}function Mg(d){var a=d.getUTCFullYear(),c=Rc(a),e=Rc(a+1);return a+(d-c)/(e-c)}function Ng(d){return d.responseText}function Og(d){return JSON.parse(d.responseText)}function Pg(d){var a=ka.createRange();return a.selectNode(ka.body),a.createContextualFragment(d.responseText)}function Qg(d){return d.responseXML}var m={version:"3.1.5"};Date.now||(Date.now=function(){return+new Date});var ka=document,ha=window;try{ka.createElement("div").style.setProperty("opacity",
0,"")}catch(uh){var Ue=ha.CSSStyleDeclaration.prototype,Rg=Ue.setProperty;Ue.setProperty=function(d,a,c){Rg.call(this,d,a+"",c)}}m.ascending=function(d,a){return a>d?-1:d>a?1:d>=a?0:0/0};m.descending=function(d,a){return d>a?-1:a>d?1:a>=d?0:0/0};m.min=function(d,a){var c,e,f=-1,g=d.length;if(1===arguments.length){for(;++f<g&&(null==(c=d[f])||c!=c);)c=void 0;for(;++f<g;)null!=(e=d[f])&&c>e&&(c=e)}else{for(;++f<g&&(null==(c=a.call(d,d[f],f))||c!=c);)c=void 0;for(;++f<g;)null!=(e=a.call(d,d[f],f))&&
c>e&&(c=e)}return c};m.max=function(d,a){var c,e,f=-1,g=d.length;if(1===arguments.length){for(;++f<g&&(null==(c=d[f])||c!=c);)c=void 0;for(;++f<g;)null!=(e=d[f])&&e>c&&(c=e)}else{for(;++f<g&&(null==(c=a.call(d,d[f],f))||c!=c);)c=void 0;for(;++f<g;)null!=(e=a.call(d,d[f],f))&&e>c&&(c=e)}return c};m.extent=function(d,a){var c,e,f,g=-1,l=d.length;if(1===arguments.length){for(;++g<l&&(null==(c=f=d[g])||c!=c);)c=f=void 0;for(;++g<l;)null!=(e=d[g])&&(c>e&&(c=e),e>f&&(f=e))}else{for(;++g<l&&(null==(c=f=
a.call(d,d[g],g))||c!=c);)c=void 0;for(;++g<l;)null!=(e=a.call(d,d[g],g))&&(c>e&&(c=e),e>f&&(f=e))}return[c,f]};m.sum=function(d,a){var c,e=0,f=d.length,g=-1;if(1===arguments.length)for(;++g<f;)isNaN(c=+d[g])||(e+=c);else for(;++g<f;)isNaN(c=+a.call(d,d[g],g))||(e+=c);return e};m.mean=function(d,a){var c,e=d.length,p=0,g=-1,l=0;if(1===arguments.length)for(;++g<e;)f(c=d[g])&&(p+=(c-p)/++l);else for(;++g<e;)f(c=a.call(d,d[g],g))&&(p+=(c-p)/++l);return l?p:void 0};m.quantile=function(d,a){var c=(d.length-
1)*a+1,e=Math.floor(c),f=+d[e-1];return(c-=e)?f+c*(d[e]-f):f};m.median=function(d,a){return 1<arguments.length&&(d=d.map(a)),d=d.filter(f),d.length?m.quantile(d.sort(m.ascending),0.5):void 0};m.bisector=function(d){return{left:function(a,c,e,f){3>arguments.length&&(e=0);for(4>arguments.length&&(f=a.length);f>e;){var g=e+f>>>1;d.call(a,a[g],g)<c?e=g+1:f=g}return e},right:function(a,c,e,f){3>arguments.length&&(e=0);for(4>arguments.length&&(f=a.length);f>e;){var g=e+f>>>1;c<d.call(a,a[g],g)?f=g:e=g+
1}return e}}};var Ve=m.bisector(function(d){return d});m.bisectLeft=Ve.left;m.bisect=m.bisectRight=Ve.right;m.shuffle=function(d){for(var a,c,e=d.length;e;)c=Math.random()*e--|0,a=d[e],d[e]=d[c],d[c]=a;return d};m.permute=function(d,a){for(var c=[],e=-1,f=a.length;++e<f;)c[e]=d[a[e]];return c};m.zip=function(){if(!(e=arguments.length))return[];for(var d=-1,a=m.min(arguments,l),c=Array(a);++d<a;)for(var e,f=-1,g=c[d]=Array(e);++f<e;)g[f]=arguments[f][d];return c};m.transpose=function(d){return m.zip.apply(m,
d)};m.keys=function(d){var a=[],c;for(c in d)a.push(c);return a};m.values=function(d){var a=[],c;for(c in d)a.push(d[c]);return a};m.entries=function(d){var a=[],c;for(c in d)a.push({key:c,value:d[c]});return a};m.merge=function(d){return Array.prototype.concat.apply([],d)};m.range=function(d,a,c){if(3>arguments.length&&(c=1,2>arguments.length&&(a=d,d=0)),1/0===(a-d)/c)throw Error("infinite range");var e,f=[],g;e=Math.abs(c);for(g=1;e*g%1;)g*=10;var l=-1;if(d*=g,a*=g,c*=g,0>c)for(;(e=d+c*++l)>a;)f.push(e/
g);else for(;(e=d+c*++l)<a;)f.push(e/g);return f};m.map=function(d){var c=new a,e;for(e in d)c.set(e,d[e]);return c};n(a,{has:function(d){return Fa+d in this},get:function(d){return this[Fa+d]},set:function(d,a){return this[Fa+d]=a},remove:function(d){return d=Fa+d,d in this&&delete this[d]},keys:function(){var d=[];return this.forEach(function(a){d.push(a)}),d},values:function(){var d=[];return this.forEach(function(a,c){d.push(c)}),d},entries:function(){var d=[];return this.forEach(function(a,c){d.push({key:a,
value:c})}),d},forEach:function(d){for(var a in this)a.charCodeAt(0)===We&&d.call(this,a.substring(1),this[a])}});var Fa="\x00",We=Fa.charCodeAt(0);m.nest=function(){function d(c,s,l){if(l>=g.length)return f?f.call(p,s):e?s.sort(e):s;for(var m,n,q,U,C=-1,z=s.length,B=g[l++],A=new a;++C<z;)(U=A.get(m=B(n=s[C])))?U.push(n):A.set(m,[n]);return c?(n=c(),q=function(a,e){n.set(a,d(c,e,l))}):(n={},q=function(a,e){n[a]=d(c,e,l)}),A.forEach(q),n}function c(d,a){if(a>=g.length)return d;var e=[],f=l[a++];return d.forEach(function(d,
f){e.push({key:d,values:c(f,a)})}),f?e.sort(function(d,a){return f(d.key,a.key)}):e}var e,f,p={},g=[],l=[];return p.map=function(a,c){return d(c,a,0)},p.entries=function(a){return c(d(m.map,a,0),0)},p.key=function(d){return g.push(d),p},p.sortKeys=function(d){return l[g.length-1]=d,p},p.sortValues=function(d){return e=d,p},p.rollup=function(d){return f=d,p},p};m.set=function(d){var a=new c;if(d)for(var e=0;e<d.length;e++)a.add(d[e]);return a};n(c,{has:function(d){return Fa+d in this},add:function(d){return this[Fa+
d]=!0,d},remove:function(d){return d=Fa+d,d in this&&delete this[d]},values:function(){var d=[];return this.forEach(function(a){d.push(a)}),d},forEach:function(d){for(var a in this)a.charCodeAt(0)===We&&d.call(this,a.substring(1))}});m.behavior={};m.rebind=function(d,a){for(var c,f=1,p=arguments.length;++f<p;)d[c=arguments[f]]=e(d,a,a[c]);return d};m.dispatch=function(){for(var d=new g,a=-1,c=arguments.length;++a<c;)d[arguments[a]]=q(d);return d};g.prototype.on=function(d,a){var c=d.indexOf("."),
e="";if(0<=c&&(e=d.substring(c+1),d=d.substring(0,c)),d)return 2>arguments.length?this[d].on(e):this[d].on(e,a);if(2===arguments.length){if(null==a)for(d in this)this.hasOwnProperty(d)&&this[d].on(e,null);return this}};m.event=null;m.mouse=function(d){return H(d,R())};var Sb=/WebKit/.test(ha.navigator.userAgent)?-1:0,Aa=function(d){return Array.prototype.slice.call(d)};try{Aa(ka.documentElement.childNodes)[0].nodeType}catch(vh){Aa=x}var Tb=[].__proto__?function(d,a){d.__proto__=a}:function(d,a){for(var c in a)d[c]=
a[c]};m.touches=function(d,a){return 2>arguments.length&&(a=R().touches),a?Aa(a).map(function(a){var c=H(d,a);return c.identifier=a.identifier,c}):[]};m.behavior.drag=function(){function d(){this.on("mousedown.drag",a).on("touchstart.drag",a)}function a(){function d(){var a=g.parentNode;return null!=q?m.touches(a).filter(function(d){return d.identifier===q})[0]:m.mouse(a)}function f(){l({type:"dragend"});D&&(v(),m.event.target===n&&V(I,"click"));I.on(null!=q?"touchmove.drag-"+q:"mousemove.drag",null).on(null!=
q?"touchend.drag-"+q:"mouseup.drag",null)}var s,g=this,l=c.of(g,arguments),n=m.event.target,q=m.event.touches?m.event.changedTouches[0].identifier:null,S=d(),D=0,I=m.select(ha).on(null!=q?"touchmove.drag-"+q:"mousemove.drag",function(){if(!g.parentNode)return f();var a=d(),c=a[0]-S[0],e=a[1]-S[1];D|=c|e;S=a;v();l({type:"drag",x:a[0]+s[0],y:a[1]+s[1],dx:c,dy:e})}).on(null!=q?"touchend.drag-"+q:"mouseup.drag",f,!0);e?(s=e.apply(g,arguments),s=[s.x-S[0],s.y-S[1]]):s=[0,0];null==q&&v();l({type:"dragstart"})}
var c=y(d,"drag","dragstart","dragend"),e=null;return d.origin=function(a){return arguments.length?(e=a,d):e},m.rebind(d,c,"on")};var cd=function(d,a){return a.querySelector(d)},dd=function(d,a){return a.querySelectorAll(d)},Ta=ka.documentElement,Sg=Ta.matchesSelector||Ta.webkitMatchesSelector||Ta.mozMatchesSelector||Ta.msMatchesSelector||Ta.oMatchesSelector,hd=function(d,a){return Sg.call(d,a)};"function"==typeof Sizzle&&(cd=function(d,a){return Sizzle(d,a)[0]||null},dd=function(d,a){return Sizzle.uniqueSort(Sizzle(d,
a))},hd=Sizzle.matchesSelector);var W=[];m.selection=function(){return eb};m.selection.prototype=W;W.select=function(d){var a,c,e,f,g=[];"function"!=typeof d&&(d=O(d));for(var l=-1,t=this.length;++l<t;){g.push(a=[]);a.parentNode=(e=this[l]).parentNode;for(var m=-1,n=e.length;++m<n;)(f=e[m])?(a.push(c=d.call(f,f.__data__,m)),c&&"__data__"in f&&(c.__data__=f.__data__)):a.push(null)}return K(g)};W.selectAll=function(d){var a,c,e=[];"function"!=typeof d&&(d=X(d));for(var f=-1,g=this.length;++f<g;)for(var l=
this[f],t=-1,m=l.length;++t<m;)(c=l[t])&&(e.push(a=Aa(d.call(c,c.__data__,t))),a.parentNode=c);return K(e)};var Sc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};m.ns={prefix:Sc,qualify:function(d){var a=d.indexOf(":"),c=d;return 0<=a&&(c=d.substring(0,a),d=d.substring(a+1)),Sc.hasOwnProperty(c)?{space:Sc[c],local:d}:d}};W.attr=function(d,a){if(2>arguments.length){if("string"==
typeof d){var c=this.node();return d=m.ns.qualify(d),d.local?c.getAttributeNS(d.space,d.local):c.getAttribute(d)}for(a in d)this.each(Wa(a,d[a]));return this}return this.each(Wa(d,a))};m.requote=function(d){return d.replace(Tg,"\\$&")};var Tg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;W.classed=function(d,a){if(2>arguments.length){if("string"==typeof d){var c=this.node(),e=(d=d.trim().split(/^|\s+/g)).length,f=-1;if(a=c.classList)for(;++f<e;){if(!a.contains(d[f]))return!1}else for(a=c.getAttribute("class");++f<
e;)if(!ad(d[f]).test(a))return!1;return!0}for(a in d)this.each(bd(a,d[a]));return this}return this.each(bd(d,a))};W.style=function(d,a,c){var e=arguments.length;if(3>e){if("string"!=typeof d){2>e&&(a="");for(c in d)this.each(ed(c,d[c],a));return this}if(2>e)return ha.getComputedStyle(this.node(),null).getPropertyValue(d);c=""}return this.each(ed(d,a,c))};W.property=function(d,a){if(2>arguments.length){if("string"==typeof d)return this.node()[d];for(a in d)this.each(fd(a,d[a]));return this}return this.each(fd(d,
a))};W.text=function(d){return arguments.length?this.each("function"==typeof d?function(){var a=d.apply(this,arguments);this.textContent=null==a?"":a}:null==d?function(){this.textContent=""}:function(){this.textContent=d}):this.node().textContent};W.html=function(d){return arguments.length?this.each("function"==typeof d?function(){var a=d.apply(this,arguments);this.innerHTML=null==a?"":a}:null==d?function(){this.innerHTML=""}:function(){this.innerHTML=d}):this.node().innerHTML};W.append=function(d){function a(){return this.appendChild(ka.createElementNS(this.namespaceURI,
d))}function c(){return this.appendChild(ka.createElementNS(d.space,d.local))}return d=m.ns.qualify(d),this.select(d.local?c:a)};W.insert=function(d,a){function c(e,f){return this.insertBefore(ka.createElementNS(this.namespaceURI,d),a.call(this,e,f))}function e(c,f){return this.insertBefore(ka.createElementNS(d.space,d.local),a.call(this,c,f))}return d=m.ns.qualify(d),"function"!=typeof a&&(a=O(a)),this.select(d.local?e:c)};W.remove=function(){return this.each(function(){var d=this.parentNode;d&&
d.removeChild(this)})};W.data=function(d,c){function e(d,f){var r,p,g,u=d.length,l=f.length,J=Math.min(u,l),q=Array(l),U=Array(l),M=Array(u);if(c){var v=new a,y=new a,x=[];for(r=-1;++r<u;)J=c.call(p=d[r],p.__data__,r),v.has(J)?M[r]=p:v.set(J,p),x.push(J);for(r=-1;++r<l;)J=c.call(f,g=f[r],r),(p=v.get(J))?(q[r]=p,p.__data__=g):y.has(J)||(U[r]={__data__:g}),y.set(J,g),v.remove(J);for(r=-1;++r<u;)v.has(x[r])&&(M[r]=d[r])}else{for(r=-1;++r<J;)p=d[r],g=f[r],p?(p.__data__=g,q[r]=p):U[r]={__data__:g};for(;l>
r;++r)U[r]={__data__:f[r]};for(;u>r;++r)M[r]=d[r]}U.update=q;U.parentNode=q.parentNode=M.parentNode=d.parentNode;t.push(U);m.push(q);n.push(M)}var f,p,g=-1,l=this.length;if(!arguments.length){for(d=Array(l=(f=this[0]).length);++g<l;)(p=f[g])&&(d[g]=p.__data__);return d}var t=kd([]),m=K([]),n=K([]);if("function"==typeof d)for(;++g<l;)e(f=this[g],d.call(f,f.parentNode.__data__,g));else for(;++g<l;)e(f=this[g],d);return m.enter=function(){return t},m.exit=function(){return n},m};W.datum=function(d){return arguments.length?
this.property("__data__",d):this.property("__data__")};W.filter=function(d){var a,c,e,f=[];"function"!=typeof d&&(d=gd(d));for(var g=0,l=this.length;l>g;g++){f.push(a=[]);a.parentNode=(c=this[g]).parentNode;for(var t=0,m=c.length;m>t;t++)(e=c[t])&&d.call(e,e.__data__,t)&&a.push(e)}return K(f)};W.order=function(){for(var d=-1,a=this.length;++d<a;)for(var c,e=this[d],f=e.length-1,g=e[f];0<=--f;)(c=e[f])&&(g&&g!==c.nextSibling&&g.parentNode.insertBefore(c,g),g=c);return this};W.sort=function(d){d=uf.apply(this,
arguments);for(var a=-1,c=this.length;++a<c;)this[a].sort(d);return this.order()};W.on=function(d,a,c){var e=arguments.length;if(3>e){if("string"!=typeof d){2>e&&(a=!1);for(c in d)this.each(id(c,d[c],a));return this}if(2>e)return(e=this.node()["__on"+d])&&e._;c=!1}return this.each(id(d,a,c))};var Ub=m.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ub.forEach(function(d){"on"+d in ka&&Ub.remove(d)});W.each=function(d){return Ba(this,function(a,c,e){d.call(a,a.__data__,c,e)})};W.call=function(d){var a=
Aa(arguments);return d.apply(a[0]=this,a),this};W.empty=function(){return!this.node()};W.node=function(){for(var d=0,a=this.length;a>d;d++)for(var c=this[d],e=0,f=c.length;f>e;e++){var g=c[e];if(g)return g}return null};var Ga=[];m.selection.enter=kd;m.selection.enter.prototype=Ga;Ga.append=W.append;Ga.insert=W.insert;Ga.empty=W.empty;Ga.node=W.node;Ga.select=function(d){for(var a,c,e,f,g,l=[],t=-1,m=this.length;++t<m;){e=(f=this[t]).update;l.push(a=[]);a.parentNode=f.parentNode;for(var n=-1,q=f.length;++n<
q;)(g=f[n])?(a.push(e[n]=c=d.call(f.parentNode,g.__data__,n)),c.__data__=g.__data__):a.push(null)}return K(l)};W.transition=function(){var d,a,c=fb||++Xe,e=[],f=Object.create(Jb);f.time=Date.now();for(var g=-1,l=this.length;++g<l;){e.push(d=[]);for(var t=this[g],m=-1,n=t.length;++m<n;)(a=t[m])&&Eb(a,m,c,f),d.push(a)}return db(e,c)};var eb=K([[ka]]);eb[0].parentNode=Ta;m.select=function(d){return"string"==typeof d?eb.select(d):K([[d]])};m.selectAll=function(d){return"string"==typeof d?eb.selectAll(d):
K([Aa(d)])};m.behavior.zoom=function(){function d(){this.on("mousedown.zoom",l).on("mousemove.zoom",n).on(Ug+".zoom",t).on("dblclick.zoom",q).on("touchstart.zoom",F).on("touchmove.zoom",S).on("touchend.zoom",F)}function a(d){return[(d[0]-Q[0])/M,(d[1]-Q[1])/M]}function c(d){M=Math.max(x[0],Math.min(x[1],d))}function e(d,a){a=[a[0]*M+Q[0],a[1]*M+Q[1]];Q[0]+=d[0]-a[0];Q[1]+=d[1]-a[1]}function f(){z&&z.domain(C.range().map(function(d){return(d-Q[0])/M}).map(C.invert));A&&A.domain(B.range().map(function(d){return(d-
Q[1])/M}).map(B.invert))}function g(d){f();m.event.preventDefault();d({type:"zoom",scale:M,translate:Q})}function l(){var d=this,c=Z.of(d,arguments),f=m.event.target,r=0,p=m.select(ha).on("mousemove.zoom",function(){r=1;e(m.mouse(d),t);g(c)}).on("mouseup.zoom",function(){r&&v();p.on("mousemove.zoom",null).on("mouseup.zoom",null);r&&m.event.target===f&&V(p,"click.zoom")}),t=a(m.mouse(d));ha.focus();v()}function t(){D||(D=a(m.mouse(this)));c(Math.pow(2,0.002*Kb())*M);e(m.mouse(this),D);g(Z.of(this,
arguments))}function n(){D=null}function q(){var d=m.mouse(this),f=a(d),p=Math.log(M)/Math.LN2;c(Math.pow(2,m.event.shiftKey?Math.ceil(p)-1:Math.floor(p)+1));e(d,f);g(Z.of(this,arguments))}function F(){var d=m.touches(this),f=Date.now();if(I=M,D={},d.forEach(function(d){D[d.identifier]=a(d)}),v(),1===d.length){if(500>f-G){var p=d[0],d=a(d[0]);c(2*M);e(p,d);g(Z.of(this,arguments))}G=f}}function S(){var d=m.touches(this),a=d[0],f=D[a.identifier];if(d=d[1]){var p=D[d.identifier],a=[(a[0]+d[0])/2,(a[1]+
d[1])/2],f=[(f[0]+p[0])/2,(f[1]+p[1])/2];c(m.event.scale*I)}e(a,f);G=null;g(Z.of(this,arguments))}var D,I,C,z,B,A,G,Q=[0,0],M=1,x=Ye,Z=y(d,"zoom");return d.translate=function(a){return arguments.length?(Q=a.map(Number),f(),d):Q},d.scale=function(a){return arguments.length?(M=+a,f(),d):M},d.scaleExtent=function(a){return arguments.length?(x=null==a?Ye:a.map(Number),d):x},d.x=function(a){return arguments.length?(z=a,C=a.copy(),Q=[0,0],M=1,d):z},d.y=function(a){return arguments.length?(A=a,B=a.copy(),
Q=[0,0],M=1,d):A},m.rebind(d,Z,"on")};var Kb,Ye=[0,1/0],Ug="onwheel"in ka?(Kb=function(){return-m.event.deltaY*(m.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ka?(Kb=function(){return m.event.wheelDelta},"mousewheel"):(Kb=function(){return-m.event.detail},"MozMousePixelScroll");Ma.prototype.toString=function(){return this.rgb()+""};m.hsl=function(d,a,c){return 1===arguments.length?d instanceof Vb?Na(d.h,d.s,d.l):ac(""+d,qd,Na):Na(+d,+a,+c)};var Tc=Vb.prototype=new Ma;Tc.brighter=function(d){return d=
Math.pow(0.7,arguments.length?d:1),Na(this.h,this.s,this.l/d)};Tc.darker=function(d){return d=Math.pow(0.7,arguments.length?d:1),Na(this.h,this.s,d*this.l)};Tc.rgb=function(){return gb(this.h,this.s,this.l)};var E=Math.PI,N=1E-6,L=E/180,Y=180/E;m.hcl=function(d,a,c){var e;if(1===arguments.length)if(d instanceof hb)e=Oa(d.h,d.c,d.l);else if(d instanceof ib)e=Oa(Math.atan2(d.b,d.a)*Y,Math.sqrt(d.a*d.a+d.b*d.b),d.l);else{e=(d=rd((d=m.rgb(d)).r,d.g,d.b)).l;var f=d.a,g=d.b;e=Oa(Math.atan2(g,f)*Y,Math.sqrt(f*
f+g*g),e)}else e=Oa(+d,+a,+c);return e};var Uc=hb.prototype=new Ma;Uc.brighter=function(d){return Oa(this.h,this.c,Math.min(100,this.l+Lb*(arguments.length?d:1)))};Uc.darker=function(d){return Oa(this.h,this.c,Math.max(0,this.l-Lb*(arguments.length?d:1)))};Uc.rgb=function(){return Wb(this.h,this.c,this.l).rgb()};m.lab=function(d,a,c){return 1===arguments.length?d instanceof ib?Pa(d.l,d.a,d.b):d instanceof hb?Wb(d.l,d.c,d.h):rd((d=m.rgb(d)).r,d.g,d.b):Pa(+d,+a,+c)};var Lb=18,nd=0.95047,od=1,pd=1.08883,
Vc=ib.prototype=new Ma;Vc.brighter=function(d){return Pa(Math.min(100,this.l+Lb*(arguments.length?d:1)),this.a,this.b)};Vc.darker=function(d){return Pa(Math.max(0,this.l-Lb*(arguments.length?d:1)),this.a,this.b)};Vc.rgb=function(){return md(this.l,this.a,this.b)};m.rgb=function(d,a,c){return 1===arguments.length?d instanceof $b?va(d.r,d.g,d.b):ac(""+d,va,gb):va(~~d,~~a,~~c)};var Mb=$b.prototype=new Ma;Mb.brighter=function(d){d=Math.pow(0.7,arguments.length?d:1);var a=this.r,c=this.g,e=this.b;return a||
c||e?(a&&30>a&&(a=30),c&&30>c&&(c=30),e&&30>e&&(e=30),va(Math.min(255,Math.floor(a/d)),Math.min(255,Math.floor(c/d)),Math.min(255,Math.floor(e/d)))):va(30,30,30)};Mb.darker=function(d){return d=Math.pow(0.7,arguments.length?d:1),va(Math.floor(d*this.r),Math.floor(d*this.g),Math.floor(d*this.b))};Mb.hsl=function(){return qd(this.r,this.g,this.b)};Mb.toString=function(){return"#"+Qa(this.r)+Qa(this.g)+Qa(this.b)};var jb=m.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",
azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",
darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",
greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",
lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",
olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",
slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});jb.forEach(function(d,a){jb.set(d,ac(a,va,gb))});m.functor=T;m.xhr=function(d,a,c){function e(){var d=n.status;!d&&n.responseText||200<=d&&300>d||304===d?g.load.call(f,t.call(f,n)):g.error.call(f,n)}var f={},g=
m.dispatch("progress","load","error"),l={},t=ma,n=new (ha.XDomainRequest&&/^(http(s)?:)?\/\//.test(d)?XDomainRequest:XMLHttpRequest);return"onload"in n?n.onload=n.onerror=e:n.onreadystatechange=function(){3<n.readyState&&e()},n.onprogress=function(d){var a=m.event;m.event=d;try{g.progress.call(f,n)}finally{m.event=a}},f.header=function(d,a){return d=(d+"").toLowerCase(),2>arguments.length?l[d]:(null==a?delete l[d]:l[d]=a+"",f)},f.mimeType=function(d){return arguments.length?(a=null==d?null:d+"",f):
a},f.response=function(d){return t=d,f},["get","post"].forEach(function(d){f[d]=function(){return f.send.apply(f,[d].concat(Aa(arguments)))}}),f.send=function(c,e,g){if(2===arguments.length&&"function"==typeof e&&(g=e,e=null),n.open(c,d,!0),null==a||"accept"in l||(l.accept=a+",*/*"),n.setRequestHeader)for(var r in l)n.setRequestHeader(r,l[r]);return null!=a&&n.overrideMimeType&&n.overrideMimeType(a),null!=g&&f.on("error",g).on("load",function(d){g(null,d)}),n.send(null==e?null:e),f},f.abort=function(){return n.abort(),
f},m.rebind(f,g,"on"),2===arguments.length&&"function"==typeof a&&(c=a,a=null),null==c?f:f.get(wf(c))};m.csv=sd(",","text/csv");m.tsv=sd("\t","text/tab-separated-values");var lb,kb,Vg=0,ec={},Ra=null;m.timer=function(d,a,c){if(3>arguments.length){if(2>arguments.length)a=0;else if(!isFinite(a))return;c=Date.now()}var e=ec[d.id];e&&e.callback===d?(e.then=c,e.delay=a):ec[d.id=++Vg]=Ra={callback:d,then:c,delay:a,next:Ra};lb||(kb=clearTimeout(kb),lb=1,ud(dc))};m.timer.flush=function(){for(var d,a=Date.now(),
c=Ra;c;)d=a-c.then,c.delay||(c.flush=c.callback(d)),c=c.next;td()};var ud=ha.requestAnimationFrame||ha.webkitRequestAnimationFrame||ha.mozRequestAnimationFrame||ha.oRequestAnimationFrame||ha.msRequestAnimationFrame||function(d){setTimeout(d,17)},Nb=[3,3],Wg="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(d,a){var c=Math.pow(10,3*Math.abs(8-a));return{scale:8<a?function(d){return d/c}:function(d){return d*c},symbol:d}});m.formatPrefix=function(d,a){var c=0;return d&&(0>d&&(d*=-1),a&&
(d=m.round(d,fc(d,a))),c=1+Math.floor(1E-12+Math.log(d)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((0>=c?c+1:c-1)/3)))),Wg[8+c/3]};m.round=function(d,a){return a?Math.round(d*(a=Math.pow(10,a)))/a:Math.round(d)};m.format=function(d){d=ye.exec(d);var a=d[1]||" ",c=d[2]||">",e=d[3]||"",f=d[4]||"",g=d[5],l=+d[6],t=d[7],n=d[8],q=d[9],F=1,S="",D=!1;switch(n&&(n=+n.substring(1)),(g||"0"===a&&"="===c)&&(g=a="0",c="=",t&&(l-=Math.floor((l-1)/4))),q){case "n":t=!0;q="g";break;case "%":F=100;S="%";
q="f";break;case "p":F=100;S="%";q="r";break;case "b":case "o":case "x":case "X":f&&(f="0"+q.toLowerCase());case "c":case "d":D=!0;n=0;break;case "s":F=-1,q="r"}"#"===f&&(f="");"r"!=q||n||(q="g");null!=n&&("g"==q?n=Math.max(1,Math.min(21,n)):("e"==q||"f"==q)&&(n=Math.max(0,Math.min(20,n))));var q=Xg.get(q)||xf,v=g&&t;return function(d){if(D&&d%1)return"";var z=0>d||0===d&&0>1/d?(d=-d,"-"):e;if(0>F){var B=m.formatPrefix(d,n);d=B.scale(d);S=B.symbol}else d*=F;d=q(d,n);!g&&t&&(d=Wc(d));var B=f.length+
d.length+(v?0:z.length),A=l>B?Array(B=l-B+1).join(a):"";return v&&(d=Wc(A+d)),d.replace(".","."),z+=f,("<"===c?z+d+A:">"===c?A+z+d:"^"===c?A.substring(0,B>>=1)+z+d+A.substring(B):z+(v?d:A+d))+S}};var ye=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Xg=m.map({b:function(d){return d.toString(2)},c:function(d){return String.fromCharCode(d)},o:function(d){return d.toString(8)},x:function(d){return d.toString(16)},X:function(d){return d.toString(16).toUpperCase()},g:function(d,
a){return d.toPrecision(a)},e:function(d,a){return d.toExponential(a)},f:function(d,a){return d.toFixed(a)},r:function(d,a){return(d=m.round(d,fc(d,a))).toFixed(Math.max(0,Math.min(20,fc(d*(1+1E-15),a))))}}),Wc=ma;if(Nb)var Yg=Nb.length,Wc=function(d){for(var a=d.lastIndexOf("."),c=0<=a?"."+d.substring(a+1):(a=d.length,""),e=[],f=0,g=Nb[0];0<a&&0<g;)e.push(d.substring(a-=g,a+g)),g=Nb[f=(f+1)%Yg];return e.reverse().join(",")+c};m.geo={};m.geo.stream=function(d,a){d&&Ze.hasOwnProperty(d.type)?Ze[d.type](d,
a):mb(d,a)};var Ze={Feature:function(d,a){mb(d.geometry,a)},FeatureCollection:function(d,a){for(var c=d.features,e=-1,f=c.length;++e<f;)mb(c[e].geometry,a)}},vd={Sphere:function(d,a){a.sphere()},Point:function(d,a){var c=d.coordinates;a.point(c[0],c[1])},MultiPoint:function(d,a){for(var c,e=d.coordinates,f=-1,g=e.length;++f<g;)c=e[f],a.point(c[0],c[1])},LineString:function(d,a){gc(d.coordinates,a,0)},MultiLineString:function(d,a){for(var c=d.coordinates,e=-1,f=c.length;++e<f;)gc(c[e],a,0)},Polygon:function(d,
a){wd(d.coordinates,a)},MultiPolygon:function(d,a){for(var c=d.coordinates,e=-1,f=c.length;++e<f;)wd(c[e],a)},GeometryCollection:function(d,a){for(var c=d.geometries,e=-1,f=c.length;++e<f;)mb(c[e],a)}};m.geo.area=function(d){return Ua=0,m.geo.stream(d,Ca),Ua};var Ua,nb,ob,Ca={sphere:function(){Ua+=4*E},point:ea,lineStart:ea,lineEnd:ea,polygonStart:function(){nb=1;ob=0;Ca.lineStart=yf},polygonEnd:function(){var d=2*Math.atan2(ob,nb);Ua+=0>d?4*E+d:d;Ca.lineStart=Ca.lineEnd=Ca.point=ea}};m.geo.bounds=
xd(ma);m.geo.centroid=function(d){ga=pa=ca=da=aa=0;m.geo.stream(d,qa);var a;return pa&&Math.abs(a=Math.sqrt(ca*ca+da*da+aa*aa))>N?[Math.atan2(da,ca)*Y,Math.asin(Math.max(-1,Math.min(1,aa/a)))*Y]:void 0};var ga,pa,ca,da,aa,qa={sphere:function(){2>ga&&(ga=2,pa=ca=da=aa=0)},point:yd,lineStart:hc,lineEnd:ic,polygonStart:function(){2>ga&&(ga=2,pa=ca=da=aa=0);qa.lineStart=zf},polygonEnd:function(){qa.lineStart=hc}},Hd=Cd(Xa,function(d){var a,c=0/0,e=0/0,f=0/0;return{lineStart:function(){d.lineStart();a=
1},point:function(g,l){var t=0<g?E:-E,m=Math.abs(g-c);if(Math.abs(m-E)<N)d.point(c,e=0<(e+l)/2?E/2:-E/2),d.point(f,e),d.lineEnd(),d.lineStart(),d.point(t,e),d.point(g,e),a=0;else if(f!==t&&m>=E){Math.abs(c-f)<N&&(c-=f*N);Math.abs(g-t)<N&&(g-=t*N);var m=c,n=e,q=g,S,D,v=Math.sin(m-q);e=Math.abs(v)>N?Math.atan((Math.sin(n)*(D=Math.cos(l))*Math.sin(q)-Math.sin(l)*(S=Math.cos(n))*Math.sin(m))/(S*D*v)):(n+l)/2;d.point(f,e);d.lineEnd();d.lineStart();d.point(t,e);a=0}d.point(c=g,e=l);f=t},lineEnd:function(){d.lineEnd();
c=e=0/0},clean:function(){return 2-a}}},function(d,a,c,e){null==d?(c=c*E/2,e.point(-E,c),e.point(0,c),e.point(E,c),e.point(E,0),e.point(E,-c),e.point(0,-c),e.point(-E,-c),e.point(-E,0),e.point(-E,c)):Math.abs(d[0]-a[0])>N?(d=(d[0]<a[0]?1:-1)*E,c=c*d/2,e.point(-d,c),e.point(0,c),e.point(d,c)):e.point(a[0],a[1])}),tb=1E9;m.geo.projection=Da;m.geo.projectionMutator=mc;(m.geo.equirectangular=function(){return Da(Ya)}).raw=Ya.invert=Ya;m.geo.rotation=function(d){function a(c){return c=d(c[0]*L,c[1]*L),
c[0]*=Y,c[1]*=Y,c}return d=nc(d[0]%360*L,d[1]*L,2<d.length?d[2]*L:0),a.invert=function(a){return a=d.invert(a[0]*L,a[1]*L),a[0]*=Y,a[1]*=Y,a},a};m.geo.circle=function(){function a(){var d="function"==typeof f?f.apply(this,arguments):f,c=nc(-d[0]*L,-d[1]*L,0).invert,g=[];return e(null,null,1,{point:function(a,d){g.push(a=c(a,d));a[0]*=Y;a[1]*=Y}}),{type:"Polygon",coordinates:[g]}}var c,e,f=[0,0],g=6;return a.origin=function(c){return arguments.length?(f=c,a):f},a.angle=function(f){return arguments.length?
(e=lc((c=+f)*L,g*L),a):c},a.precision=function(f){return arguments.length?(e=lc(c*L,(g=+f)*L),a):g},a.angle(90)};m.geo.distance=function(a,c){var e,f=(c[0]-a[0])*L,g=a[1]*L,l=c[1]*L,m=Math.sin(f),f=Math.cos(f),t=Math.sin(g),g=Math.cos(g),n=Math.sin(l),l=Math.cos(l);return Math.atan2(Math.sqrt((e=l*m)*e+(e=g*n-t*l*f)*e),t*n+g*l*f)};m.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:c()}}function c(){return m.range(Math.ceil(l/B)*B,g,B).map(D).concat(m.range(Math.ceil(oa/
A)*A,q,A).map(v)).concat(m.range(Math.ceil(f/C)*C,e,C).filter(function(a){return Math.abs(a%B)>N}).map(F)).concat(m.range(Math.ceil(t/z)*z,n,z).filter(function(a){return Math.abs(a%A)>N}).map(S))}var e,f,g,l,n,t,q,oa,F,S,D,v,C=10,z=C,B=90,A=360,G=2.5;return a.lines=function(){return c().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[D(l).concat(v(q).slice(1),D(g).reverse().slice(1),v(oa).reverse().slice(1))]}},a.extent=function(c){return arguments.length?
a.majorExtent(c).minorExtent(c):a.minorExtent()},a.majorExtent=function(c){return arguments.length?(l=+c[0][0],g=+c[1][0],oa=+c[0][1],q=+c[1][1],l>g&&(c=l,l=g,g=c),oa>q&&(c=oa,oa=q,q=c),a.precision(G)):[[l,oa],[g,q]]},a.minorExtent=function(c){return arguments.length?(f=+c[0][0],e=+c[1][0],t=+c[0][1],n=+c[1][1],f>e&&(c=f,f=e,e=c),t>n&&(c=t,t=n,n=c),a.precision(G)):[[f,t],[e,n]]},a.step=function(c){return arguments.length?a.majorStep(c).minorStep(c):a.minorStep()},a.majorStep=function(c){return arguments.length?
(B=+c[0],A=+c[1],a):[B,A]},a.minorStep=function(c){return arguments.length?(C=+c[0],z=+c[1],a):[C,z]},a.precision=function(c){return arguments.length?(G=+c,F=Md(t,n,90),S=Nd(f,e,G),D=Md(oa,q,90),v=Nd(l,g,G),a):G},a.majorExtent([[-180,-90+N],[180,90-N]]).minorExtent([[-180,-80-N],[180,80+N]])};m.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[c||f.apply(this,arguments),e||g.apply(this,arguments)]}}var c,e,f=oc,g=pc;return a.distance=function(){return m.geo.distance(c||f.apply(this,
arguments),e||g.apply(this,arguments))},a.source=function(e){return arguments.length?(f=e,c="function"==typeof e?null:e,a):f},a.target=function(c){return arguments.length?(g=c,e="function"==typeof c?null:c,a):g},a.precision=function(){return arguments.length?a:0},a};m.geo.interpolate=function(a,c){return Hf(a[0]*L,a[1]*L,c[0]*L,c[1]*L)};m.geo.length=function(a){return Ob=0,m.geo.stream(a,Va),Ob};var Ob,Va={sphere:ea,point:ea,lineStart:function(){function a(d,g){var l=Math.sin(g*=L),t=Math.cos(g),
m=Math.abs((d*=L)-c),n=Math.cos(m);Ob+=Math.atan2(Math.sqrt((m=t*Math.sin(m))*m+(m=f*l-e*t*n)*m),e*l+f*t*n);c=d;e=l;f=t}var c,e,f;Va.point=function(g,l){c=g*L;e=Math.sin(l*=L);f=Math.cos(l);Va.point=a};Va.lineEnd=function(){Va.point=Va.lineEnd=ea}},lineEnd:ea,polygonStart:ea,polygonEnd:ea};(m.geo.conicEqualArea=function(){return qc(Od)}).raw=Od;m.geo.albersUsa=function(){function a(d){var c=d[0],e=d[1];return(50<e?l:-140>c?n:21>e?t:g)(d)}var c,e,f,g=m.geo.conicEqualArea().rotate([98,0]).center([0,
38]).parallels([29.5,45.5]),l=m.geo.conicEqualArea().rotate([160,0]).center([0,60]).parallels([55,65]),n=m.geo.conicEqualArea().rotate([160,0]).center([0,20]).parallels([8,18]),t=m.geo.conicEqualArea().rotate([60,0]).center([0,10]).parallels([8,18]);return a.invert=function(a){return c(a)||e(a)||f(a)||g.invert(a)},a.scale=function(c){return arguments.length?(g.scale(c),l.scale(0.6*c),n.scale(c),t.scale(1.5*c),a.translate(g.translate())):g.scale()},a.translate=function(m){if(!arguments.length)return g.translate();
var q=g.scale(),F=m[0],S=m[1];return g.translate(m),l.translate([F-0.4*q,S+0.17*q]),n.translate([F-0.19*q,S+0.2*q]),t.translate([F+0.58*q,S+0.43*q]),c=rc(l,[[-180,50],[-130,72]]),e=rc(n,[[-164,18],[-154,24]]),f=rc(t,[[-67.5,17.5],[-65,19]]),a},a.scale(1E3)};var Pb,vb,Ea={point:ea,lineStart:ea,lineEnd:ea,polygonStart:function(){vb=0;Ea.lineStart=If},polygonEnd:function(){Ea.lineStart=Ea.lineEnd=Ea.point=ea;Pb+=Math.abs(vb/2)}},ra={point:sc,lineStart:Qd,lineEnd:Rd,polygonStart:function(){ra.lineStart=
Kf},polygonEnd:function(){ra.point=sc;ra.lineStart=Qd;ra.lineEnd=Rd}};m.geo.path=function(){function a(d){return d&&m.geo.stream(d,f(g.pointRadius("function"==typeof l?+l.apply(this,arguments):l))),g.result()}var c,e,f,g,l=4.5;return a.area=function(a){return Pb=0,m.geo.stream(a,f(Ea)),Pb},a.centroid=function(a){return ga=ca=da=aa=0,m.geo.stream(a,f(ra)),aa?[ca/aa,da/aa]:void 0},a.bounds=function(a){return xd(f)(a)},a.projection=function(e){return arguments.length?(f=(c=e)?e.stream||Mf(e):ma,a):c},
a.context=function(c){return arguments.length?(g=null==(e=c)?new Jf:new Lf(c),a):e},a.pointRadius=function(c){return arguments.length?(l="function"==typeof c?c:+c,a):l},a.projection(m.geo.albersUsa()).context(null)};m.geo.albers=function(){return m.geo.conicEqualArea().parallels([29.5,45.5]).rotate([98,0]).center([0,38]).scale(1E3)};var $e=Za(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(m.geo.azimuthalEqualArea=function(){return Da($e)}).raw=$e;var af=Za(function(a){return(a=
Math.acos(a))&&a/Math.sin(a)},ma);(m.geo.azimuthalEquidistant=function(){return Da(af)}).raw=af;(m.geo.conicConformal=function(){return qc(Sd)}).raw=Sd;(m.geo.conicEquidistant=function(){return qc(Td)}).raw=Td;var bf=Za(function(a){return 1/a},Math.atan);(m.geo.gnomonic=function(){return Da(bf)}).raw=bf;wb.invert=function(a,c){return[a,2*Math.atan(Math.exp(c))-E/2]};(m.geo.mercator=function(){return Ud(wb)}).raw=wb;var cf=Za(function(){return 1},Math.asin);(m.geo.orthographic=function(){return Da(cf)}).raw=
cf;var df=Za(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(m.geo.stereographic=function(){return Da(df)}).raw=df;tc.invert=function(a,c){var e=Math.atan2((Math.exp(a)-Math.exp(-a))/2,Math.cos(c)),f;f=Math.sin(c)/((Math.exp(a)+Math.exp(-a))/2);f=1<f?E/2:-1>f?-E/2:Math.asin(f);return[e,f]};(m.geo.transverseMercator=function(){return Ud(tc)}).raw=tc;m.geom={};m.svg={};m.svg.line=function(){return Vd(ma)};var uc=m.map({linear:na,"linear-closed":function(a){return na(a)+"Z"},"step-before":vc,
"step-after":wc,basis:Wd,"basis-open":function(a){if(4>a.length)return na(a);for(var c,e=[],f=-1,g=a.length,l=[0],m=[0];3>++f;)c=a[f],l.push(c[0]),m.push(c[1]);e.push(ua(Sa,l)+","+ua(Sa,m));for(--f;++f<g;)c=a[f],l.shift(),l.push(c[0]),m.shift(),m.push(c[1]),$a(e,l,m);return e.join("")},"basis-closed":function(a){for(var c,e,f=-1,g=a.length,l=g+4,m=[],t=[];4>++f;)e=a[f%g],m.push(e[0]),t.push(e[1]);c=[ua(Sa,m),",",ua(Sa,t)];for(--f;++f<l;)e=a[f%g],m.shift(),m.push(e[0]),t.shift(),t.push(e[1]),$a(c,
m,t);return c.join("")},bundle:function(a,c){var e=a.length-1;if(e)for(var f,g,l=a[0][0],m=a[0][1],t=a[e][0]-l,n=a[e][1]-m,q=-1;++q<=e;)f=a[q],g=q/e,f[0]=c*f[0]+(1-c)*(l+g*t),f[1]=c*f[1]+(1-c)*(m+g*n);return Wd(a)},cardinal:function(a,c){return 3>a.length?na(a):a[0]+xb(a,xc(a,c))},"cardinal-open":function(a,c){return 4>a.length?na(a):a[1]+xb(a.slice(1,a.length-1),xc(a,c))},"cardinal-closed":function(a,c){return 3>a.length?na(a):a[0]+xb((a.push(a[0]),a),xc([a[a.length-2]].concat(a,[a[1]]),c))},monotone:function(a){if(3>
a.length)a=na(a);else{var c=a[0],e,f,g,l,m=[],t;e=0;t=a.length-1;for(var n=[],q=a[1],F=n[0]=yc(a[0],q);++e<t;)n[e]=(F+(F=yc(q,q=a[e+1])))/2;t=(n[e]=F,n);n=-1;for(q=a.length-1;++n<q;)e=yc(a[n],a[n+1]),1E-6>Math.abs(e)?t[n]=t[n+1]=0:(f=t[n]/e,g=t[n+1]/e,l=f*f+g*g,9<l&&(l=3*e/Math.sqrt(l),t[n]=l*f,t[n+1]=l*g));for(n=-1;++n<=q;)l=(a[Math.min(q,n+1)][0]-a[Math.max(0,n-1)][0])/(6*(1+t[n]*t[n])),m.push([l||0,t[n]*l||0]);a=c+xb(a,m)}return a}});uc.forEach(function(a,c){c.key=a;c.closed=/-closed$/.test(a)});
var Xd=[0,2/3,1/3,0],Yd=[0,1/3,2/3,0],Sa=[0,1/6,2/3,1/6];m.geom.hull=function(a){function c(a){if(3>a.length)return[];var d,g,l,s,m,n,q,D,v,C;D=T(e);v=T(f);C=a.length;var z=C-1,B=[],A=[],G=0;if(D===ta&&f===wa)d=a;else{l=0;for(d=[];C>l;++l)d.push([+D.call(this,g=a[l],l),+v.call(this,g,l)])}for(l=1;C>l;++l)d[l][1]<d[G][1]?G=l:d[l][1]==d[G][1]&&(G=d[l][0]<d[G][0]?l:G);for(l=0;C>l;++l)l!==G&&(m=d[l][1]-d[G][1],s=d[l][0]-d[G][0],B.push({angle:Math.atan2(m,s),index:l}));B.sort(function(a,d){return a.angle-
d.angle});C=B[0].angle;v=B[0].index;D=0;for(l=1;z>l;++l)g=B[l].index,C==B[l].angle?(s=d[v][0]-d[G][0],m=d[v][1]-d[G][1],n=d[g][0]-d[G][0],q=d[g][1]-d[G][1],s*s+m*m>=n*n+q*q?B[l].index=-1:(B[D].index=-1,C=B[l].angle,D=l,v=g)):(C=B[l].angle,D=l,v=g);A.push(G);for(g=l=0;2>l;++g)-1!==B[g].index&&(A.push(B[g].index),l++);for(s=A.length;z>g;++g)if(-1!==B[g].index){for(;!Nf(A[s-2],A[s-1],B[g].index,d);)--s;A[s++]=B[g].index}d=[];for(l=0;s>l;++l)d.push(a[A[l]]);return d}var e=ta,f=wa;return arguments.length?
c(a):(c.x=function(a){return arguments.length?(e=a,c):e},c.y=function(a){return arguments.length?(f=a,c):f},c)};m.geom.polygon=function(a){return a.area=function(){for(var c=0,e=a.length,f=a[e-1][1]*a[0][0]-a[e-1][0]*a[0][1];++c<e;)f+=a[c-1][1]*a[c][0]-a[c-1][0]*a[c][1];return 0.5*f},a.centroid=function(c){var e,f,g=-1,l=a.length,m=0,t=0,n=a[l-1];for(arguments.length||(c=-1/(6*a.area()));++g<l;)e=n,n=a[g],f=e[0]*n[1]-n[0]*e[1],m+=(e[0]+n[0])*f,t+=(e[1]+n[1])*f;return[m*c,t*c]},a.clip=function(c){for(var e,
f,g,l,m,t,n=-1,q=a.length,F=a[q-1];++n<q;){e=c.slice();c.length=0;l=a[n];m=e[(g=e.length)-1];for(f=-1;++f<g;)t=e[f],zc(t,F,l)?(zc(m,F,l)||c.push(Zd(m,t,F,l)),c.push(t)):zc(m,F,l)&&c.push(Zd(m,t,F,l)),m=t;F=l}return c},a};m.geom.delaunay=function(a){var c=a.map(function(){return[]}),e=[];return Ac(a,function(e){c[e.region.l.index].push(a[e.region.r.index])}),c.forEach(function(c,f){var g=a[f],l=g[0],s=g[1];c.forEach(function(a){a.angle=Math.atan2(a[0]-l,a[1]-s)});c.sort(function(a,d){return a.angle-
d.angle});for(var m=0,n=c.length-1;n>m;m++)e.push([g,c[m],c[m+1]])}),e};m.geom.voronoi=function(a){function c(a){var d,f,s,n=a.map(function(){return[]}),q=T(g),J=T(l),v=a.length;if(q===ta&&J===wa)d=a;else{d=[];for(s=0;v>s;++s)d.push([+q.call(this,f=a[s],s),+J.call(this,f,s)])}if(Ac(d,function(a){var d,c,e,f,g,l;1===a.a&&0<=a.b?(d=a.ep.r,c=a.ep.l):(d=a.ep.l,c=a.ep.r);1===a.a?(g=d?d.y:-1E6,e=a.c-a.b*g,l=c?c.y:1E6,f=a.c-a.b*l):(e=d?d.x:-1E6,g=a.c-a.a*e,f=c?c.x:1E6,l=a.c-a.a*f);d=[e,g];f=[f,l];n[a.region.l.index].push(d,
f);n[a.region.r.index].push(d,f)}),n=n.map(function(a,c){var e=d[c][0],f=d[c][1],g=a.map(function(a){return Math.atan2(a[0]-e,a[1]-f)}),l=m.range(a.length).sort(function(a,d){return g[a]-g[d]});return l.filter(function(a,d){return!d||g[a]-g[l[d-1]]>N}).map(function(d){return a[d]})}),n.forEach(function(a,c){var e=a.length;if(!e)return a.push([-1E6,-1E6],[-1E6,1E6],[1E6,1E6],[1E6,-1E6]);if(!(2<e)){var f=d[c],g=a[0],l=a[1],e=f[0],f=f[1],p=g[0],g=g[1],s=l[0],r=l[1],m=Math.abs(s-p),l=r-g;Math.abs(l)<
N?(e=g>f?-1E6:1E6,a.push([-1E6,e],[1E6,e])):N>m?(e=p>e?-1E6:1E6,a.push([e,-1E6],[e,1E6])):(e=(p-e)*(r-g)>(s-p)*(g-f)?1E6:-1E6,f=Math.abs(l)-m,Math.abs(f)<N?a.push([0>l?e:-e,e]):(0<f&&(e*=-1),a.push([-1E6,e],[1E6,e])))}}),e)for(s=0;v>s;++s)e(n[s]);for(s=0;v>s;++s)n[s].point=a[s];return n}var e,f=null,g=ta,l=wa;return arguments.length?c(a):(c.x=function(a){return arguments.length?(g=a,c):g},c.y=function(a){return arguments.length?(l=a,c):l},c.size=function(a){return arguments.length?(null==a?e=null:
(f=[+a[0],+a[1]],e=m.geom.polygon([[0,0],[0,f[1]],f,[f[0],0]]).clip),c):f},c.links=function(a){var d,c,e,f=a.map(function(){return[]}),s=[],r=T(g),m=T(l),n=a.length;if(r===ta&&m===wa)d=a;else for(e=0;n>e;++e)d.push([+r.call(this,c=a[e],e),+m.call(this,c,e)]);return Ac(d,function(d){var c=d.region.l.index;d=d.region.r.index;f[c][d]||(f[c][d]=f[d][c]=!0,s.push({source:a[c],target:a[d]}))}),s},c.triangles=function(a){if(g===ta&&l===wa)return m.geom.delaunay(a);var d,c,e,f,s,r=T(g),n=T(l);f=0;d=[];for(s=
a.length;s>f;++f)c=[+r.call(this,e=a[f],f),+n.call(this,e,f)],c.data=e,d.push(c);return m.geom.delaunay(d).map(function(a){return a.map(function(a){return a.data})})},c)};var Bc={l:"r",r:"l"};m.geom.quadtree=function(a,c,e,f,g){function l(a){function d(a,c,e,f,g,l,p,s){if(!isNaN(e)&&!isNaN(f))if(a.leaf){var r=a.x,m=a.y;if(null!=r){if(!(0.01>Math.abs(r-e)+Math.abs(m-f))){var t=a.point;a.x=a.y=a.point=null;u(a,t,r,m,g,l,p,s)}u(a,c,e,f,g,l,p,s)}else a.x=e,a.y=f,a.point=c}else u(a,c,e,f,g,l,p,s)}function u(a,
c,e,f,g,l,p,s){var r=0.5*(g+p),m=0.5*(l+s),t=e>=r,n=f>=m,q=(n<<1)+t;a.leaf=!1;a=a.nodes[q]||(a.nodes[q]=$d());t?g=r:p=r;n?l=m:s=m;d(a,c,e,f,g,l,p,s)}var q,v,C,z,B,A,G,Q,x,y=T(t),Z=T(n);if(null!=c)A=c,G=e,Q=f,x=g;else if(Q=x=-(A=G=1/0),v=[],C=[],B=a.length,m)for(z=0;B>z;++z)q=a[z],q.x<A&&(A=q.x),q.y<G&&(G=q.y),q.x>Q&&(Q=q.x),q.y>x&&(x=q.y),v.push(q.x),C.push(q.y);else for(z=0;B>z;++z){var ba=+y(q=a[z],z);q=+Z(q,z);A>ba&&(A=ba);G>q&&(G=q);ba>Q&&(Q=ba);q>x&&(x=q);v.push(ba);C.push(q)}ba=Q-A;q=x-G;ba>
q?x=G+ba:Q=A+q;var E=$d();if(E.add=function(a){d(E,a,+y(a,++z),+Z(a,z),A,G,Q,x)},E.visit=function(a){ab(a,E,A,G,Q,x)},z=-1,null==c){for(;++z<B;)d(E,a[z],v[z],C[z],A,G,Q,x);--z}else a.forEach(E.add);return v=C=a=q=null,E}var m,t=ta,n=wa;return(m=arguments.length)?(t=Of,n=Pf,3===m&&(g=e,f=c,e=c=0),l(a)):(l.x=function(a){return arguments.length?(t=a,l):t},l.y=function(a){return arguments.length?(n=a,l):n},l.size=function(a){return arguments.length?(null==a?c=e=f=g=null:(c=e=0,f=+a[0],g=+a[1]),l):null==
c?null:[f,g]},l)};m.interpolateRgb=Cc;m.transform=function(a){var c=ka.createElementNS(m.ns.prefix.svg,"g");return(m.transform=function(a){c.setAttribute("transform",a);a=c.transform.baseVal.consolidate();return new ae(a?a.matrix:Zg)})(a)};ae.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Zg={a:1,b:0,c:0,d:1,e:0,f:0};m.interpolateNumber=xa;m.interpolateTransform=yb;m.interpolateObject=ce;m.interpolateString=
de;var zb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;m.interpolate=Ha;m.interpolators=[function(a,c){var e=typeof c;return("string"===e||e!==typeof a?jb.has(c)||/^(#|rgb\(|hsl\()/.test(c)?Cc:de:c instanceof Ma?Cc:"object"===e?Array.isArray(c)?ee:ce:xa)(a,c)}];m.interpolateArray=ee;var ef=function(){return ma},$g=m.map({linear:ef,poly:function(a){return function(c){return Math.pow(c,a)}},quad:function(){return Rf},cubic:function(){return Sf},sin:function(){return Tf},exp:function(){return Uf},circle:function(){return Vf},
elastic:function(a,c){var e;return 2>arguments.length&&(c=0.45),arguments.length?e=c/(2*E)*Math.asin(1/a):(a=1,e=c/4),function(f){return 1+a*Math.pow(2,10*-f)*Math.sin(2*(f-e)*E/c)}},back:function(a){return a||(a=1.70158),function(c){return c*c*((a+1)*c-a)}},bounce:function(){return Wf}}),ah=m.map({"in":ma,out:fe,"in-out":ge,"out-in":function(a){return ge(fe(a))}});m.ease=function(a){var c=a.indexOf("-"),e=0<=c?a.substring(0,c):a,c=0<=c?a.substring(c+1):"in";return e=$g.get(e)||ef,c=ah.get(c)||ma,
Qf(c(e.apply(null,Array.prototype.slice.call(arguments,1))))};m.interpolateHcl=function(a,c){a=m.hcl(a);c=m.hcl(c);var e=a.h,f=a.c,g=a.l,l=c.h-e,n=c.c-f,t=c.l-g;return 180<l?l-=360:-180>l&&(l+=360),function(a){return Wb(e+l*a,f+n*a,g+t*a)+""}};m.interpolateHsl=function(a,c){a=m.hsl(a);c=m.hsl(c);var e=a.h,f=a.s,g=a.l,l=c.h-e,n=c.s-f,t=c.l-g;return 180<l?l-=360:-180>l&&(l+=360),function(a){return gb(e+l*a,f+n*a,g+t*a)+""}};m.interpolateLab=function(a,c){a=m.lab(a);c=m.lab(c);var e=a.l,f=a.a,g=a.b,
l=c.l-e,n=c.a-f,t=c.b-g;return function(a){return md(e+l*a,f+n*a,g+t*a)+""}};m.interpolateRound=he;m.layout={};m.layout.bundle=function(){return function(a){for(var c=[],e=-1,f=a.length;++e<f;)c.push(Zf(a[e]));return c}};m.layout.chord=function(){function a(){var d,v,x,C,z,B={},A=[],G=m.range(l),Q=[];e=[];f=[];d=0;for(C=-1;++C<l;){v=0;for(z=-1;++z<l;)v+=g[C][z];A.push(v);Q.push(m.range(l));d+=v}n&&G.sort(function(a,d){return n(A[a],A[d])});t&&Q.forEach(function(a,d){a.sort(function(a,c){return t(g[d][a],
g[d][c])})});d=(2*E-F*l)/d;v=0;for(C=-1;++C<l;){x=v;for(z=-1;++z<l;){var y=G[C],oa=Q[y][z],Z=g[y][oa],ba=v,H=v+=Z*d;B[y+"-"+oa]={index:y,subindex:oa,startAngle:ba,endAngle:H,value:Z}}f[y]={index:y,startAngle:x,endAngle:v,value:(v-x)/d};v+=F}for(C=-1;++C<l;)for(z=C-1;++z<l;)d=B[C+"-"+z],v=B[z+"-"+C],(d.value||v.value)&&e.push(d.value<v.value?{source:v,target:d}:{source:d,target:v});q&&c()}function c(){e.sort(function(a,d){return q((a.source.value+a.target.value)/2,(d.source.value+d.target.value)/2)})}
var e,f,g,l,n,t,q,v={},F=0;return v.matrix=function(a){return arguments.length?(l=(g=a)&&g.length,e=f=null,v):g},v.padding=function(a){return arguments.length?(F=a,e=f=null,v):F},v.sortGroups=function(a){return arguments.length?(n=a,e=f=null,v):n},v.sortSubgroups=function(a){return arguments.length?(t=a,e=null,v):t},v.sortChords=function(a){return arguments.length?(q=a,e&&c(),v):q},v.chords=function(){return e||a(),e},v.groups=function(){return f||a(),f},v};m.layout.force=function(){function a(d){return function(a,
c,e,f){if(a.point!==d){e=a.cx-d.x;var g=a.cy-d.y,l=1/Math.sqrt(e*e+g*g);if(z>(f-c)*l)return c=a.charge*l*l,d.px-=e*c,d.py-=g*c,!0;a.point&&isFinite(l)&&(c=a.pointCharge*l*l,d.px-=e*c,d.py-=g*c)}return!a.charge}}function c(a){a.px=m.event.x;a.py=m.event.y;t.resume()}var e,f,g,l,n,t={},q=m.dispatch("start","tick","end"),v=[1,1],F=0.9,x=bh,D=ch,y=-30,C=0.1,z=0.8,B=[],A=[];return t.tick=function(){if(0.005>(f*=0.99))return q.end({type:"end",alpha:f=0}),!0;var c,e,r,s,t,z,x,D,S=B.length,E=A.length;for(e=
0;E>e;++e)r=A[e],c=r.source,s=r.target,x=s.x-c.x,D=s.y-c.y,(t=x*x+D*D)&&(t=f*l[e]*((t=Math.sqrt(t))-g[e])/t,x*=t,D*=t,s.x-=x*(z=c.weight/(s.weight+c.weight)),s.y-=D*z,c.x+=x*(z=1-z),c.y+=D*z);if((z=f*C)&&(x=v[0]/2,D=v[1]/2,e=-1,z))for(;++e<S;)r=B[e],r.x+=(x-r.x)*z,r.y+=(D-r.y)*z;if(y){je(c=m.geom.quadtree(B),f,n);for(e=-1;++e<S;)(r=B[e]).fixed||c.visit(a(r))}for(e=-1;++e<S;)r=B[e],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*F,r.y-=(r.py-(r.py=r.y))*F);q.tick({type:"tick",alpha:f})},t.nodes=
function(a){return arguments.length?(B=a,t):B},t.links=function(a){return arguments.length?(A=a,t):A},t.size=function(a){return arguments.length?(v=a,t):v},t.linkDistance=function(a){return arguments.length?(x="function"==typeof a?a:+a,t):x},t.distance=t.linkDistance,t.linkStrength=function(a){return arguments.length?(D="function"==typeof a?a:+a,t):D},t.friction=function(a){return arguments.length?(F=+a,t):F},t.charge=function(a){return arguments.length?(y="function"==typeof a?a:+a,t):y},t.gravity=
function(a){return arguments.length?(C=+a,t):C},t.theta=function(a){return arguments.length?(z=+a,t):z},t.alpha=function(a){return arguments.length?(a=+a,f?f=0<a?a:0:0<a&&(q.start({type:"start",alpha:f=a}),m.timer(t.tick)),t):f},t.start=function(){function a(f,g){var l,p;if(!e){e=[];for(c=0;r>c;++c)e[c]=[];for(c=0;s>c;++c)l=A[c],e[l.source.index].push(l.target),e[l.target.index].push(l.source)}p=e[d];for(var t=-1,m=p.length;++t<m;)if(!isNaN(l=p[t][f]))return l;return Math.random()*g}var d,c,e,f,r=
B.length,s=A.length,m=v[0],q=v[1];for(d=0;r>d;++d)(f=B[d]).index=d,f.weight=0;for(d=0;s>d;++d)f=A[d],"number"==typeof f.source&&(f.source=B[f.source]),"number"==typeof f.target&&(f.target=B[f.target]),++f.source.weight,++f.target.weight;for(d=0;r>d;++d)f=B[d],isNaN(f.x)&&(f.x=a("x",m)),isNaN(f.y)&&(f.y=a("y",q)),isNaN(f.px)&&(f.px=f.x),isNaN(f.py)&&(f.py=f.y);if(g=[],"function"==typeof x)for(d=0;s>d;++d)g[d]=+x.call(this,A[d],d);else for(d=0;s>d;++d)g[d]=x;if(l=[],"function"==typeof D)for(d=0;s>d;++d)l[d]=
+D.call(this,A[d],d);else for(d=0;s>d;++d)l[d]=D;if(n=[],"function"==typeof y)for(d=0;r>d;++d)n[d]=+y.call(this,B[d],d);else for(d=0;r>d;++d)n[d]=y;return t.resume()},t.resume=function(){return t.alpha(0.1)},t.stop=function(){return t.alpha(0)},t.drag=function(){return e||(e=m.behavior.drag().origin(ma).on("dragstart.force",$f).on("drag.force",c).on("dragend.force",ag)),arguments.length?(this.on("mouseover.force",bg).on("mouseout.force",cg).call(e),void 0):e},m.rebind(t,q,"on")};var bh=20,ch=1;m.layout.hierarchy=
function(){function a(c,s,m){var n=g.call(e,c,s);if(c.depth=s,m.push(c),n&&(q=n.length)){for(var q,v=-1,x=c.children=[],y=0,C=s+1;++v<q;)s=a(n[v],C,m),s.parent=c,x.push(s),y+=s.value;f&&x.sort(f);l&&(c.value=y)}else l&&(c.value=+l.call(e,c,s)||0);return c}function c(a,d){var f=a.children,g=0;if(f&&(p=f.length))for(var p,m=-1,n=d+1;++m<p;)g+=c(f[m],n);else l&&(g=+l.call(e,a,d)||0);return l&&(a.value=g),g}function e(c){var f=[];return a(c,0,f),f}var f=gg,g=eg,l=fg;return e.sort=function(a){return arguments.length?
(f=a,e):f},e.children=function(a){return arguments.length?(g=a,e):g},e.value=function(a){return arguments.length?(l=a,e):l},e.revalue=function(a){return c(a,0),a},e};m.layout.partition=function(){function a(c,e,f,g){var l=c.children;if(c.x=e,c.y=c.depth*g,c.dx=f,c.dy=g,l&&(p=l.length)){var p,r,s=-1;for(f=c.value?f/c.value:0;++s<p;)a(r=l[s],e,c=r.value*f,g),e+=c}}function c(a){a=a.children;var d=0;if(a&&(e=a.length))for(var e,f=-1;++f<e;)d=Math.max(d,c(a[f]));return 1+d}function e(l,r){var m=f.call(this,
l,r);return a(m[0],0,g[0],g[1]/c(m[0])),m}var f=m.layout.hierarchy(),g=[1,1];return e.size=function(a){return arguments.length?(g=a,e):g},bb(e,f)};m.layout.pie=function(){function a(l){var n=l.map(function(e,f){return+c.call(a,e,f)}),t=+("function"==typeof f?f.apply(this,arguments):f),q=(("function"==typeof g?g.apply(this,arguments):g)-t)/m.sum(n),v=m.range(l.length);null!=e&&v.sort(e===ff?function(a,d){return n[d]-n[a]}:function(a,d){return e(l[a],l[d])});var x=[];return v.forEach(function(a){var d;
x[a]={data:l[a],value:d=n[a],startAngle:t,endAngle:t+=d*q}}),x}var c=Number,e=ff,f=0,g=2*E;return a.value=function(e){return arguments.length?(c=e,a):c},a.sort=function(c){return arguments.length?(e=c,a):e},a.startAngle=function(c){return arguments.length?(f=c,a):f},a.endAngle=function(c){return arguments.length?(g=c,a):g},a};var ff={};m.layout.stack=function(){function a(t,q){var v=t.map(function(e,f){return c.call(a,e,f)}),x=v.map(function(c){return c.map(function(c,e){return[l.call(a,c,e),n.call(a,
c,e)]})}),y=e.call(a,x,q),v=m.permute(v,y),x=m.permute(x,y),D,I,C=f.call(a,x,q),z=v.length,B=v[0].length;for(D=0;B>D;++D){g.call(a,v[0][D],I=C[D],x[0][D][1]);for(y=1;z>y;++y)g.call(a,v[y][D],I+=x[y-1][D][1],x[y][D][1])}return t}var c=ma,e=Dc,f=Ec,g=jg,l=hg,n=ig;return a.values=function(e){return arguments.length?(c=e,a):c},a.order=function(c){return arguments.length?(e="function"==typeof c?c:dh.get(c)||Dc,a):e},a.offset=function(c){return arguments.length?(f="function"==typeof c?c:eh.get(c)||Ec,a):
f},a.x=function(c){return arguments.length?(l=c,a):l},a.y=function(c){return arguments.length?(n=c,a):n},a.out=function(c){return arguments.length?(g=c,a):g},a};var dh=m.map({"inside-out":function(a){var c,e=a.length,f=a.map(kg),g=a.map(lg),l=m.range(e).sort(function(a,d){return f[a]-f[d]}),n=0,t=0,q=[],v=[];for(a=0;e>a;++a)c=l[a],t>n?(n+=g[c],q.push(c)):(t+=g[c],v.push(c));return v.reverse().concat(q)},reverse:function(a){return m.range(a.length).reverse()},"default":Dc}),eh=m.map({silhouette:function(a){var c,
e,f,g=a.length,l=a[0].length,m=[],n=0,q=[];for(e=0;l>e;++e){for(f=c=0;g>c;c++)f+=a[c][e][1];f>n&&(n=f);m.push(f)}for(e=0;l>e;++e)q[e]=(n-m[e])/2;return q},wiggle:function(a){var c,e,f,g,l,m,n,q,v,x=a.length,y=a[0],D=y.length,I=[];I[0]=q=v=0;for(e=1;D>e;++e){for(g=c=0;x>c;++c)g+=a[c][e][1];l=c=0;for(n=y[e][0]-y[e-1][0];x>c;++c){f=0;for(m=(a[c][e][1]-a[c][e-1][1])/(2*n);c>f;++f)m+=(a[f][e][1]-a[f][e-1][1])/n;l+=m*a[c][e][1]}I[e]=q-=g?l/g*n:0;v>q&&(v=q)}for(e=0;D>e;++e)I[e]-=v;return I},expand:function(a){var c,
e,f,g=a.length,l=a[0].length,m=1/g,n=[];for(e=0;l>e;++e){for(f=c=0;g>c;c++)f+=a[c][e][1];if(f)for(c=0;g>c;c++)a[c][e][1]/=f;else for(c=0;g>c;c++)a[c][e][1]=m}for(e=0;l>e;++e)n[e]=0;return n},zero:Ec});m.layout.histogram=function(){function a(d,l){var n,q,v=[],x=d.map(e,this),y=f.call(this,x,l),D=g.call(this,y,x,l);l=-1;for(var I=x.length,C=D.length-1,z=c?1:1/I;++l<C;)n=v[l]=[],n.dx=D[l+1]-(n.x=D[l]),n.y=0;if(0<C)for(l=-1;++l<I;)q=x[l],q>=y[0]&&q<=y[1]&&(n=v[m.bisect(D,q,1,C)-1],n.y+=z,n.push(d[l]));
return v}var c=!0,e=Number,f=og,g=ng;return a.value=function(c){return arguments.length?(e=c,a):e},a.range=function(c){return arguments.length?(f=T(c),a):f},a.bins=function(c){return arguments.length?(g="number"==typeof c?function(a){return ke(a,c)}:T(c),a):g},a.frequency=function(e){return arguments.length?(c=!!e,a):c},a};m.layout.tree=function(){function a(d,g){function l(a,d){var c=a.children,f=a._tree;if(c&&(g=c.length)){for(var g,p,s,m=c[0],n=m,q=-1;++q<g;){s=c[q];l(s,p);var t=s;if(p){for(var u=
void 0,v=t,x=t,z=t.parent.children[0],C=v._tree.mod,y=x._tree.mod,J=p._tree.mod,D=z._tree.mod;p=Gc(p),v=Fc(v),p&&v;){z=Fc(z);x=Gc(x);x._tree.ancestor=t;u=p._tree.prelim+J-v._tree.prelim-C+e(p,v);if(0<u){var F=p._tree.ancestor.parent==t.parent?p._tree.ancestor:n,P=t,I=u,F=F._tree,P=P._tree,S=I/(P.number-F.number);F.change+=S;P.change-=S;P.shift+=I;P.prelim+=I;P.mod+=I;C+=u;y+=u}J+=p._tree.mod;C+=v._tree.mod;D+=z._tree.mod;y+=x._tree.mod}p&&!Gc(x)&&(x._tree.thread=p,x._tree.mod+=J-y);v&&!Fc(z)&&(z._tree.thread=
v,z._tree.mod+=C-D,n=t)}p=s}q=g=0;t=a.children;for(n=t.length;0<=--n;)c=t[n]._tree,c.prelim+=g,c.mod+=g,g+=c.shift+(q+=c.change);s=0.5*(m._tree.prelim+s._tree.prelim);d?(f.prelim=d._tree.prelim+e(a,d),f.mod=f.prelim-s):f.prelim=s}else d&&(f.prelim=d._tree.prelim+e(a,d))}function m(a,d){a.x=a._tree.prelim+d;var c=a.children;if(c&&(e=c.length)){var e,f=-1;for(d+=a._tree.mod;++f<e;)m(c[f],d)}}var n=c.call(this,d,g),q=n[0];ya(q,function(a,d){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:d?
d._tree.number+1:0}});l(q);m(q,-q._tree.prelim);var v=Ab(q,qg),x=Ab(q,pg),y=Ab(q,rg),I=v.x-e(v,x)/2,C=x.x+e(x,v)/2,z=y.depth||1;return ya(q,function(a){a.x=(a.x-I)/(C-I)*f[0];a.y=a.depth/z*f[1];delete a._tree}),n}var c=m.layout.hierarchy().sort(null).value(null),e=le,f=[1,1];return a.separation=function(c){return arguments.length?(e=c,a):e},a.size=function(c){return arguments.length?(f=c,a):f},bb(a,c)};m.layout.pack=function(){function a(d,g){var l=c.call(this,d,g),m=l[0];m.x=0;m.y=0;ya(m,function(a){a.r=
Math.sqrt(a.value)});ya(m,oe);var n=f[0],q=f[1],v=Math.max(2*m.r/n,2*m.r/q);if(0<e){var x=e*v/2;ya(m,function(a){a.r+=x});ya(m,oe);ya(m,function(a){a.r-=x});v=Math.max(2*m.r/n,2*m.r/q)}return qe(m,n/2,q/2,1/v),l}var c=m.layout.hierarchy().sort(sg),e=0,f=[1,1];return a.size=function(c){return arguments.length?(f=c,a):f},a.padding=function(c){return arguments.length?(e=+c,a):e},bb(a,c)};m.layout.cluster=function(){function a(d,g){var l,m=c.call(this,d,g),n=m[0],q=0;ya(n,function(a){var d=a.children;
d&&d.length?(a.x=wg(d),a.y=vg(d)):(a.x=l?q+=e(a,l):0,a.y=0,l=a)});var v=re(n),x=se(n),y=v.x-e(v,x)/2,I=x.x+e(x,v)/2;return ya(n,function(a){a.x=(a.x-y)/(I-y)*f[0];a.y=(1-(n.y?a.y/n.y:1))*f[1]}),m}var c=m.layout.hierarchy().sort(null).value(null),e=le,f=[1,1];return a.separation=function(c){return arguments.length?(e=c,a):e},a.size=function(c){return arguments.length?(f=c,a):f},bb(a,c)};m.layout.treemap=function(){function a(d,c){for(var e,f,g=-1,l=d.length;++g<l;)f=(e=d[g]).value*(0>c?0:c),e.area=
isNaN(f)||0>=f?0:f}function c(e){var g=e.children;if(g&&g.length){var l,p,m=y(e),r=[],n=g.slice(),q=1/0,t="slice"===D?m.dx:"dice"===D?m.dy:"slice-dice"===D?e.depth&1?m.dy:m.dx:Math.min(m.dx,m.dy);a(n,m.dx*m.dy/e.value);for(r.area=0;0<(e=n.length);){r.push(l=n[e-1]);r.area+=l.area;var u;if(!(u="squarify"!==D)){e=t;p=void 0;var v=r.area;u=0;for(var x=1/0,P=-1,U=r.length;++P<U;)(p=r[P].area)&&(x>p&&(x=p),p>u&&(u=p));u=(p=(v*=v,e*=e,v?Math.max(e*u*I/v,v/(e*x*I)):1/0))<=q}u?(n.pop(),q=p):(r.area-=r.pop().area,
f(r,t,m,!1),t=Math.min(m.dx,m.dy),r.length=r.area=0,q=1/0)}r.length&&(f(r,t,m,!0),r.length=r.area=0);g.forEach(c)}}function e(c){var g=c.children;if(g&&g.length){var l=y(c),p=g.slice(),s=[];a(p,l.dx*l.dy/c.value);for(s.area=0;c=p.pop();)s.push(c),s.area+=c.area,null!=c.z&&(f(s,c.z?l.dx:l.dy,l,!p.length),s.length=s.area=0);g.forEach(e)}}function f(a,d,c,e){var g,l=-1,p=a.length,s=c.x,m=c.y,r=d?q(a.area/d):0;if(d==c.dx){for((e||r>c.dy)&&(r=c.dy);++l<p;)g=a[l],g.x=s,g.y=m,g.dy=r,s+=g.dx=Math.min(c.x+
c.dx-s,r?q(g.area/r):0);g.z=!0;g.dx+=c.x+c.dx-s;c.y+=r;c.dy-=r}else{for((e||r>c.dx)&&(r=c.dx);++l<p;)g=a[l],g.x=s,g.y=m,g.dx=r,m+=g.dy=Math.min(c.y+c.dy-m,r?q(g.area/r):0);g.z=!1;g.dy+=c.y+c.dy-m;c.x+=r;c.dx-=r}}function g(f){f=l||n(f);var p=f[0];return p.x=0,p.y=0,p.dx=v[0],p.dy=v[1],l&&n.revalue(p),a([p],p.dx*p.dy/p.value),(l?e:c)(p),S&&(l=f),f}var l,n=m.layout.hierarchy(),q=Math.round,v=[1,1],x=null,y=Ic,S=!1,D="squarify",I=0.5*(1+Math.sqrt(5));return g.size=function(a){return arguments.length?
(v=a,g):v},g.padding=function(a){function d(c){var e=a.call(g,c,c.depth);return null==e?Ic(c):te(c,"number"==typeof e?[e,e,e,e]:e)}function c(d){return te(d,a)}if(!arguments.length)return x;var e;return y=null==(x=a)?Ic:"function"==(e=typeof a)?d:"number"===e?(a=[a,a,a,a],c):c,g},g.round=function(a){return arguments.length?(q=a?Math.round:Number,g):q!=Number},g.sticky=function(a){return arguments.length?(S=a,l=null,g):S},g.ratio=function(a){return arguments.length?(I=a,g):I},g.mode=function(a){return arguments.length?
(D=a+"",g):D},bb(g,n)};m.random={normal:function(a,c){var e=arguments.length;return 2>e&&(c=1),1>e&&(a=0),function(){var e,f;do e=2*Math.random()-1,f=2*Math.random()-1,f=e*e+f*f;while(!f||1<f);return a+c*e*Math.sqrt(-2*Math.log(f)/f)}},logNormal:function(){var a=m.random.normal.apply(m,arguments);return function(){return Math.exp(a())}},irwinHall:function(a){return function(){for(var c=0,e=0;a>e;e++)c+=Math.random();return c/a}}};m.scale={};m.scale.linear=function(){return ue([0,1],[0,1],Ha,!1)};
m.scale.log=function(){return ze(m.scale.linear().domain([0,Math.LN10]),10,Ae,Be)};var Bg=m.format(".0e");m.scale.pow=function(){return Ce(m.scale.linear(),1)};m.scale.sqrt=function(){return m.scale.pow().exponent(0.5)};m.scale.ordinal=function(){return De([],{t:"range",a:[[]]})};m.scale.category10=function(){return m.scale.ordinal().range(fh)};m.scale.category20=function(){return m.scale.ordinal().range(gh)};m.scale.category20b=function(){return m.scale.ordinal().range(hh)};m.scale.category20c=function(){return m.scale.ordinal().range(ih)};
var fh="#1f77b4 #ff7f0e #2ca02c #d62728 #9467bd #8c564b #e377c2 #7f7f7f #bcbd22 #17becf".split(" "),gh="#1f77b4 #aec7e8 #ff7f0e #ffbb78 #2ca02c #98df8a #d62728 #ff9896 #9467bd #c5b0d5 #8c564b #c49c94 #e377c2 #f7b6d2 #7f7f7f #c7c7c7 #bcbd22 #dbdb8d #17becf #9edae5".split(" "),hh="#393b79 #5254a3 #6b6ecf #9c9ede #637939 #8ca252 #b5cf6b #cedb9c #8c6d31 #bd9e39 #e7ba52 #e7cb94 #843c39 #ad494a #d6616b #e7969c #7b4173 #a55194 #ce6dbd #de9ed6".split(" "),ih="#3182bd #6baed6 #9ecae1 #c6dbef #e6550d #fd8d3c #fdae6b #fdd0a2 #31a354 #74c476 #a1d99b #c7e9c0 #756bb1 #9e9ac8 #bcbddc #dadaeb #636363 #969696 #bdbdbd #d9d9d9".split(" ");
m.scale.quantile=function(){return Ee([],[])};m.scale.quantize=function(){return Fe(0,1,[0,1])};m.scale.threshold=function(){return Ge([0.5],[0,1])};m.scale.identity=function(){return He([0,1])};m.svg.arc=function(){function a(){var d=c.apply(this,arguments),l=e.apply(this,arguments),m=f.apply(this,arguments)+Ia,n=g.apply(this,arguments)+Ia,q=(m>n&&(q=m,m=n,n=q),n-m),v=E>q?"0":"1",x=Math.cos(m),m=Math.sin(m),y=Math.cos(n),n=Math.sin(n);return q>=jh?d?"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+
" 0 1,1 0,"+l+"M0,"+d+"A"+d+","+d+" 0 1,0 0,"+-d+"A"+d+","+d+" 0 1,0 0,"+d+"Z":"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+" 0 1,1 0,"+l+"Z":d?"M"+l*x+","+l*m+"A"+l+","+l+" 0 "+v+",1 "+l*y+","+l*n+"L"+d*y+","+d*n+"A"+d+","+d+" 0 "+v+",0 "+d*x+","+d*m+"Z":"M"+l*x+","+l*m+"A"+l+","+l+" 0 "+v+",1 "+l*y+","+l*n+"L0,0Z"}var c=Cg,e=Dg,f=Ie,g=Je;return a.innerRadius=function(e){return arguments.length?(c=T(e),a):c},a.outerRadius=function(c){return arguments.length?(e=T(c),a):e},a.startAngle=function(c){return arguments.length?
(f=T(c),a):f},a.endAngle=function(c){return arguments.length?(g=T(c),a):g},a.centroid=function(){var a=(c.apply(this,arguments)+e.apply(this,arguments))/2,d=(f.apply(this,arguments)+g.apply(this,arguments))/2+Ia;return[Math.cos(d)*a,Math.sin(d)*a]},a};var Ia=-E/2,jh=2*E-1E-6;m.svg.line.radial=function(){var a=Vd(Ke);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};vc.reverse=wc;wc.reverse=vc;m.svg.area=function(){return Le(ma)};m.svg.area.radial=function(){var a=Le(Ke);return a.radius=a.x,
delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};m.svg.chord=function(){function a(d,g){var l=c(this,e,d,g),p=c(this,f,d,g);return"M"+l.p0+("A"+l.r+","+l.r+" 0 "+ +(l.a1-l.a0>E)+",1 "+l.p1)+(l.a0==p.a0&&l.a1==p.a1?"Q 0,0 "+l.p0:"Q 0,0 "+p.p0+("A"+p.r+","+p.r+" 0 "+ +(p.a1-p.a0>E)+",1 "+p.p1)+("Q 0,0 "+l.p0))+"Z"}function c(a,d,e,f){var s=d.call(a,e,f);d=g.call(a,s,f);e=l.call(a,s,f)+Ia;a=m.call(a,
s,f)+Ia;return{r:d,a0:e,a1:a,p0:[d*Math.cos(e),d*Math.sin(e)],p1:[d*Math.cos(a),d*Math.sin(a)]}}var e=oc,f=pc,g=Eg,l=Ie,m=Je;return a.radius=function(c){return arguments.length?(g=T(c),a):g},a.source=function(c){return arguments.length?(e=T(c),a):e},a.target=function(c){return arguments.length?(f=T(c),a):f},a.startAngle=function(c){return arguments.length?(l=T(c),a):l},a.endAngle=function(c){return arguments.length?(m=T(c),a):m},a};m.svg.diagonal=function(){function a(d,g){var l=c.call(this,d,g),
m=e.call(this,d,g),n=(l.y+m.y)/2,l=[l,{x:l.x,y:n},{x:m.x,y:n},m];return l=l.map(f),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var c=oc,e=pc,f=Me;return a.source=function(e){return arguments.length?(c=T(e),a):c},a.target=function(c){return arguments.length?(e=T(c),a):e},a.projection=function(c){return arguments.length?(f=c,a):f},a};m.svg.diagonal.radial=function(){var a=m.svg.diagonal(),c=Me,e=a.projection;return a.projection=function(a){return arguments.length?e(Fg(c=a)):c},a};m.svg.symbol=function(){function a(d,
f){return(gf.get(c.call(this,d,f))||Ne)(e.call(this,d,f))}var c=Hg,e=Gg;return a.type=function(e){return arguments.length?(c=T(e),a):c},a.size=function(c){return arguments.length?(e=T(c),a):e},a};var gf=m.map({circle:Ne,cross:function(a){a=Math.sqrt(a/5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*hf));var c=a*hf;return"M0,"+-a+"L"+c+",0 0,"+a+" "+-c+",0Z"},square:function(a){a=Math.sqrt(a)/2;return"M"+
-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/Qb);var c=a*Qb/2;return"M0,"+c+"L"+a+","+-c+" "+-a+","+-c+"Z"},"triangle-up":function(a){a=Math.sqrt(a/Qb);var c=a*Qb/2;return"M0,"+-c+"L"+a+","+c+" "+-a+","+c+"Z"}});m.svg.symbolTypes=gf.keys();var fb,Qb=Math.sqrt(3),hf=Math.tan(30*L),fa=[],Xe=0,Jb={ease:function(a){if(0>=a)return 0;if(1<=a)return 1;var c=a*a,e=c*a;return 4*(0.5>a?e:3*(a-c)+e-0.75)},delay:0,duration:250};fa.call=W.call;fa.empty=W.empty;
fa.node=W.node;m.transition=function(a){return arguments.length?fb?a.transition():a:eb.transition()};m.transition.prototype=fa;fa.select=function(a){var c,e,f,g=this.id,l=[];"function"!=typeof a&&(a=O(a));for(var m=-1,n=this.length;++m<n;){l.push(c=[]);for(var q=this[m],v=-1,x=q.length;++v<x;)(f=q[v])&&(e=a.call(f,f.__data__,v))?("__data__"in f&&(e.__data__=f.__data__),Eb(e,v,g,f.__transition__[g]),c.push(e)):c.push(null)}return db(l,g)};fa.selectAll=function(a){var c,e,f,g,l=this.id,m=[];"function"!=
typeof a&&(a=X(a));for(var n=-1,q=this.length;++n<q;)for(var v=this[n],x=-1,y=v.length;++x<y;)if(c=v[x]){g=c.__transition__[l];e=a.call(c,c.__data__,x);m.push(c=[]);for(var D=-1,I=e.length;++D<I;)Eb(f=e[D],D,l,g),c.push(f)}return db(m,l)};fa.filter=function(a){var c,e,f,g=[];"function"!=typeof a&&(a=gd(a));for(var l=0,m=this.length;m>l;l++){g.push(c=[]);e=this[l];for(var n=0,q=e.length;q>n;n++)(f=e[n])&&a.call(f,f.__data__,n)&&c.push(f)}return db(g,this.id,this.time).ease(this.ease())};fa.tween=function(a,
c){var e=this.id;return 2>arguments.length?this.node().__transition__[e].tween.get(a):Ba(this,null==c?function(c){c.__transition__[e].tween.remove(a)}:function(f){f.__transition__[e].tween.set(a,c)})};fa.attr=function(a,c){function e(){this.removeAttribute(l)}function f(){this.removeAttributeNS(l.space,l.local)}if(2>arguments.length){for(c in a)this.attr(c,a[c]);return this}var g="transform"==a?yb:Ha,l=m.ns.qualify(a);return Mc(this,"attr."+a,c,function(a){function c(){var d,e=this.getAttribute(l);
return e!==a&&(d=g(e,a),function(a){this.setAttribute(l,d(a))})}function d(){var c,e=this.getAttributeNS(l.space,l.local);return e!==a&&(c=g(e,a),function(a){this.setAttributeNS(l.space,l.local,c(a))})}return null==a?l.local?f:e:(a+="",l.local?d:c)})};fa.attrTween=function(a,c){function e(a,d){var f=c.call(this,a,d,this.getAttribute(g));return f&&function(a){this.setAttribute(g,f(a))}}function f(a,d){var e=c.call(this,a,d,this.getAttributeNS(g.space,g.local));return e&&function(a){this.setAttributeNS(g.space,
g.local,e(a))}}var g=m.ns.qualify(a);return this.tween("attr."+a,g.local?f:e)};fa.style=function(a,c,e){function f(){this.style.removeProperty(a)}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(c="");for(e in a)this.style(e,a[e],c);return this}e=""}var l="transform"==a?yb:Ha;return Mc(this,"style."+a,c,function(c){function g(){var f,p=ha.getComputedStyle(this,null).getPropertyValue(a);return p!==c&&(f=l(p,c),function(c){this.style.setProperty(a,f(c),e)})}return null==c?f:(c+="",g)})};
fa.styleTween=function(a,c,e){return 3>arguments.length&&(e=""),this.tween("style."+a,function(f,g){var l=c.call(this,f,g,ha.getComputedStyle(this,null).getPropertyValue(a));return l&&function(c){this.style.setProperty(a,l(c),e)}})};fa.text=function(a){return Mc(this,"text",a,Ig)};fa.remove=function(){return this.each("end.transition",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})};fa.ease=function(a){var c=this.id;return 1>arguments.length?this.node().__transition__[c].ease:
("function"!=typeof a&&(a=m.ease.apply(m,arguments)),Ba(this,function(e){e.__transition__[c].ease=a}))};fa.delay=function(a){var c=this.id;return Ba(this,"function"==typeof a?function(e,f,g){e.__transition__[c].delay=a.call(e,e.__data__,f,g)|0}:(a|=0,function(e){e.__transition__[c].delay=a}))};fa.duration=function(a){var c=this.id;return Ba(this,"function"==typeof a?function(e,f,g){e.__transition__[c].duration=Math.max(1,a.call(e,e.__data__,f,g)|0)}:(a=Math.max(1,0|a),function(e){e.__transition__[c].duration=
a}))};fa.each=function(a,c){var e=this.id;if(2>arguments.length){var f=Jb,g=fb;fb=e;Ba(this,function(c,f,g){Jb=c.__transition__[e];a.call(c,c.__data__,f,g)});Jb=f;fb=g}else Ba(this,function(f){f.__transition__[e].event.on(a,c)});return this};fa.transition=function(){for(var a,c,e,f,g=this.id,l=++Xe,m=[],n=0,q=this.length;q>n;n++){m.push(a=[]);c=this[n];for(var v=0,x=c.length;x>v;v++)(e=c[v])&&(f=Object.create(e.__transition__[g]),f.delay+=f.duration,Eb(e,v,l,f)),a.push(e)}return db(m,l)};m.svg.axis=
function(){function a(d){d.each(function(){var a,d=m.select(this),C=null==x?e.ticks?e.ticks.apply(e,v):e.domain():x,z=null==c?e.tickFormat?e.tickFormat.apply(e,v):String:c,B=Jg(e,C,y),A=d.selectAll(".tick.minor").data(B,String),B=A.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1E-6),E=m.transition(A.exit()).style("opacity",1E-6).remove(),A=m.transition(A).style("opacity",1),S=d.selectAll(".tick.major").data(C,String),C=S.enter().insert("g","path").attr("class","tick major").style("opacity",
1E-6),H=m.transition(S.exit()).style("opacity",1E-6).remove(),L=m.transition(S).style("opacity",1),R=Bb(e),d=d.selectAll(".domain").data([0]),d=(d.enter().append("path").attr("class","domain"),m.transition(d)),N=e.copy(),O=this.__chart__||N;this.__chart__=N;C.append("line");C.append("text");var K=C.select("line"),V=L.select("line"),z=S.select("text").text(z),S=C.select("text"),T=L.select("text");switch(f){case "bottom":a=Oe;B.attr("y2",l);A.attr("x2",0).attr("y2",l);K.attr("y2",g);S.attr("y",Math.max(g,
0)+q);V.attr("x2",0).attr("y2",g);T.attr("x",0).attr("y",Math.max(g,0)+q);z.attr("dy",".71em").style("text-anchor","middle");d.attr("d","M"+R[0]+","+n+"V0H"+R[1]+"V"+n);break;case "top":a=Oe;B.attr("y2",-l);A.attr("x2",0).attr("y2",-l);K.attr("y2",-g);S.attr("y",-(Math.max(g,0)+q));V.attr("x2",0).attr("y2",-g);T.attr("x",0).attr("y",-(Math.max(g,0)+q));z.attr("dy","0em").style("text-anchor","middle");d.attr("d","M"+R[0]+","+-n+"V0H"+R[1]+"V"+-n);break;case "left":a=Pe;B.attr("x2",-l);A.attr("x2",
-l).attr("y2",0);K.attr("x2",-g);S.attr("x",-(Math.max(g,0)+q));V.attr("x2",-g).attr("y2",0);T.attr("x",-(Math.max(g,0)+q)).attr("y",0);z.attr("dy",".32em").style("text-anchor","end");d.attr("d","M"+-n+","+R[0]+"H0V"+R[1]+"H"+-n);break;case "right":a=Pe,B.attr("x2",l),A.attr("x2",l).attr("y2",0),K.attr("x2",g),S.attr("x",Math.max(g,0)+q),V.attr("x2",g).attr("y2",0),T.attr("x",Math.max(g,0)+q).attr("y",0),z.attr("dy",".32em").style("text-anchor","start"),d.attr("d","M"+n+","+R[0]+"H0V"+R[1]+"H"+n)}if(e.ticks)C.call(a,
O),L.call(a,N),H.call(a,N),B.call(a,O),A.call(a,N),E.call(a,N);else{var W=N.rangeBand()/2,B=function(a){return N(a)+W};C.call(a,B);L.call(a,B)}})}var c,e=m.scale.linear(),f=jf,g=6,l=6,n=6,q=3,v=[10],x=null,y=0;return a.scale=function(c){return arguments.length?(e=c,a):e},a.orient=function(c){return arguments.length?(f=c in kh?c+"":jf,a):f},a.ticks=function(){return arguments.length?(v=arguments,a):v},a.tickValues=function(c){return arguments.length?(x=c,a):x},a.tickFormat=function(e){return arguments.length?
(c=e,a):c},a.tickSize=function(c,e){if(!arguments.length)return g;var f=arguments.length-1;return g=+c,l=1<f?+e:g,n=0<f?+arguments[f]:g,a},a.tickPadding=function(c){return arguments.length?(q=+c,a):q},a.tickSubdivide=function(c){return arguments.length?(y=+c,a):y},a};var jf="bottom",kh={top:1,right:1,bottom:1,left:1};m.svg.brush=function(){function a(l){l.each(function(){var l,n=m.select(this),u=n.selectAll(".background").data([0]),v=n.selectAll(".extent").data([0]),y=n.selectAll(".resize").data(E,
String);n.style("pointer-events","all").on("mousedown.brush",g).on("touchstart.brush",g);u.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");v.enter().append("rect").attr("class","extent").style("cursor","move");y.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return lh[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",
6).attr("height",6).style("visibility","hidden");y.style("display",a.empty()?"none":null);y.exit().remove();q&&(l=Bb(q),u.attr("x",l[0]).attr("width",l[1]-l[0]),e(n));x&&(l=Bb(x),u.attr("y",l[0]).attr("height",l[1]-l[0]),f(n));c(n)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+F[+/e$/.test(a)][0]+","+F[+/^s/.test(a)][1]+")"})}function e(a){a.select(".extent").attr("x",F[0][0]);a.selectAll(".extent,.n>rect,.s>rect").attr("width",F[1][0]-F[0][0])}function f(a){a.select(".extent").attr("y",
F[0][1]);a.selectAll(".extent,.e>rect,.w>rect").attr("height",F[1][1]-F[0][1])}function g(){function p(){var a=m.event.changedTouches;return a?m.touches(A,a)[0]:m.mouse(A)}function y(){var a=p(),d=!1;B&&(a[0]+=B[0],a[1]+=B[1]);O||(m.event.altKey?(z||(z=[(F[0][0]+F[1][0])/2,(F[0][1]+F[1][1])/2]),K[0]=F[+(a[0]<z[0])][0],K[1]=F[+(a[1]<z[1])][1]):z=null);L&&E(a,q,0)&&(e(M),d=!0);N&&E(a,x,1)&&(f(M),d=!0);d&&(c(M),H({type:"brush",mode:O?"move":"resize"}))}function E(a,c,d){var e,f,g=Bb(c);c=g[0];var g=
g[1],m=K[d],n=F[1][d]-F[0][d];return O&&(c-=m,g-=n+m),e=Math.max(c,Math.min(g,a[d])),O?f=(e+=m)+n:(z&&(m=Math.max(c,Math.min(g,2*z[d]-e))),e>m?(f=e,e=m):f=m),F[0][d]!==e||F[1][d]!==f?(l=null,F[0][d]=e,F[1][d]=f,!0):void 0}function C(){y();M.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);m.select("body").style("cursor",null);V.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",
null);H({type:"brushend"});v()}var z,B,A=this,G=m.select(m.event.target),H=n.of(A,arguments),M=m.select(A),R=G.datum(),L=!/^(n|s)$/.test(R)&&q,N=!/^(e|w)$/.test(R)&&x,O=G.classed("extent"),K=p(),V=m.select(ha).on("mousemove.brush",y).on("mouseup.brush",C).on("touchmove.brush",y).on("touchend.brush",C).on("keydown.brush",function(){32==m.event.keyCode&&(O||(z=null,K[0]-=F[1][0],K[1]-=F[1][1],O=2),v())}).on("keyup.brush",function(){32==m.event.keyCode&&2==O&&(K[0]+=F[1][0],K[1]+=F[1][1],O=0,v())});
if(O)K[0]=F[0][0]-K[0],K[1]=F[0][1]-K[1];else if(R){var T=+/w$/.test(R),R=+/^n/.test(R);B=[F[1-T][0]-K[0],F[1-R][1]-K[1]];K[0]=F[T][0];K[1]=F[R][1]}else m.event.altKey&&(z=K.slice());M.style("pointer-events","none").selectAll(".resize").style("display",null);m.select("body").style("cursor",G.style("cursor"));H({type:"brushstart"});y();v()}var l,n=y(a,"brushstart","brush","brushend"),q=null,x=null,E=Xc[0],F=[[0,0],[0,0]];return a.x=function(c){return arguments.length?(q=c,E=Xc[!q<<1|!x],a):q},a.y=
function(c){return arguments.length?(x=c,E=Xc[!q<<1|!x],a):x},a.extent=function(c){var e,f,g,m,n;return arguments.length?(l=[[0,0],[0,0]],q&&(e=c[0],f=c[1],x&&(e=e[0],f=f[0]),l[0][0]=e,l[1][0]=f,q.invert&&(e=q(e),f=q(f)),e>f&&(n=e,e=f,f=n),F[0][0]=0|e,F[1][0]=0|f),x&&(g=c[0],m=c[1],q&&(g=g[1],m=m[1]),l[0][1]=g,l[1][1]=m,x.invert&&(g=x(g),m=x(m)),g>m&&(n=g,g=m,m=n),F[0][1]=0|g,F[1][1]=0|m),a):(c=l||F,q&&(e=c[0][0],f=c[1][0],l||(e=F[0][0],f=F[1][0],q.invert&&(e=q.invert(e),f=q.invert(f)),e>f&&(n=e,
e=f,f=n))),x&&(g=c[0][1],m=c[1][1],l||(g=F[0][1],m=F[1][1],x.invert&&(g=x.invert(g),m=x.invert(m)),g>m&&(n=g,g=m,m=n))),q&&x?[[e,g],[f,m]]:q?[e,f]:x&&[g,m])},a.clear=function(){return l=null,F[0][0]=F[0][1]=F[1][0]=F[1][1]=0,a},a.empty=function(){return q&&F[0][0]===F[1][0]||x&&F[0][1]===F[1][1]},m.rebind(a,n,"on")};var lh={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Xc=["n e s w nw ne se sw".split(" "),["e","w"],["n",
"s"],[]];m.time={};var ia=Date;Ja.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},
getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){za.setUTCDate.apply(this._,arguments)},setDay:function(){za.setUTCDay.apply(this._,arguments)},setFullYear:function(){za.setUTCFullYear.apply(this._,arguments)},setHours:function(){za.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){za.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){za.setUTCMinutes.apply(this._,arguments)},setMonth:function(){za.setUTCMonth.apply(this._,
arguments)},setSeconds:function(){za.setUTCSeconds.apply(this._,arguments)},setTime:function(){za.setTime.apply(this._,arguments)}};var za=Date.prototype,kf="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),lf="Sun Mon Tue Wed Thu Fri Sat".split(" "),Yc="January February March April May June July August September October November December".split(" "),Zc="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");m.time.year=Ka(function(a){return a=m.time.day(a),a.setMonth(0,1),
a},function(a,c){a.setFullYear(a.getFullYear()+c)},function(a){return a.getFullYear()});m.time.years=m.time.year.range;m.time.years.utc=m.time.year.utc.range;m.time.day=Ka(function(a){var c=new ia(1970,0);return c.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),c},function(a,c){a.setDate(a.getDate()+c)},function(a){return a.getDate()-1});m.time.days=m.time.day.range;m.time.days.utc=m.time.day.utc.range;m.time.dayOfYear=function(a){var c=m.time.year(a);return Math.floor((a-c-6E4*(a.getTimezoneOffset()-
c.getTimezoneOffset()))/864E5)};"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ").forEach(function(a,c){a=a.toLowerCase();c=7-c;var e=m.time[a]=Ka(function(a){return(a=m.time.day(a)).setDate(a.getDate()-(a.getDay()+c)%7),a},function(a,c){a.setDate(a.getDate()+7*Math.floor(c))},function(a){var d=m.time.year(a).getDay();return Math.floor((m.time.dayOfYear(a)+(d+c)%7)/7)-(d!==c)});m.time[a+"s"]=e.range;m.time[a+"s"].utc=e.utc.range;m.time[a+"OfYear"]=function(a){var d=m.time.year(a).getDay();
return Math.floor((m.time.dayOfYear(a)+(d+c)%7)/7)}});m.time.week=m.time.sunday;m.time.weeks=m.time.sunday.range;m.time.weeks.utc=m.time.sunday.utc.range;m.time.weekOfYear=m.time.sundayOfYear;m.time.format=function(a){function c(f){for(var g,l,m,n=[],q=-1,s=0;++q<e;)37===a.charCodeAt(q)&&(n.push(a.substring(s,q)),null!=(l=mh[g=a.charAt(++q)])&&(g=a.charAt(++q)),(m=Rb[g])&&(g=m(f,null==l?"e"===g?" ":"0":l)),n.push(g),s=q+1);return n.push(a.substring(s,q)),n.join("")}var e=a.length;return c.parse=function(c){var e=
{y:1900,m:0,d:1,H:0,M:0,S:0,L:0};if(Gb(e,a,c,0)!=c.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);c=new ia;return c.setFullYear(e.y,e.m,e.d),c.setHours(e.H,e.M,e.S,e.L),c},c.toString=function(){return a},c};var mf=Hb(kf),nf=Hb(lf),of=Hb(Yc),nh=Qe(Yc),pf=Hb(Zc),oh=Qe(Zc),mh={"-":"",_:" ",0:"0"},Rb={a:function(a){return lf[a.getDay()]},A:function(a){return kf[a.getDay()]},b:function(a){return Zc[a.getMonth()]},B:function(a){return Yc[a.getMonth()]},c:m.time.format("%a %b %e %X %Y"),d:function(a,c){return la(a.getDate(),
c,2)},e:function(a,c){return la(a.getDate(),c,2)},H:function(a,c){return la(a.getHours(),c,2)},I:function(a,c){return la(a.getHours()%12||12,c,2)},j:function(a,c){return la(1+m.time.dayOfYear(a),c,3)},L:function(a,c){return la(a.getMilliseconds(),c,3)},m:function(a,c){return la(a.getMonth()+1,c,2)},M:function(a,c){return la(a.getMinutes(),c,2)},p:function(a){return 12<=a.getHours()?"PM":"AM"},S:function(a,c){return la(a.getSeconds(),c,2)},U:function(a,c){return la(m.time.sundayOfYear(a),c,2)},w:function(a){return a.getDay()},
W:function(a,c){return la(m.time.mondayOfYear(a),c,2)},x:m.time.format("%m/%d/%Y"),X:m.time.format("%H:%M:%S"),y:function(a,c){return la(a.getFullYear()%100,c,2)},Y:function(a,c){return la(a.getFullYear()%1E4,c,4)},Z:function(a){var c=a.getTimezoneOffset();a=0<c?"-":"+";var e=~~(Math.abs(c)/60),c=Math.abs(c)%60;return a+la(e,"0",2)+la(c,"0",2)},"%":function(){return"%"}},Kg={a:function(a,c,e){nf.lastIndex=0;return(a=nf.exec(c.substring(e)))?e+a[0].length:-1},A:function(a,c,e){mf.lastIndex=0;return(a=
mf.exec(c.substring(e)))?e+a[0].length:-1},b:function(a,c,e){pf.lastIndex=0;return(c=pf.exec(c.substring(e)))?(a.m=oh.get(c[0].toLowerCase()),e+c[0].length):-1},B:function(a,c,e){of.lastIndex=0;return(c=of.exec(c.substring(e)))?(a.m=nh.get(c[0].toLowerCase()),e+c[0].length):-1},c:function(a,c,e){return Gb(a,""+Rb.c,c,e)},d:Re,e:Re,H:Se,I:Se,L:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,e+3)))?(a.L=+c[0],e+c[0].length):-1},m:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,
e+2)))?(a.m=c[0]-1,e+c[0].length):-1},M:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,e+2)))?(a.M=+c[0],e+c[0].length):-1},p:function(a,c,e){c=ph.get(c.substring(e,e+=2).toLowerCase());return null==c?-1:(a.p=c,e)},S:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,e+2)))?(a.S=+c[0],e+c[0].length):-1},x:function(a,c,e){return Gb(a,""+Rb.x,c,e)},X:function(a,c,e){return Gb(a,""+Rb.X,c,e)},y:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,e+2)))?(a.y=+c[0]+
(68<+c[0]?1900:2E3),e+c[0].length):-1},Y:function(a,c,e){ja.lastIndex=0;return(c=ja.exec(c.substring(e,e+4)))?(a.y=+c[0],e+c[0].length):-1}},ja=/^\s*\d+/,ph=m.map({am:0,pm:1});m.time.format.utc=function(a){function c(a){try{ia=Ja;var d=new ia;return d._=a,e(d)}finally{ia=Date}}var e=m.time.format(a);return c.parse=function(a){try{ia=Ja;var c=e.parse(a);return c&&c._}finally{ia=Date}},c.toString=e.toString,c};var qf=m.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");m.time.format.iso=Date.prototype.toISOString&&
+new Date("2000-01-01T00:00:00.000Z")?Nc:qf;Nc.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Nc.toString=qf.toString;m.time.second=Ka(function(a){return new ia(1E3*Math.floor(a/1E3))},function(a,c){a.setTime(a.getTime()+1E3*Math.floor(c))},function(a){return a.getSeconds()});m.time.seconds=m.time.second.range;m.time.seconds.utc=m.time.second.utc.range;m.time.minute=Ka(function(a){return new ia(6E4*Math.floor(a/6E4))},function(a,c){a.setTime(a.getTime()+6E4*Math.floor(c))},function(a){return a.getMinutes()});
m.time.minutes=m.time.minute.range;m.time.minutes.utc=m.time.minute.utc.range;m.time.hour=Ka(function(a){var c=a.getTimezoneOffset()/60;return new ia(36E5*(Math.floor(a/36E5-c)+c))},function(a,c){a.setTime(a.getTime()+36E5*Math.floor(c))},function(a){return a.getHours()});m.time.hours=m.time.hour.range;m.time.hours.utc=m.time.hour.utc.range;m.time.month=Ka(function(a){return a=m.time.day(a),a.setDate(1),a},function(a,c){a.setMonth(a.getMonth()+c)},function(a){return a.getMonth()});m.time.months=m.time.month.range;
m.time.months.utc=m.time.month.utc.range;var Ib=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],$c=[[m.time.second,1],[m.time.second,5],[m.time.second,15],[m.time.second,30],[m.time.minute,1],[m.time.minute,5],[m.time.minute,15],[m.time.minute,30],[m.time.hour,1],[m.time.hour,3],[m.time.hour,6],[m.time.hour,12],[m.time.day,1],[m.time.day,2],[m.time.week,1],[m.time.month,1],[m.time.month,3],[m.time.year,1]],qh=[[m.time.format("%Y"),Xa],[m.time.format("%B"),
function(a){return a.getMonth()}],[m.time.format("%b %d"),function(a){return 1!=a.getDate()}],[m.time.format("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[m.time.format("%I %p"),function(a){return a.getHours()}],[m.time.format("%I:%M"),function(a){return a.getMinutes()}],[m.time.format(":%S"),function(a){return a.getSeconds()}],[m.time.format(".%L"),function(a){return a.getMilliseconds()}]],rf=m.scale.linear(),rh=Te(qh);$c.year=function(a,c){return rf.domain(a.map(Lg)).ticks(c).map(Qc)};
m.time.scale=function(){return Oc(m.scale.linear(),$c,rh)};var sf=$c.map(function(a){return[a[0].utc,a[1]]}),sh=[[m.time.format.utc("%Y"),Xa],[m.time.format.utc("%B"),function(a){return a.getUTCMonth()}],[m.time.format.utc("%b %d"),function(a){return 1!=a.getUTCDate()}],[m.time.format.utc("%a %d"),function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],[m.time.format.utc("%I %p"),function(a){return a.getUTCHours()}],[m.time.format.utc("%I:%M"),function(a){return a.getUTCMinutes()}],[m.time.format.utc(":%S"),
function(a){return a.getUTCSeconds()}],[m.time.format.utc(".%L"),function(a){return a.getUTCMilliseconds()}]],th=Te(sh);return sf.year=function(a,c){return rf.domain(a.map(Mg)).ticks(c).map(Rc)},m.time.scale.utc=function(){return Oc(m.scale.linear(),sf,th)},m.text=function(){return m.xhr.apply(m,arguments).response(Ng)},m.json=function(a,c){return m.xhr(a,"application/json",c).response(Og)},m.html=function(a,c){return m.xhr(a,"text/html",c).response(Pg)},m.xml=function(){return m.xhr.apply(m,arguments).response(Qg)},
m}();var w=$("#test-nav").width(),h=800,i=0,barHeight=20,barWidth=0.8*w,duration=400,root,tree=d3.layout.tree().size([h,100]),diagonal=d3.svg.diagonal().projection(function(f){return[f.y,f.x]});
function updateNav(f){var l=tree.nodes(root);l.forEach(function(a,e){a.x=e*barHeight});var n=vis.selectAll("g.node").data(l,function(a){return a.id||(a.id=++i)}),a=n.enter().append("svg:g").attr("class","node").attr("transform",function(a){return"translate("+f.y0+","+f.x0+")"}).style("opacity",1E-6);a.append("svg:rect").attr("y",-barHeight/2).attr("height",barHeight).attr("width",barWidth).style("fill",color).on("click",click);a.append("svg:text").attr("dy",3.5).attr("dx",5.5).text(function(a){return a.name});
a.transition().duration(duration).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}).style("opacity",1);n.transition().duration(duration).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}).style("opacity",1).select("rect").style("fill",color);n.exit().transition().duration(duration).attr("transform",function(a){return"translate("+f.y+","+f.x+")"}).style("opacity",1E-6).remove();l.forEach(function(a){a.x0=a.x;a.y0=a.y})}
function click(f){f.children?(f._children=f.children,f.children=null):(f.children=f._children,f._children=null);updateNav(f)}function color(f){return f._children?"#3182bd":f.children?"#c6dbef":"#fd8d3c"}var isOdd=function(f){return 0==f%2?!1:!0};
function updateEvents(){$.getJSON("/dashboard/",function(f){$.each(f,function(l){var n=parseInt($(".event-id").eq(1).text());parseInt(f[l].pk)>n&&($("tr").eq(0).after('<tr><td class="event-id">'+f[l].pk+'</td><td class="name">'+f[l].fields.signal+'</td><td class="time">'+f[l].fields.time+"</td></tr>"),$("tr").eq(1).effect("highlight",{color:"#ff6600"},3E5))})})}function autoUpdateEvents(){setInterval(updateEvents,2E3)}$("#masonry-container").masonry({itemSelector:".mbox",columnWidth:384});
$(function(){$(".column").each(function(f){var l=this;$(l).sortable({connectWith:".column",handle:".portlet-header",update:function(f,a){$.cookie("sortorder"+l.id,$(l).sortable("toArray").join(),{path:"/"})}})});$(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend("<span class='ui-icon ui-icon-minusthick'></span>").end().find(".portlet-content");$(".portlet-header .ui-icon").click(function(){$(this).toggleClass("ui-icon-minusthick").toggleClass("ui-icon-plusthick");
$(this).parents(".portlet:first").find(".portlet-content").toggle($.cookie($(this).parents(".portlet:first")[0].id,$(this).parents(".portlet:first").find(".portlet-content").is(":hidden")?"expanded":"collapsed",{path:"/"}))})});
function loadCookie(){$(".column").each(function(f){f=$.cookie("sortorder"+this.id);var l=this;f&&$(f.split(",")).each(function(f,a){$("#"+a).appendTo(l)});$(this).sortable()});$(".portlet").each(function(f){if((f=$.cookie(this.id))&&"collapsed"===f)$(this).find(".ui-icon").toggleClass("ui-icon-minusthick").toggleClass("ui-icon-plusthick"),$(this).find(".portlet-content").hide()});"true"===$.cookie("shotTracking")?turnOnShotTracker():turnOffShotTracker()}
function plotSignal2D(){var f=$("#dummy");$.getJSON(window.location.search+(window.location.search.length?"&":"?")+"format=json",function(l){var n=document.createElement("canvas");n.width=l.dim[0].length;n.height=l.dim[1].length;f.height(n.height);for(var a=n.getContext("2d"),c=a.getImageData(0,0,n.width,n.height),e=0;e<c.width;e++)for(var g=0;g<c.height;g++){var q=4*(g*c.width+e),v=255*(l.data[e][g]-l.min)/(l.max-l.min);c.data[q]=v;c.data[q+1]=v;c.data[q+2]=v;c.data[q+3]=255}a.putImageData(c,0,0);
f.append(n)})}function getPlotWidth(f){return{plot:$(f).width()-30-0,marginLeft:30,marginRight:0}}function fillPlot(f){var l=Array(2*f.dim.length);for(i=0;i<f.dim.length;i++)l[i]=[f.dim[i],f.data[0][i]],l[f.dim.length+i]=[f.dim[f.dim.length-(i+1)],f.data[1][f.dim.length-(i+1)]];return l}function isMinMaxPlot(f){return-1<$.inArray("min",f.labels)&&-1<$.inArray("max",f.labels)&&2==f.labels.length?!0:!1}
function H1DSUri(f){this.uri_components=parseUri(f);this.h1ds_filters={};this.non_h1ds_query={};f=/^f(\d+)(_(\w+))?/;for(var l in this.uri_components.queryKey)if(this.uri_components.queryKey.hasOwnProperty(l)){var n=f.exec(l);n?(this.h1ds_filters.hasOwnProperty(n[1])||(this.h1ds_filters[n[1]]={name:"",kwargs:{}}),"undefined"===typeof n[2]?this.h1ds_filters[n[1]].name=this.uri_components.queryKey[l]:this.h1ds_filters[n[1]].kwargs[n[3]]=this.uri_components.queryKey[l]):this.non_h1ds_query[l]=this.uri_components.queryKey[l]}}
H1DSUri.prototype.getNextFilterID=function(){var f=-1,l;for(l in this.h1ds_filters)this.h1ds_filters.hasOwnProperty(l)&&Number(l)>f&&(f=Number(l));return f+1};H1DSUri.prototype.getFilterIDsForFilterName=function(f){var l=[],n;for(n in this.h1ds_filters)this.h1ds_filters.hasOwnProperty(n)&&h1ds_filters[n].name==f&&(l[l.length]=n);return l};H1DSUri.prototype.appendFilter=function(f,l){var n=this.getNextFilterID();this.h1ds_filters[String(n)]={name:f,kwargs:l}};
H1DSUri.prototype.renderUri=function(){var f={},l;for(l in this.non_h1ds_query)this.non_h1ds_query.hasOwnProperty(l)&&(f[l]=this.non_h1ds_query[l]);for(l in this.h1ds_filters)if(this.h1ds_filters.hasOwnProperty(l)){f["f"+l]=this.h1ds_filters[l].name;for(var n in this.h1ds_filters[l].kwargs)f["f"+l+"_"+n]=this.h1ds_filters[l].kwargs[n]}l=jQuery.extend({},this.uri_components);l.queryKey=f;return makeUri(l)};H1DSUri.prototype.isBinary=function(){return"bin"===this.non_h1ds_query.format};
H1DSUri.prototype.getShot=function(){var f=this.uri_components.path;"/"!==f[f.length-1]&&(f+="/");f=f.match(/\/\d+\//);return null===f?0:Number(f[0].substring(1,f[0].length-1))};H1DSUri.prototype.setShot=function(f){var l=this.uri_components.path;"/"!==l[l.length-1]&&(l+="/");f=l.replace(/\/\d+\//,"/"+f+"/");this.uri_components.path=f};
function getSpectrogramUri(f){f=new H1DSUri(f);f.appendFilter("slanted_baseline",{window:10});f.appendFilter("spectrogram",{bin_size:-1});f.appendFilter("norm_dim_range_2d",{x_min:0,x_max:1,y_min:0,y_max:0.5});f.appendFilter("y_axis_energy_limit",{threshold:0.995});f.non_h1ds_query.format="bin";f.non_h1ds_query.bin_assert_dtype="uint8";return f}
function getPowerspectrumUri(f,l){var n=new H1DSUri(f);n.appendFilter("slanted_baseline",{window:10});n.appendFilter("power_spectrum",{});n.appendFilter("norm_dim_range",{min:0,max:0.5});n.appendFilter("resample_minmax",{n_bins:l});n.non_h1ds_query.format="json";return n}function getRawUri(f,l){var n=new H1DSUri(f);n.appendFilter("resample_minmax",{n_bins:l});n.non_h1ds_query.format="json";return n}
function PlotContainer(f,l,n){this.id=f;this.plotTypes={raw:this.plotLine,spectrogram:this.plotSpectrogram,powerspectrum:this.plotLine,raw2d:this.plotSpectrogram};var a=$(f).width(),c=d3.min([a/1.618,0.9*$(window).height()]);this.control_panel=d3.select(f).append("div").classed("pc-control-panel",!0).append("ul");this.svg=d3.select(f).append("svg:svg").attr("width",a).attr("height",c);this.data_colours="#A11D20 #662C91 #1859A9 #008C47 #ED2D2E #010101".split(" ");this.plotGrid=this.setPlotGrid(l,n);
this.url_cache={};this.data_ids={};this.dataPadding=0.05;this.xAxisPadding=40;this.yAxisPadding=60}
PlotContainer.prototype.plotLine=function(f){var l=f.datum().plot.flip;f.append("path").classed("path-filled",function(f){return f.data.is_minmax}).style("stroke",function(f,a){return f.data.colour}).style("fill",function(f,a){return f.data.is_minmax?f.data.colour:"none"}).attr("d",function(f,a){if(f.data.is_minmax){var c=fillPlot(f.data),e=d3.svg.line().x(function(a){return f.plot.x(a[l?1:0])}).y(function(a){return f.plot.y(a[l?0:1])});return e(c)}e=d3.svg.line().x(function(a,c){return f.plot.x(l?
a:f.data.dim[c])}).y(function(a,c){return f.plot.y(l?f.data.dim[c]:a)});return e(f.data.data)})};d3.select(window).on("mousemove",mousemove).on("mouseup",mouseup);var rect,x0,x1,count,par_rect;function mousedown(){x0=d3.mouse(this);count=0;par_rect=d3.select(this);rect=d3.select(this.parentNode).append("svg:rect").attr("y",par_rect.attr("y")).attr("height",par_rect.attr("height")).style("fill","#999").style("fill-opacity",0.5);d3.event.preventDefault()}
function mousemove(){if(rect){x1=d3.mouse(rect.node());var f=Math.min(x0[0],x1[0]),l=Math.max(x0[0],x1[0]);Math.min(x0[1],x1[1]);Math.max(x0[1],x1[1]);rect.attr("x",f-0.5).attr("width",l-f+1)}}
function mouseup(){rect&&(rect.each(function(f){var l=f.xAxis.scale().invert(d3.select(this).attr("x"));f=f.xAxis.scale().invert(+d3.select(this).attr("x")+ +d3.select(this).attr("width"));var n=new H1DSUri(window.location.href),a=Number(n.getNextFilterID());0==a?n.appendFilter("dim_range",{min:l,max:f}):(a-=1,"dim_range"===n.h1ds_filters[String(a)].name?n.h1ds_filters[String(a)].kwargs={min:l,max:f}:n.appendFilter("dim_range",{min:l,max:f}));$(".h1ds-pagelet").each(function(){d3.select(this).html("");
populatePagelet($(this),n.renderUri())});Modernizr.history&&history.pushState(null,null,n.renderUri())}),rect.remove(),rect=null)}tmpdebug=function(f){};PlotContainer.prototype.plotRaw2D=function(f){};
PlotContainer.prototype.plotSpectrogram=function(f){var l=[];d3.scale.linear().domain([0,1]).range(["blue","red"]);d3.scale.linear().domain([0,1]).range([0,1]);var n=0;data=f.datum();for(var a=data.plot.x(data.data.dim[0][1])-data.plot.x(data.data.dim[0][0]),c=data.plot.y(data.data.dim[1][0])-data.plot.y(data.data.dim[1][1]),e=data.plot.x(data.data.dim[0][0]),g=data.plot.y(data.data.dim[1][0]),q=0;q<data.data.dim[0].length-1;q++)for(var v=0;v<data.data.dim[1].length-1;v++)0<data.data.data[q][v]&&
(l.push({xi:q,yi:v}),data.data.data[q][v]>n&&(n=data.data.data[q][v]));f.selectAll("rect").data(l).enter().append("rect").attr("x",function(c,f){return e+c.xi*a}).attr("y",function(a,e){return g-a.yi*c}).attr("width",a).attr("height",c).style("fill",function(a,c){return data.data.colour}).style("fill-opacity",function(a,c){return data.data.data[a.xi][a.yi]/n})};PlotContainer.prototype.plotPowerSpectrum=function(f){};
PlotContainer.prototype.setPlot=function(f,l,n){for(var a in l)this.plotGrid[f][a]=l[a];"undefined"!==typeof n&&n&&this.updateDisplay()};
PlotContainer.prototype.setPlotGrid=function(f,l){for(var n=d3.sum(l),a=d3.sum(f),c=[],e=[],g=this.svg.attr("width"),q=this.svg.attr("height"),v=0;v<l.length;v++)c[v]=g*l[v]/n;for(v=0;v<f.length;v++)e[v]=q*f[v]/a;n=[];for(v=q=g=a=0;v<f.length;v++){for(var R=q=0;R<c.length;R++)n[a]={translate:[q,g],width:c[R],height:e[v],data_ids:[],data:[],plotType:"",flip:!1,bindAxis:[-1,-1]},q+=c[R],a++;g+=e[v]}this.svg.attr("height",g);$(this.id).height(g);return n};
PlotContainer.prototype.addData=function(f,l){this.data_ids[f]={uri:l,colour:this.data_colours.pop()}};PlotContainer.prototype.addDataToPlot=function(f,l,n){n="undefined"!==typeof n?n:!0;this.plotGrid[l].data_ids.push(f);n&&this.updateDisplay()};ProcessH1DSHeaders=function(f){f=f.split("\n");for(var l={},n=0;n<f.length;n++){var a=f[n].split(":");2===a.length&&a[0].match("^X-H1DS")&&(l[a[0]]=$.trim(a[1]))}return l};
ProcessBinaryData=function(f,l){for(var n=new Uint8Array(str2ab(f)),a=parseInt(l["X-H1DS-ndim"]),c=0,e={data:[],dim:[],n_dim:a},g=0;g<a;g++){e.dim[g]=[];for(var q=parseInt(l["X-H1DS-dim-"+g+"-length"]),v=parseFloat(l["X-H1DS-dim-"+g+"-delta"]),R=parseFloat(l["X-H1DS-dim-"+g+"-first"]),V=0;V<q;V++)e.dim[g][V]=v*V+R}g=parseFloat(l["X-H1DS-data-delta"]);q=parseFloat(l["X-H1DS-data-min"]);if(0<a){v=parseInt(l["X-H1DS-dim-0-length"]);parseFloat(l["X-H1DS-dim-0-delta"]);parseFloat(l["X-H1DS-dim-0-first"]);
for(R=0;R<v;R++)if(1<a){e.data[R]=[];V=parseInt(l["X-H1DS-dim-1-length"]);parseFloat(l["X-H1DS-dim-1-delta"]);parseFloat(l["X-H1DS-dim-1-first"]);for(var y=0;y<V;y++)if(2<a){e.data[R][y]=[];var H=parseInt(l["X-H2DS-dim-2-length"]);parseFloat(l["X-H1DS-dim-2-delta"]);parseFloat(l["X-H1DS-dim-2-first"]);for(var x=0;x<H;x++)e.data[R][y][x]=g*n[c]+q,c++}else e.data[R][y]=n[c],c++}else e.data[R]=g*n[c]+q,c++}return e};function ab2str(f){return String.fromCharCode.apply(null,new Uint8Array(f))}
function str2ab(f){for(var l=new ArrayBuffer(f.length),n=new Uint8Array(l),a=0,c=f.length;a<c;a++)n[a]=f.charCodeAt(a);return l}PlotContainer.prototype.loadURL=function(f,l){var n=this;if(l){var a=$.ajax({url:f,async:!1}),c=ProcessH1DSHeaders(a.getAllResponseHeaders());a.done(function(a){data=ProcessBinaryData(a,c);n.url_cache[f]=data})}else $.ajax({url:f,dataType:"json",async:!1}).done(function(a){a.is_minmax=isMinMaxPlot(a);a.n_dim=2===a.dim.length?2:1;n.url_cache[f]=a})};
PlotContainer.prototype.getData=function(f,l){var n={};switch(l){case "raw":var n=getRawUri(this.data_ids[f].uri,this.svg.attr("width")),a=n.renderUri();this.loadURL(a,n.isBinary());n=this.url_cache[a];break;case "spectrogram":n=getSpectrogramUri(this.data_ids[f].uri);a=n.renderUri();this.loadURL(a,n.isBinary());n=this.url_cache[a];break;case "powerspectrum":n=getPowerspectrumUri(this.data_ids[f].uri,this.svg.attr("width"));a=n.renderUri();this.loadURL(a,n.isBinary());n=this.url_cache[a];break;default:this.loadURL(this.data_ids[f].uri,
!1),n=this.url_cache[this.data_ids[f].uri]}return n};
PlotContainer.prototype.updateDisplay=function(){for(var f=this,l=0;l<this.plotGrid.length;l++){for(var n=0;n<this.plotGrid[l].data_ids.length;n++)this.plotGrid[l].data[n]=this.getData(this.plotGrid[l].data_ids[n],this.plotGrid[l].plotType),this.plotGrid[l].data[n].colour=f.data_ids[this.plotGrid[l].data_ids[n]].colour;0<this.plotGrid[l].data_ids.length&&this.updatePlot(l)}for(l=0;l<this.plotGrid.length;l++)0<this.plotGrid[l].data_ids.length&&this.linkAxes(l);l=this.svg.selectAll("g.plot").data(this.plotGrid);
l.enter().append("g").attr("class","plot").attr("transform",function(a){return"translate("+a.translate[0]+","+a.translate[1]+")"}).append("clipPath").attr("id",function(a,c){return"plot-"+c+"-clippath"}).append("svg:rect").attr("width",function(a,c){return a.width}).attr("height",function(a,c){return a.height});l.exit().remove();l.append("g").attr("class","axis x").attr("id",function(a,c){return"plot-"+c+"-axis-x"}).attr("transform",function(a){return"translate(0,"+(a.height-f.xAxisPadding)+")"}).each(function(a){"undefined"!==
typeof a.xAxis?d3.select(this).call(a.xAxis):function(){}}).append("text").attr("text-anchor","middle").attr("x",function(a){return f.yAxisPadding+0.5*(a.width-f.yAxisPadding)}).attr("y",function(a){return 0.8*f.xAxisPadding}).text(function(a){return"["+a.data[0].units[1]+"]"});l.append("g").attr("class","axis y").attr("id",function(a,c){return"plot-"+c+"-axis-y"}).attr("transform",function(a){return"translate("+f.yAxisPadding+",0)"}).each(function(a){"undefined"!==typeof a.yAxis?d3.select(this).call(a.yAxis):
function(){}}).append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",function(a){return-0.5*(a.height-f.xAxisPadding)}).attr("y",function(a){return-0.8*f.yAxisPadding}).text(function(a){return"["+a.data[0].units[0]+"]"});l.append("svg:rect").attr("class","selectrect").attr("x",f.yAxisPadding).attr("y",function(a){return-f.xAxisPadding}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).style("fill","#fff").style("fill-opacity",0).on("mousedown",
mousedown);l=l.selectAll("g.data").data(function(a,c){for(var e=[],f=0;f<a.data.length;f++)e[f]={data:a.data[f],plot:a,plotid:c};return e});l.enter().insert("g",".selectrect").attr("class","data").attr("clip-path",function(a,c){return"url(#plot-"+c+"-clippath)"}).each(function(a,c){d3.select(this).call(f.plotTypes[a.plot.plotType])});l.exit().remove()};
PlotContainer.prototype.linkAxes=function(f){var l=0<=this.plotGrid[f].bindAxis[0]&&this.plotGrid[f].bindAxis[0]!==f?this.plotGrid[f].bindAxis[0]:f,n=0<=this.plotGrid[f].bindAxis[1]&&this.plotGrid[f].bindAxis[1]!==f?this.plotGrid[f].bindAxis[1]:f;l!==f&&this.plotGrid[f].x.domain(this.plotGrid[l].x.domain());n!==f&&this.plotGrid[f].y.domain(this.plotGrid[n].y.domain())};
PlotContainer.prototype.updatePlot=function(f){var l=this.plotGrid[f].flip,n=[this.yAxisPadding,this.plotGrid[f].width],a=[this.plotGrid[f].height-this.xAxisPadding,0],c=[d3.min(this.plotGrid[f].data,function(a,c){return 1===a.n_dim?d3.min(a.dim):d3.min(a.dim[0])}),d3.max(this.plotGrid[f].data,function(a,c){return 1===a.n_dim?d3.max(a.dim):d3.max(a.dim[0])})],c=d3.scale.linear().range(l?a:n).domain(c);this.plotGrid[f].flip?this.plotGrid[f].y=c:this.plotGrid[f].x=c;var c=[d3.min(this.plotGrid[f].data,
function(a,c){return 1===a.n_dim?a.is_minmax?d3.min(a.data[0]):d3.min(a.data):d3.min(a.dim[1])}),d3.max(this.plotGrid[f].data,function(a,c){return 1===a.n_dim?a.is_minmax?d3.max(a.data[1]):d3.max(a.data):d3.max(a.dim[1])})],e=c[1]-c[0],l=d3.scale.linear().range(l?n:a).domain([c[0]-this.dataPadding*e,c[1]+this.dataPadding*e]);this.plotGrid[f].flip?this.plotGrid[f].x=l:this.plotGrid[f].y=l;this.plotGrid[f].xAxis=d3.svg.axis().scale(this.plotGrid[f].x).orient("bottom").tickSize(1===this.plotGrid[f].data[0].n_dim?
this.plotGrid[f].y.range()[1]-this.plotGrid[f].y.range()[0]:5);this.plotGrid[f].yAxis=d3.svg.axis().scale(this.plotGrid[f].y).orient("left").tickSize(1===this.plotGrid[f].data[0].n_dim?this.plotGrid[f].x.range()[0]-this.plotGrid[f].x.range()[1]:5)};function getLastShotInDisplayedPage(){var f=-1;d3.selectAll("table.main-table tr").each(function(l,n){if(0<n){var a=Number(d3.select(this).select("td").text());a>f&&(f=a)}});return f}
function summaryUpdateRequired(f){$.ajax({url:"/summary/_/get_last_update_time/",dataType:"json",async:!1}).done(function(f){latest_summdb_update=new Date(f.last_update)});return latest_summdb_update>f}
function updateSummaryDB(){var f=getLastShotInDisplayedPage(),l=-1;$.ajax({url:"/summary/_/get_latest_summarydb_shot/",dataType:"json",async:!1}).done(function(f){l=Number(f.latest_shot)});l>f&&$.ajax({url:window.location.toString()+(window.location.search+(window.location.search.length?"&":"?")+"format=json"),dataType:"json",async:!1}).done(function(f){})}
function cross(f){var l=[],n,a;for(n=0;n<f.data.length;n++){l[n]=[];l[n].shot;for(a=0;a<f.attributes.length;a++)l[n][a]={shot:f.data[n].shot,attr:f.attributes[a],value:f.data[n].d[a]}}return l}$("span.toggleVertical").each(function(){"true"===$.cookie("vertical-"+$(this).text())&&($(this).toggleClass("verticalText"),$(this).html($(this).text().replace(/(.)/g,"$1<br />")))});
$("span.toggleVertical").click(function(){$(this).toggleClass("verticalText");$(this).hasClass("verticalText")?($(this).html($(this).text().replace(/(.)/g,"$1<br />")),$.cookie("vertical-"+$(this).text(),!0)):($(this).html($(this).text().replace("$1<br />","")),$.cookie("vertical-"+$(this).text(),!1))});
function autoPollSummaryDB(){var f=d3.select("#poll-summarydb-server");if(null!==f[0][0]&&"True"===f.text()){var l=null,n=window.location.toString()+(window.location.search+(window.location.search.length?"&":"?")+"format=json"),a=d3.select("table.main-table tbody"),c=function(c){$.ajax({url:n,dataType:"json",async:!1}).done(function(f){l=new Date(f.timestamp);f=a.selectAll("tr").data(cross(f),function(a){return a[0].shot});f.enter().insert("tr","tr").style("background-color","yellow");var n=f.selectAll("td").data(function(a){return a});
n.enter().append("td").html(function(a,c){return'<a href="/summary/_/go_to_source/'+a.attr+"/"+a.shot+'/" >'+a.value+"</a>"});n.transition().duration(500).each(function(a){d3.select(this).html(function(a,c){return'<a href="/summary/_/go_to_source/'+a.attr+"/"+a.shot+'/" >'+a.value+"</a>"})});f.transition().duration(c).style("background-color","white");f.exit().remove()})};c(1E3);setInterval(function(){summaryUpdateRequired(l)&&c(3E5)},2E3)}}var shot_stream_client=new XMLHttpRequest;
function turnOffShotTracker(){$("#h1ds-track-latest-shot").hide();$("#h1ds-shot-controller").show();$("#h1ds-toggle-track-latest-shot").html('<FORM class="inline-form right" action="." onsubmit="javascript:toggleTrackLatestShot()" method="post"><INPUT type="submit" id="h1ds-toggletrack-shot" name="h1ds-toggletrack-shot" value="track latest shot"></FORM>');$.cookie("shotTracking","false",{path:"/"});shot_stream_client.abort()}
function turnOnShotTracker(){$("#h1ds-shot-controller").hide();$("#h1ds-track-latest-shot").show();$("#h1ds-toggletrack-latest-shot").html('<FORM class="inline-form right" action="." onsubmit="javascript:toggleTrackLatestShot()" method="post"><INPUT type="submit" id="h1ds-toggletrack-shot" name="h1ds-toggletrack-shot" value="stop tracking latest shot"></FORM>');$.cookie("shotTracking","true",{path:"/"});shot_stream_client.open("get","/_/shot_stream/");shot_stream_client.send();shot_stream_client.onprogress=
function(){var f=this.responseText.split("\n");$.getJSON("/_/url_for_shot",{input_path:window.location.toString(),shot:f[f.length-2]},function(f){window.location=f.new_url})}}function toggleTrackLatestShot(){"true"===$.cookie("shotTracking")?turnOffShotTracker():turnOnShotTracker();return!1}function plotScalar(f,l){return 0}function plot1DimArray(f,l){var n=new PlotContainer("#"+f,[500],[1]);n.addData("default",l);n.setPlot(0,{plotType:"raw"});n.addDataToPlot("default",0,!0)}
function plot2DimArray(f,l){var n=new PlotContainer("#"+f,[500],[1]);n.addData("default",l);n.setPlot(0,{plotType:"raw2d"});n.addDataToPlot("default",0,!0)}function getPlotFunction(f,l){switch(l){case "0":return plotScalar;case "1":return plot1DimArray;case "2":return plot2DimArray}}function populatePagelet(f,l){var n=new H1DSUri(l);n.non_h1ds_query.format="json";var n=n.renderUri(),a=f.attr("data-dtype"),c=f.attr("data-ndim");getPlotFunction(a,c)(f.attr("id"),n)}
$.fn.scrollView=function(){return this.each(function(){$("html, body").animate({scrollTop:$(this).offset().top},0)})};updateShotNav=function(){var f=new H1DSUri(window.location.toString()),l=f.getShot();0===l&&(f.uri_components.path=$("#debug-node-path").html(),l=f.getShot());f.setShot(l+1);var n=f.renderUri();f.setShot(l-1);f=f.renderUri();$("#h1ds-shot-previous").html("<a class='shotnav' href='"+f+"'>&larr;</a>");$("#h1ds-shot-next").html("<a class='shotnav' href='"+n+"'>&rarr;</a>")};
$(document).ready(function(){$("#main").scrollView();autoPollSummaryDB();loadCookie();$(".h1ds-pagelet").each(function(){populatePagelet($(this),window.location.toString())})});
